{"job":{"components":{"88629":{"id":88629,"inputCardinality":"ZERO","outputCardinality":"MANY","implementationID":1354890871,"x":144,"y":210,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[88634],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"csatsurveyresponsetemp"}}}},"visible":true},"2":{"slot":2,"name":"Table Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"csatsurveyresponsetemp"}}}},"visible":true},"3":{"slot":3,"name":"Column Names","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"csatsurveyid"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"surveydatetimeutc"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"ipaddress"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"customerid"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"stationcode"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"surveycompleteflag"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"csatscore"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"qa1"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"qa2"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"qa3"}}},"11":{"slot":11,"values":{"1":{"slot":1,"type":"STRING","value":"qa4"}}},"12":{"slot":12,"values":{"1":{"slot":1,"type":"STRING","value":"qa5"}}},"13":{"slot":13,"values":{"1":{"slot":1,"type":"STRING","value":"qa6"}}},"14":{"slot":14,"values":{"1":{"slot":1,"type":"STRING","value":"qa7"}}},"15":{"slot":15,"values":{"1":{"slot":1,"type":"STRING","value":"qa8"}}},"16":{"slot":16,"values":{"1":{"slot":1,"type":"STRING","value":"qa9"}}},"17":{"slot":17,"values":{"1":{"slot":1,"type":"STRING","value":"qa10"}}},"18":{"slot":18,"values":{"1":{"slot":1,"type":"STRING","value":"qa11"}}},"19":{"slot":19,"values":{"1":{"slot":1,"type":"STRING","value":"qa12"}}},"20":{"slot":20,"values":{"1":{"slot":1,"type":"STRING","value":"qa13"}}},"21":{"slot":21,"values":{"1":{"slot":1,"type":"STRING","value":"qa14"}}},"22":{"slot":22,"values":{"1":{"slot":1,"type":"STRING","value":"qa15"}}},"23":{"slot":23,"values":{"1":{"slot":1,"type":"STRING","value":"qa16"}}},"24":{"slot":24,"values":{"1":{"slot":1,"type":"STRING","value":"qa17"}}},"25":{"slot":25,"values":{"1":{"slot":1,"type":"STRING","value":"qa18"}}},"26":{"slot":26,"values":{"1":{"slot":1,"type":"STRING","value":"qa19"}}},"27":{"slot":27,"values":{"1":{"slot":1,"type":"STRING","value":"qa20"}}},"28":{"slot":28,"values":{"1":{"slot":1,"type":"STRING","value":"qa21"}}},"29":{"slot":29,"values":{"1":{"slot":1,"type":"STRING","value":"qa22"}}},"30":{"slot":30,"values":{"1":{"slot":1,"type":"STRING","value":"qa23"}}},"31":{"slot":31,"values":{"1":{"slot":1,"type":"STRING","value":"qa24"}}},"32":{"slot":32,"values":{"1":{"slot":1,"type":"STRING","value":"qa25"}}},"33":{"slot":33,"values":{"1":{"slot":1,"type":"STRING","value":"qa26"}}},"34":{"slot":34,"values":{"1":{"slot":1,"type":"STRING","value":"qa27"}}},"35":{"slot":35,"values":{"1":{"slot":1,"type":"STRING","value":"qa28"}}},"36":{"slot":36,"values":{"1":{"slot":1,"type":"STRING","value":"surveymonkeyresponseid"}}},"37":{"slot":37,"values":{"1":{"slot":1,"type":"STRING","value":"surveyresponsemodifieddatetimeutc"}}}},"visible":true},"4":{"slot":4,"name":"Trim Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"5":{"slot":5,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"stage"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"88630":{"id":88630,"inputCardinality":"ZERO_OR_MANY","outputCardinality":"MANY","implementationID":-1266674941,"x":360,"y":212,"width":32,"height":32,"inputConnectorIDs":[88634],"outputConnectorIDs":[88633],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"add_stationcode"}}}},"visible":true},"2":{"slot":2,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SELECT \nsurveymonkeyresponseid\n, csatsurveyid\n, surveydatetimeutc\n, surveyresponsemodifieddatetimeutc\n,CONVERT_TIMEZONE('America/Toronto', surveyresponsemodifieddatetimeutc) AS surveyresponsemodifieddatetime\n,CONVERT_TIMEZONE('America/Toronto', surveydatetimeutc) AS surveydatetime\n, ipaddress\n, customerid\n, stationcode\n, surveycompleteflag AS surveymonkeycompleteflag\n, csatscore\n, ISNULL(qa1,'') AS qa1\n, ISNULL(qa2,'') AS qa2\n, ISNULL(qa3,'') AS qa3\n, ISNULL(qa4,'') AS qa4\n, ISNULL(qa5,'') AS qa5\n, ISNULL(qa6,'') AS qa6\n, ISNULL(qa7,'') AS qa7\n, ISNULL(qa8,'') AS qa8\n, ISNULL(qa9,'') AS qa9\n, ISNULL(qa10,'') AS qa10\n, ISNULL(qa11,'') AS qa11\n, ISNULL(qa12,'') AS qa12\n, ISNULL(qa13,'') AS qa13\n, ISNULL(qa14,'') AS qa14\n, ISNULL(qa15,'') AS qa15\n, ISNULL(qa16,'') AS qa16\n, ISNULL(qa17,'') AS qa17\n, ISNULL(qa18,'') AS qa18\n, ISNULL(qa19,'') AS qa19\n, ISNULL(qa20,'') AS qa20\n, ISNULL(qa21,'') AS qa21\n, ISNULL(qa22,'') AS qa22\n, ISNULL(qa23,'') AS qa23\n, ISNULL(qa24,'') AS qa24\n, ISNULL(qa25,'') AS qa25\n, ISNULL(qa26,'') AS qa26\n, ISNULL(qa27,'') AS qa27\n, ISNULL(qa28,'') AS qa28\n\n,CASE \n\tWHEN airportname IS NULL AND qa3 = 'Orlando-Melbourne' THEN 'MLB'\n\tWHEN airportname IS NULL AND qa3 = 'Newark' THEN 'EWR'\n\tWHEN airportname IS NULL AND qa3 = 'Saint John, NB' THEN 'YSJ'\n\tWHEN airportname IS NULL AND qa3 = 'Sault Ste. Marie' THEN 'YAM'\n\tWHEN airportname IS NULL AND qa3 = 'Washington DC' THEN 'IAD'\n\tWHEN airportname IS NULL AND qa3 = 'Mont-Tremblant' THEN 'YTM'\n\tWHEN airportname IS NULL AND qa3 = 'St John''s' THEN 'YYT'\n\tWHEN airportname IS NULL AND qa3 = 'St John''s, NL' THEN 'YYT'\n\tELSE ISNULL(airportcode,'') END AS stationcode_update\nFROM $T{csatsurveyresponsetemp} AS sur\nLEFT JOIN (SELECT airportcode, airportname FROM public.airport) AS air\n\tON sur.qa3 = air.airportname --AND sur.qa3 >''\t"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"88631":{"id":88631,"inputCardinality":"ZERO_OR_MANY","outputCardinality":"MANY","implementationID":-1266674941,"x":564,"y":211,"width":32,"height":32,"inputConnectorIDs":[88633],"outputConnectorIDs":[88635],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"add_csatscore"}}}},"visible":true},"2":{"slot":2,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SELECT\n*\n,CASE WHEN QA1 <> '' AND QA2 <> '' THEN 1 ELSE 0 END AS surveycompleteflag\n,CASE WHEN qa1 in ('Extremely satisfied') THEN 1  /*scores satisfied or better get csat score of 1*/\n\t\tWHEN qa1 = 'Satisfied' THEN 1\n        WHEN qa1 = 'Neither satisfied nor dissatisfied' THEN 0\n        WHEN qa1 = 'Dissatisfied' THEN 0\n        WHEN qa1 = 'Extremely dissatisfied' THEN 0\n        END as csatscore_update\n,getdate() AS createdttm\nFROM $T{add_stationcode}"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"88632":{"id":88632,"inputCardinality":"ONE","outputCardinality":"ZERO","implementationID":-1848704949,"x":724,"y":204,"width":32,"height":32,"inputConnectorIDs":[88635],"outputConnectorIDs":[],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"csatsurveyresponse"}}}},"visible":true},"2":{"slot":2,"name":"Target Table Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"csatsurveyresponse"}}}},"visible":true},"3":{"slot":3,"name":"Fix Data Type Mismatches","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"4":{"slot":4,"name":"Column Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"csatsurveyid"},"2":{"slot":2,"type":"STRING","value":"csatsurveyid"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"surveydatetimeutc"},"2":{"slot":2,"type":"STRING","value":"surveyresponsecreatedatetimeutc"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"ipaddress"},"2":{"slot":2,"type":"STRING","value":"ipaddress"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"customerid"},"2":{"slot":2,"type":"STRING","value":"customerid"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"stationcode_update"},"2":{"slot":2,"type":"STRING","value":"stationcode"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"surveycompleteflag"},"2":{"slot":2,"type":"STRING","value":"surveycompleteflag"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"csatscore_update"},"2":{"slot":2,"type":"STRING","value":"csatscore"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"qa1"},"2":{"slot":2,"type":"STRING","value":"qa1"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"qa2"},"2":{"slot":2,"type":"STRING","value":"qa2"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"qa3"},"2":{"slot":2,"type":"STRING","value":"qa3"}}},"11":{"slot":11,"values":{"1":{"slot":1,"type":"STRING","value":"qa4"},"2":{"slot":2,"type":"STRING","value":"qa4"}}},"12":{"slot":12,"values":{"1":{"slot":1,"type":"STRING","value":"qa5"},"2":{"slot":2,"type":"STRING","value":"qa5"}}},"13":{"slot":13,"values":{"1":{"slot":1,"type":"STRING","value":"qa6"},"2":{"slot":2,"type":"STRING","value":"qa6"}}},"14":{"slot":14,"values":{"1":{"slot":1,"type":"STRING","value":"qa7"},"2":{"slot":2,"type":"STRING","value":"qa7"}}},"15":{"slot":15,"values":{"1":{"slot":1,"type":"STRING","value":"qa8"},"2":{"slot":2,"type":"STRING","value":"qa8"}}},"16":{"slot":16,"values":{"1":{"slot":1,"type":"STRING","value":"qa9"},"2":{"slot":2,"type":"STRING","value":"qa9"}}},"17":{"slot":17,"values":{"1":{"slot":1,"type":"STRING","value":"qa10"},"2":{"slot":2,"type":"STRING","value":"qa10"}}},"18":{"slot":18,"values":{"1":{"slot":1,"type":"STRING","value":"qa11"},"2":{"slot":2,"type":"STRING","value":"qa11"}}},"19":{"slot":19,"values":{"1":{"slot":1,"type":"STRING","value":"qa12"},"2":{"slot":2,"type":"STRING","value":"qa12"}}},"20":{"slot":20,"values":{"1":{"slot":1,"type":"STRING","value":"qa13"},"2":{"slot":2,"type":"STRING","value":"qa13"}}},"21":{"slot":21,"values":{"1":{"slot":1,"type":"STRING","value":"qa14"},"2":{"slot":2,"type":"STRING","value":"qa14"}}},"22":{"slot":22,"values":{"1":{"slot":1,"type":"STRING","value":"qa15"},"2":{"slot":2,"type":"STRING","value":"qa15"}}},"23":{"slot":23,"values":{"1":{"slot":1,"type":"STRING","value":"qa16"},"2":{"slot":2,"type":"STRING","value":"qa16"}}},"24":{"slot":24,"values":{"1":{"slot":1,"type":"STRING","value":"qa17"},"2":{"slot":2,"type":"STRING","value":"qa17"}}},"25":{"slot":25,"values":{"1":{"slot":1,"type":"STRING","value":"qa18"},"2":{"slot":2,"type":"STRING","value":"qa18"}}},"26":{"slot":26,"values":{"1":{"slot":1,"type":"STRING","value":"qa19"},"2":{"slot":2,"type":"STRING","value":"qa19"}}},"27":{"slot":27,"values":{"1":{"slot":1,"type":"STRING","value":"qa20"},"2":{"slot":2,"type":"STRING","value":"qa20"}}},"28":{"slot":28,"values":{"1":{"slot":1,"type":"STRING","value":"qa21"},"2":{"slot":2,"type":"STRING","value":"qa21"}}},"29":{"slot":29,"values":{"1":{"slot":1,"type":"STRING","value":"qa22"},"2":{"slot":2,"type":"STRING","value":"qa22"}}},"30":{"slot":30,"values":{"1":{"slot":1,"type":"STRING","value":"qa23"},"2":{"slot":2,"type":"STRING","value":"qa23"}}},"31":{"slot":31,"values":{"1":{"slot":1,"type":"STRING","value":"qa24"},"2":{"slot":2,"type":"STRING","value":"qa24"}}},"32":{"slot":32,"values":{"1":{"slot":1,"type":"STRING","value":"qa25"},"2":{"slot":2,"type":"STRING","value":"qa25"}}},"33":{"slot":33,"values":{"1":{"slot":1,"type":"STRING","value":"qa26"},"2":{"slot":2,"type":"STRING","value":"qa26"}}},"34":{"slot":34,"values":{"1":{"slot":1,"type":"STRING","value":"qa27"},"2":{"slot":2,"type":"STRING","value":"qa27"}}},"35":{"slot":35,"values":{"1":{"slot":1,"type":"STRING","value":"qa28"},"2":{"slot":2,"type":"STRING","value":"qa28"}}},"36":{"slot":36,"values":{"1":{"slot":1,"type":"STRING","value":"createdttm"},"2":{"slot":2,"type":"STRING","value":"createdttm"}}},"37":{"slot":37,"values":{"1":{"slot":1,"type":"STRING","value":"surveymonkeyresponseid"},"2":{"slot":2,"type":"STRING","value":"surveymonkeyresponseid"}}},"38":{"slot":38,"values":{"1":{"slot":1,"type":"STRING","value":"surveydatetime"},"2":{"slot":2,"type":"STRING","value":"surveydatetime"}}},"39":{"slot":39,"values":{"1":{"slot":1,"type":"STRING","value":"surveymonkeycompleteflag"},"2":{"slot":2,"type":"STRING","value":"surveymonkeycompleteflag"}}},"40":{"slot":40,"values":{"1":{"slot":1,"type":"STRING","value":"surveyresponsemodifieddatetimeutc"},"2":{"slot":2,"type":"STRING","value":"surveyresponsemodifieddatetimeutc"}}},"41":{"slot":41,"values":{"1":{"slot":1,"type":"STRING","value":"surveydatetimeutc"},"2":{"slot":2,"type":"STRING","value":"surveydatetimeutc"}}},"42":{"slot":42,"values":{"1":{"slot":1,"type":"STRING","value":"surveydatetime"},"2":{"slot":2,"type":"STRING","value":"surveyresponsecreatedatetime"}}},"43":{"slot":43,"values":{"1":{"slot":1,"type":"STRING","value":"surveyresponsemodifieddatetime"},"2":{"slot":2,"type":"STRING","value":"surveyresponsemodifieddatetime"}}}},"visible":true},"5":{"slot":5,"name":"Unique Keys","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"csatsurveyid"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"surveymonkeyresponseid"}}}},"visible":true},"6":{"slot":6,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"public"}}}},"visible":true},"7":{"slot":7,"name":"Update Strategy","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Update/Insert"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"}},"connectors":{"88633":{"id":88633,"sourceID":88630,"targetID":88631},"88635":{"id":88635,"sourceID":88631,"targetID":88632},"88634":{"id":88634,"sourceID":88629,"targetID":88630}},"canUndo":false,"undoCommand":"","undoCreated":-1,"canRedo":false,"redoCommand":"","redoCreated":-1,"notes":{"88628":{"id":88628,"x":116,"y":22,"width":505,"height":114,"text":"maps the survey responses to the questions to load into the public schema.\n\nadditional calculated columns are added to the each record before being inserted into the csatsurveyresponse table\n\nupdated: 2019-01-09\n\n","colour":"e6e63c"}},"noteConnectors":{},"variables":{},"grids":{}},"info":{"name":"CSAT - English Survey Format Insert","description":"","type":"TRANSFORMATION"}}