{"job":{"components":{"63030":{"id":63030,"inputCardinality":"ZERO","outputCardinality":"MANY","implementationID":1354890871,"x":381,"y":141,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[63033],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"public.flightdetailhistory"}}}},"visible":true},"2":{"slot":2,"name":"Table Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"flightdetailhistory"}}}},"visible":true},"3":{"slot":3,"name":"Column Names","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"flightdetailhistoryid"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"effectivedatetimeutc"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"expireddatetimeutc"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"carriercode"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"registrationnumber"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"tailnumber"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"uncorrectedtailnumber"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"flightnumber"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"flightdate"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"departurestation"}}},"11":{"slot":11,"values":{"1":{"slot":1,"type":"STRING","value":"arrivalstation"}}},"12":{"slot":12,"values":{"1":{"slot":1,"type":"STRING","value":"std"}}},"13":{"slot":13,"values":{"1":{"slot":1,"type":"STRING","value":"sta"}}},"14":{"slot":14,"values":{"1":{"slot":1,"type":"STRING","value":"etd"}}},"15":{"slot":15,"values":{"1":{"slot":1,"type":"STRING","value":"eta"}}},"16":{"slot":16,"values":{"1":{"slot":1,"type":"STRING","value":"outtime"}}},"17":{"slot":17,"values":{"1":{"slot":1,"type":"STRING","value":"offtime"}}},"18":{"slot":18,"values":{"1":{"slot":1,"type":"STRING","value":"ontime"}}},"19":{"slot":19,"values":{"1":{"slot":1,"type":"STRING","value":"intime"}}},"20":{"slot":20,"values":{"1":{"slot":1,"type":"STRING","value":"stdutc"}}},"21":{"slot":21,"values":{"1":{"slot":1,"type":"STRING","value":"stautc"}}},"22":{"slot":22,"values":{"1":{"slot":1,"type":"STRING","value":"etdutc"}}},"23":{"slot":23,"values":{"1":{"slot":1,"type":"STRING","value":"etautc"}}},"24":{"slot":24,"values":{"1":{"slot":1,"type":"STRING","value":"outtimeutc"}}},"25":{"slot":25,"values":{"1":{"slot":1,"type":"STRING","value":"offtimeutc"}}},"26":{"slot":26,"values":{"1":{"slot":1,"type":"STRING","value":"ontimeutc"}}},"27":{"slot":27,"values":{"1":{"slot":1,"type":"STRING","value":"intimeutc"}}},"28":{"slot":28,"values":{"1":{"slot":1,"type":"STRING","value":"departureoveralldelaytime"}}},"29":{"slot":29,"values":{"1":{"slot":1,"type":"STRING","value":"departureoveralldelaycode"}}},"30":{"slot":30,"values":{"1":{"slot":1,"type":"STRING","value":"departureoveralldelaycontrollable"}}},"31":{"slot":31,"values":{"1":{"slot":1,"type":"STRING","value":"departuredelaycode1"}}},"32":{"slot":32,"values":{"1":{"slot":1,"type":"STRING","value":"departuredelaytime1"}}},"33":{"slot":33,"values":{"1":{"slot":1,"type":"STRING","value":"departuredelaycontrollable1"}}},"34":{"slot":34,"values":{"1":{"slot":1,"type":"STRING","value":"departuredelaycode2"}}},"35":{"slot":35,"values":{"1":{"slot":1,"type":"STRING","value":"departuredelaytime2"}}},"36":{"slot":36,"values":{"1":{"slot":1,"type":"STRING","value":"departuredelaycontrollable2"}}},"37":{"slot":37,"values":{"1":{"slot":1,"type":"STRING","value":"departuredelaycode3"}}},"38":{"slot":38,"values":{"1":{"slot":1,"type":"STRING","value":"departuredelaytime3"}}},"39":{"slot":39,"values":{"1":{"slot":1,"type":"STRING","value":"departuredelaycontrollable3"}}},"40":{"slot":40,"values":{"1":{"slot":1,"type":"STRING","value":"arrivaloveralldelaytime"}}},"41":{"slot":41,"values":{"1":{"slot":1,"type":"STRING","value":"arrivaloveralldelaycode"}}},"42":{"slot":42,"values":{"1":{"slot":1,"type":"STRING","value":"arrivaloveralldelaycontrollable"}}},"43":{"slot":43,"values":{"1":{"slot":1,"type":"STRING","value":"arrivaldelaycode1"}}},"44":{"slot":44,"values":{"1":{"slot":1,"type":"STRING","value":"arrivaldelaytime1"}}},"45":{"slot":45,"values":{"1":{"slot":1,"type":"STRING","value":"arrivaldelaycontrollable1"}}},"46":{"slot":46,"values":{"1":{"slot":1,"type":"STRING","value":"arrivaldelaycode2"}}},"47":{"slot":47,"values":{"1":{"slot":1,"type":"STRING","value":"arrivaldelaytime2"}}},"48":{"slot":48,"values":{"1":{"slot":1,"type":"STRING","value":"arrivaldelaycontrollable2"}}},"49":{"slot":49,"values":{"1":{"slot":1,"type":"STRING","value":"iropcode"}}},"50":{"slot":50,"values":{"1":{"slot":1,"type":"STRING","value":"pairingid"}}},"51":{"slot":51,"values":{"1":{"slot":1,"type":"STRING","value":"leghashkey"}}},"52":{"slot":52,"values":{"1":{"slot":1,"type":"STRING","value":"createdttm"}}},"53":{"slot":53,"values":{"1":{"slot":1,"type":"STRING","value":"modifieddttm"}}},"54":{"slot":54,"values":{"1":{"slot":1,"type":"STRING","value":"activeflag"}}}},"visible":true},"4":{"slot":4,"name":"Trim Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true},"5":{"slot":5,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"public"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"63031":{"id":63031,"inputCardinality":"ZERO_OR_MANY","outputCardinality":"MANY","implementationID":-1266674941,"x":544,"y":144,"width":32,"height":32,"inputConnectorIDs":[63033],"outputConnectorIDs":[63034],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"format"}}}},"visible":true},"2":{"slot":2,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SELECT \nfeh.eventdatetimeutc, feh.flightnumber, feh.flightdate, feh.departurestation, feh.arrivalstation, fdh.iropcode\n--INTO stage.flightcanceliropcode20191216  --DROP TABLE stage.flightcanceliropcode20191216\nFROM public.flighteventhistory  AS feh\nINNER JOIN $T{public.flightdetailhistory} AS fdh\nON feh.carriercode = fdh.carriercode AND feh.flightnumber = fdh.flightnumber\nAND feh.flightdate = fdh.flightdate AND feh.departurestation = fdh.departurestation\nAND feh.arrivalstation = fdh.arrivalstation\nAND fdh.expireddatetimeutc = '9999-12-31 00:00:00' AND fdh.activeflag = 1 AND feh.flightdate >='2019-06-01'\nWHERE feh.carriercode = 'PD' AND feh.eventname = 'CANCEL FLIGHT' AND POSITION('X' IN fdh.iropcode) = 0 /*the final irop code is not a cancel code */\n/* identify any history records after the cancelation that change the iropcode to a non cancel code */\nAND EXISTS (SELECT 1 FROM public.flightdetailhistory AS fdh2\n\t\t\tWHERE feh.carriercode = fdh2.carriercode AND feh.flightnumber = fdh2.flightnumber\n\t\t\tAND feh.flightdate = fdh2.flightdate AND feh.departurestation = fdh2.departurestation\n\t\t\tAND feh.arrivalstation = fdh2.arrivalstation\n\t\t\tAND feh.eventdatetimeutc < fdh2.effectivedatetimeutc\n\t\t\tAND POSITION('IR' IN fdh2.iropcode) > 0 \n\t\t\tAND fdh2.activeflag = 1)"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"63032":{"id":63032,"inputCardinality":"ONE","outputCardinality":"ZERO","implementationID":335239555,"x":720,"y":144,"width":32,"height":32,"inputConnectorIDs":[63034],"outputConnectorIDs":[],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"etl.flightcanceliropcodeupdate"}}}},"visible":true},"2":{"slot":2,"name":"Target Table Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"flightcanceliropcodeupdate"}}}},"visible":true},"3":{"slot":3,"name":"Table Sort Key","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"flightdate"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"flightnumber"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"eventdatetimeutc"}}}},"visible":true},"4":{"slot":4,"name":"Table Distribution Style","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Even"}}}},"visible":true},"5":{"slot":5,"name":"Table Distribution Key","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":null}}}},"visible":false},"6":{"slot":6,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"etl"}}}},"visible":true},"7":{"slot":7,"name":"Sort Key Options","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Compound"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"}},"connectors":{"63033":{"id":63033,"sourceID":63030,"targetID":63031},"63034":{"id":63034,"sourceID":63031,"targetID":63032}},"canUndo":false,"undoCommand":"","undoCreated":-1,"canRedo":false,"redoCommand":"","redoCreated":-1,"notes":{"63029":{"id":63029,"x":366,"y":26,"width":336,"height":61,"text":"identify any flight instances that has cancel and return base flights\n\nupdated:2019-12-17","colour":"e6e63c"}},"noteConnectors":{},"variables":{},"grids":{}},"info":{"name":"OPS - Flight Detail History Cancel Flight Update","description":"","type":"TRANSFORMATION"}}