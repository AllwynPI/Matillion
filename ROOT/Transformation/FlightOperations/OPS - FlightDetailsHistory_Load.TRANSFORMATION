{"job":{"components":{"52950":{"id":52950,"inputCardinality":"ZERO","outputCardinality":"MANY","implementationID":1354890871,"x":-32,"y":256,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[52962],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"flightdetailupdate1"}}}},"visible":true},"2":{"slot":2,"name":"Table Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"flightdetailupdate1"}}}},"visible":true},"3":{"slot":3,"name":"Column Names","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"leghashkey"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"changetimeutc"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"carriercode"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"flightnumber"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"flightdate"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"departurestation"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"arrivalstation"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"tailnum"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"uncorrectedtailnum"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"delaycode"}}},"11":{"slot":11,"values":{"1":{"slot":1,"type":"STRING","value":"iropstatus"}}},"12":{"slot":12,"values":{"1":{"slot":1,"type":"STRING","value":"sdt"}}},"13":{"slot":13,"values":{"1":{"slot":1,"type":"STRING","value":"sat"}}},"14":{"slot":14,"values":{"1":{"slot":1,"type":"STRING","value":"edt"}}},"15":{"slot":15,"values":{"1":{"slot":1,"type":"STRING","value":"eat"}}},"16":{"slot":16,"values":{"1":{"slot":1,"type":"STRING","value":"edtc"}}},"17":{"slot":17,"values":{"1":{"slot":1,"type":"STRING","value":"intime"}}},"18":{"slot":18,"values":{"1":{"slot":1,"type":"STRING","value":"intime_utc"}}},"19":{"slot":19,"values":{"1":{"slot":1,"type":"STRING","value":"offtime"}}},"20":{"slot":20,"values":{"1":{"slot":1,"type":"STRING","value":"offtime_utc"}}},"21":{"slot":21,"values":{"1":{"slot":1,"type":"STRING","value":"ontime"}}},"22":{"slot":22,"values":{"1":{"slot":1,"type":"STRING","value":"ontime_utc"}}},"23":{"slot":23,"values":{"1":{"slot":1,"type":"STRING","value":"outtime"}}},"24":{"slot":24,"values":{"1":{"slot":1,"type":"STRING","value":"outtime_utc"}}},"25":{"slot":25,"values":{"1":{"slot":1,"type":"STRING","value":"sta_utc"}}},"26":{"slot":26,"values":{"1":{"slot":1,"type":"STRING","value":"std_utc"}}},"27":{"slot":27,"values":{"1":{"slot":1,"type":"STRING","value":"eta_utc"}}},"28":{"slot":28,"values":{"1":{"slot":1,"type":"STRING","value":"etd_utc"}}},"29":{"slot":29,"values":{"1":{"slot":1,"type":"STRING","value":"arrdelaycode1"}}},"30":{"slot":30,"values":{"1":{"slot":1,"type":"STRING","value":"arrdelaytime1"}}},"31":{"slot":31,"values":{"1":{"slot":1,"type":"STRING","value":"arrdelaycontrollable1"}}},"32":{"slot":32,"values":{"1":{"slot":1,"type":"STRING","value":"arrdelaycode2"}}},"33":{"slot":33,"values":{"1":{"slot":1,"type":"STRING","value":"arrdelaytime2"}}},"34":{"slot":34,"values":{"1":{"slot":1,"type":"STRING","value":"arrdelaycontrollable2"}}},"35":{"slot":35,"values":{"1":{"slot":1,"type":"STRING","value":"depdelaycode1"}}},"36":{"slot":36,"values":{"1":{"slot":1,"type":"STRING","value":"depdelaytime1"}}},"37":{"slot":37,"values":{"1":{"slot":1,"type":"STRING","value":"depdelaycontrollable1"}}},"38":{"slot":38,"values":{"1":{"slot":1,"type":"STRING","value":"depdelaycode2"}}},"39":{"slot":39,"values":{"1":{"slot":1,"type":"STRING","value":"depdelaytime2"}}},"40":{"slot":40,"values":{"1":{"slot":1,"type":"STRING","value":"depdelaycontrollable2"}}},"41":{"slot":41,"values":{"1":{"slot":1,"type":"STRING","value":"depdelaycode3"}}},"42":{"slot":42,"values":{"1":{"slot":1,"type":"STRING","value":"depdelaytime3"}}},"43":{"slot":43,"values":{"1":{"slot":1,"type":"STRING","value":"depdelaycontrollable3"}}},"44":{"slot":44,"values":{"1":{"slot":1,"type":"STRING","value":"arroveralldelaycalctime"}}},"45":{"slot":45,"values":{"1":{"slot":1,"type":"STRING","value":"arroveralldelaycode"}}},"46":{"slot":46,"values":{"1":{"slot":1,"type":"STRING","value":"arroveralldelaycontrollable"}}},"47":{"slot":47,"values":{"1":{"slot":1,"type":"STRING","value":"depoveralldelaycalctime"}}},"48":{"slot":48,"values":{"1":{"slot":1,"type":"STRING","value":"depoveralldelaycode"}}},"49":{"slot":49,"values":{"1":{"slot":1,"type":"STRING","value":"depoveralldelaycontrollable"}}},"50":{"slot":50,"values":{"1":{"slot":1,"type":"STRING","value":"pairingid"}}}},"visible":true},"4":{"slot":4,"name":"Trim Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true},"5":{"slot":5,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"52951":{"id":52951,"inputCardinality":"ZERO_OR_MANY","outputCardinality":"MANY","implementationID":-1266674941,"x":256,"y":256,"width":32,"height":32,"inputConnectorIDs":[52962],"outputConnectorIDs":[52958],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SQL 0"}}}},"visible":true},"2":{"slot":2,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"select changetimeutc,\n(case when version_end_date='9999-12-31' \n then version_end_date \n /* updated 2019-11-17 else dateadd(s,-1,version_end_date) */\n else dateadd(ms,-1,version_end_date) \n end) expireddatetime\n,carriercode,registrationnumber, tailnum as tailnum, \nuncorrectedtailnum,\n(case when flightnumber='' then '0' \n      when len(flightnumber)=7 then substring(flightnumber,4,4) \n \t\twhen flightnumber = '560Q' then '560'\n \t\telse flightnumber end)::int as flightnumber\n,to_date(substring(leghashkey,1,10),'yyyy-mm-dd') as flightdate\n,departurestation, arrivalstation\n,cast((case when  isnull(sdt,'')='' then '1900-01-01 00:00:00' else sdt end) as timestamp) as sdt \n,cast((case when  isnull(sat,'')='' then '1900-01-01 00:00:00' else sat end) as timestamp) as sat\n,cast((case when  isnull(edt,'')='' then '1900-01-01 00:00:00' else edt end) as timestamp) as edt\n,cast((case when  isnull(eat,'')='' then '1900-01-01 00:00:00' else eat end) as timestamp) as eat\n,cast((case when  isnull(outtime,'')='' then '1900-01-01 00:00:00' else outtime end) as timestamp) as outtime\n,cast((case when  isnull(offtime,'')='' then '1900-01-01 00:00:00' else offtime end) as timestamp) as offtime\n,cast((case when  isnull(ontime,'')='' then '1900-01-01 00:00:00' else ontime end) as timestamp) as ontime\n,cast((case when  isnull(intime,'')='' then '1900-01-01 00:00:00' else intime end) as timestamp) as intime\n,cast((case when  isnull(std_utc,'')= ''  then '1900-01-01 00:00:00' else std_utc end) as timestamp) as  std_utc\n,cast((case when  isnull(sta_utc,'')= ''  then '1900-01-01 00:00:00' else sta_utc end) as timestamp) as  sta_utc\n,cast((case when  isnull(etd_utc,'')= ''  then '1900-01-01 00:00:00' else etd_utc end) as timestamp) as  etd_utc\n,cast((case when  isnull(eta_utc,'')= ''  then '1900-01-01 00:00:00' else eta_utc end) as timestamp) as  eta_utc\n,cast((case when  isnull(outtime_utc,'')= ''  then '1900-01-01 00:00:00' else outtime_utc end) as timestamp) as  outtime_utc\n,cast((case when  isnull(offtime_utc,'')= ''  then '1900-01-01 00:00:00' else offtime_utc end) as timestamp) as  offtime_utc\n,cast((case when  isnull(ontime_utc,'')= ''  then '1900-01-01 00:00:00' else ontime_utc end) as timestamp) as  ontime_utc\n,cast((case when  isnull(intime_utc,'')= ''  then '1900-01-01 00:00:00' else intime_utc end) as timestamp) as  intime_utc\n,delaycode, iropstatus, leghashkey\n,ArrDelayCode1\n,cast((case when isnull(ArrDelayTime1,'')='' then '0' else ArrDelayTime1 end) as integer) as ArrDelayTime1\n--,(case when ArrDelayControllable1='t' then '1' else '0' end) as \n,ArrDelayControllable1\n,ArrDelayCode2\n,cast((case when isnull(ArrDelayTime2,'')='' then '0' else ArrDelayTime2  end) as integer) as ArrDelayTime2\n--,(case when ArrDelayControllable2='t' then '1' else '0' end) as \n,ArrDelayControllable2\n,DepDelayCode1\n,cast((case when isnull(DepDelayTime1,'')='' then '0' else DepDelayTime1 end) as integer) as DepDelayTime1\n--,(case when DepDelayControllable1='t' then '1' else '0' end) as \n,DepDelayControllable1\n,DepDelayCode2\n,cast((case when isnull(DepDelayTime2,'')='' then '0' else DepDelayTime2 end) as integer) as DepDelayTime2\n--,(case when DepDelayControllable2='t' then '1' else '0' end) as \n,DepDelayControllable2\n,DepDelayCode3\n,cast((case when isnull(DepDelayTime3,'')='' then '0' else DepDelayTime3 end) as integer) as DepDelayTime3\n--,(case when DepDelayControllable3='t' then '1' else '0' end) as \n,DepDelayControllable3\n,cast((case when isnull(ArrOverallDelayCalcTime,'')='' then '0' else ArrOverallDelayCalcTime end) as integer) as ArrOverallDelayCalcTime\n,ArrOverallDelayCode\n--,(case when ArrOverallDelayControllable='t' then '1' else '0' end) as \n,ArrOverallDelayControllable\n,cast((case when isnull(DepOverallDelayCalcTime ,'')='' then '0' else DepOverallDelayCalcTime end) as integer) as DepOverallDelayCalcTime\n--,(case when DepOverallDelayControllable='t' then '1' else '0' end) as \n,DepOverallDelayControllable\n,substring(depoveralldelaycode,1,8) as depoveralldelaycode\n, pairingid\nfrom \n(select B.*,\n(case when RANK_=1 then '9999-12-31' else \nLAG(changetimeutc) over (partition by substring(leghashkey,1,26) order by RANK_) end) version_end_date,0 registrationnumber\nfrom\n(select A.*, rank() over(partition by substring(leghashkey,1,26) order by changetimeutc desc) RANK_\nfrom etl.flightdetailupdate1 A\norder by leghashkey) as B)"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"52952":{"id":52952,"inputCardinality":"ONE","outputCardinality":"ZERO","implementationID":-1848704949,"x":944,"y":336,"width":32,"height":32,"inputConnectorIDs":[52960],"outputConnectorIDs":[],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"flightdetailhistory"}}}},"visible":true},"2":{"slot":2,"name":"Target Table Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"flightdetailhistory"}}}},"visible":true},"3":{"slot":3,"name":"Fix Data Type Mismatches","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true},"4":{"slot":4,"name":"Column Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"changetimeutc"},"2":{"slot":2,"type":"STRING","value":"effectivedatetimeutc"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"expireddatetime"},"2":{"slot":2,"type":"STRING","value":"expireddatetimeutc"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"carriercode"},"2":{"slot":2,"type":"STRING","value":"carriercode"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"registrationnumber"},"2":{"slot":2,"type":"STRING","value":"registrationnumber"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"tailnum"},"2":{"slot":2,"type":"STRING","value":"tailnumber"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"uncorrectedtailnum"},"2":{"slot":2,"type":"STRING","value":"uncorrectedtailnumber"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"flightnumber"},"2":{"slot":2,"type":"STRING","value":"flightnumber"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"flightdate"},"2":{"slot":2,"type":"STRING","value":"flightdate"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"departurestation"},"2":{"slot":2,"type":"STRING","value":"departurestation"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"arrivalstation"},"2":{"slot":2,"type":"STRING","value":"arrivalstation"}}},"11":{"slot":11,"values":{"1":{"slot":1,"type":"STRING","value":"sdt"},"2":{"slot":2,"type":"STRING","value":"std"}}},"12":{"slot":12,"values":{"1":{"slot":1,"type":"STRING","value":"sat"},"2":{"slot":2,"type":"STRING","value":"sta"}}},"13":{"slot":13,"values":{"1":{"slot":1,"type":"STRING","value":"edt"},"2":{"slot":2,"type":"STRING","value":"etd"}}},"14":{"slot":14,"values":{"1":{"slot":1,"type":"STRING","value":"eat"},"2":{"slot":2,"type":"STRING","value":"eta"}}},"15":{"slot":15,"values":{"1":{"slot":1,"type":"STRING","value":"outtime"},"2":{"slot":2,"type":"STRING","value":"outtime"}}},"16":{"slot":16,"values":{"1":{"slot":1,"type":"STRING","value":"offtime"},"2":{"slot":2,"type":"STRING","value":"offtime"}}},"17":{"slot":17,"values":{"1":{"slot":1,"type":"STRING","value":"ontime"},"2":{"slot":2,"type":"STRING","value":"ontime"}}},"18":{"slot":18,"values":{"1":{"slot":1,"type":"STRING","value":"intime"},"2":{"slot":2,"type":"STRING","value":"intime"}}},"19":{"slot":19,"values":{"1":{"slot":1,"type":"STRING","value":"std_utc"},"2":{"slot":2,"type":"STRING","value":"stdutc"}}},"20":{"slot":20,"values":{"1":{"slot":1,"type":"STRING","value":"sta_utc"},"2":{"slot":2,"type":"STRING","value":"stautc"}}},"21":{"slot":21,"values":{"1":{"slot":1,"type":"STRING","value":"etd_utc"},"2":{"slot":2,"type":"STRING","value":"etdutc"}}},"22":{"slot":22,"values":{"1":{"slot":1,"type":"STRING","value":"eta_utc"},"2":{"slot":2,"type":"STRING","value":"etautc"}}},"23":{"slot":23,"values":{"1":{"slot":1,"type":"STRING","value":"outtime_utc"},"2":{"slot":2,"type":"STRING","value":"outtimeutc"}}},"24":{"slot":24,"values":{"1":{"slot":1,"type":"STRING","value":"offtime_utc"},"2":{"slot":2,"type":"STRING","value":"offtimeutc"}}},"25":{"slot":25,"values":{"1":{"slot":1,"type":"STRING","value":"ontime_utc"},"2":{"slot":2,"type":"STRING","value":"ontimeutc"}}},"26":{"slot":26,"values":{"1":{"slot":1,"type":"STRING","value":"intime_utc"},"2":{"slot":2,"type":"STRING","value":"intimeutc"}}},"27":{"slot":27,"values":{"1":{"slot":1,"type":"STRING","value":"depdelaycode1"},"2":{"slot":2,"type":"STRING","value":"departuredelaycode1"}}},"28":{"slot":28,"values":{"1":{"slot":1,"type":"STRING","value":"depdelaycode2"},"2":{"slot":2,"type":"STRING","value":"departuredelaycode2"}}},"29":{"slot":29,"values":{"1":{"slot":1,"type":"STRING","value":"depdelaycode3"},"2":{"slot":2,"type":"STRING","value":"departuredelaycode3"}}},"30":{"slot":30,"values":{"1":{"slot":1,"type":"STRING","value":"iropstatus"},"2":{"slot":2,"type":"STRING","value":"iropcode"}}},"31":{"slot":31,"values":{"1":{"slot":1,"type":"STRING","value":"leghashkey"},"2":{"slot":2,"type":"STRING","value":"leghashkey"}}},"32":{"slot":32,"values":{"1":{"slot":1,"type":"STRING","value":"ArrDelayCode1"},"2":{"slot":2,"type":"STRING","value":"arrivaldelaycode1"}}},"33":{"slot":33,"values":{"1":{"slot":1,"type":"STRING","value":"ArrDelayTime1"},"2":{"slot":2,"type":"STRING","value":"arrivaldelaytime1"}}},"34":{"slot":34,"values":{"1":{"slot":1,"type":"STRING","value":"fltcancelflg"},"2":{"slot":2,"type":"STRING","value":"activeflag"}}},"35":{"slot":35,"values":{"1":{"slot":1,"type":"STRING","value":"depoveralldelaycontrollable"},"2":{"slot":2,"type":"STRING","value":"departureoveralldelaycontrollable"}}},"36":{"slot":36,"values":{"1":{"slot":1,"type":"STRING","value":"depoveralldelaycode"},"2":{"slot":2,"type":"STRING","value":"departureoveralldelaycode"}}},"37":{"slot":37,"values":{"1":{"slot":1,"type":"STRING","value":"depoveralldelaycalctime"},"2":{"slot":2,"type":"STRING","value":"departureoveralldelaytime"}}},"38":{"slot":38,"values":{"1":{"slot":1,"type":"STRING","value":"arroveralldelaycontrollable"},"2":{"slot":2,"type":"STRING","value":"arrivaloveralldelaycontrollable"}}},"39":{"slot":39,"values":{"1":{"slot":1,"type":"STRING","value":"arroveralldelaycode"},"2":{"slot":2,"type":"STRING","value":"arrivaloveralldelaycode"}}},"40":{"slot":40,"values":{"1":{"slot":1,"type":"STRING","value":"arroveralldelaycalctime"},"2":{"slot":2,"type":"STRING","value":"arrivaloveralldelaytime"}}},"41":{"slot":41,"values":{"1":{"slot":1,"type":"STRING","value":"depdelaycontrollable3"},"2":{"slot":2,"type":"STRING","value":"departuredelaycontrollable3"}}},"42":{"slot":42,"values":{"1":{"slot":1,"type":"STRING","value":"depdelaytime3"},"2":{"slot":2,"type":"STRING","value":"departuredelaytime3"}}},"43":{"slot":43,"values":{"1":{"slot":1,"type":"STRING","value":"depdelaycontrollable2"},"2":{"slot":2,"type":"STRING","value":"departuredelaycontrollable2"}}},"44":{"slot":44,"values":{"1":{"slot":1,"type":"STRING","value":"depdelaytime2"},"2":{"slot":2,"type":"STRING","value":"departuredelaytime2"}}},"45":{"slot":45,"values":{"1":{"slot":1,"type":"STRING","value":"depdelaycontrollable1"},"2":{"slot":2,"type":"STRING","value":"departuredelaycontrollable1"}}},"46":{"slot":46,"values":{"1":{"slot":1,"type":"STRING","value":"depdelaytime1"},"2":{"slot":2,"type":"STRING","value":"departuredelaytime1"}}},"47":{"slot":47,"values":{"1":{"slot":1,"type":"STRING","value":"arrdelaycontrollable2"},"2":{"slot":2,"type":"STRING","value":"arrivaldelaycontrollable2"}}},"48":{"slot":48,"values":{"1":{"slot":1,"type":"STRING","value":"arrdelaytime2"},"2":{"slot":2,"type":"STRING","value":"arrivaldelaytime2"}}},"49":{"slot":49,"values":{"1":{"slot":1,"type":"STRING","value":"arrdelaycode2"},"2":{"slot":2,"type":"STRING","value":"arrivaldelaycode2"}}},"50":{"slot":50,"values":{"1":{"slot":1,"type":"STRING","value":"arrdelaycontrollable1"},"2":{"slot":2,"type":"STRING","value":"arrivaldelaycontrollable1"}}},"51":{"slot":51,"values":{"1":{"slot":1,"type":"STRING","value":"pairingid"},"2":{"slot":2,"type":"STRING","value":"pairingid"}}}},"visible":true},"5":{"slot":5,"name":"Unique Keys","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"flightnumber"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"flightdate"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"effectivedatetimeutc"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"leghashkey"}}}},"visible":true},"6":{"slot":6,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"public"}}}},"visible":true},"7":{"slot":7,"name":"Update Strategy","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Update/Insert"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"52953":{"id":52953,"inputCardinality":"ZERO_OR_MANY","outputCardinality":"MANY","implementationID":-1266674941,"x":256,"y":384,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[52957],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SQL 1"}}}},"visible":true},"2":{"slot":2,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"select C.carriercode,C.flightnumber, C.flightdate, C.departurestation, C.arrivalstation, C.changetimeutc, (case when version_end_date='9999-12-31' then version_end_date else dateadd(ms,-1,version_end_date) end) expireddatetime\nfrom\n(select carriercode,flightnumber, flightdate, departurestation, arrivalstation, changetimeutc, (case when RANK_=1 then '9999-12-31' else \nLAG(changetimeutc) over (partition by carriercode,flightnumber, flightdate, departurestation, arrivalstation order by RANK_) end) version_end_date\nfrom\n\t(select distinct carriercode,flightnumber, flightdate, departurestation, arrivalstation, changetimeutc, \n\t\trank() over(partition by carriercode,flightnumber, flightdate, departurestation, arrivalstation order by changetimeutc desc) RANK_ \n\t\tfrom\n\t\t\t(select distinct carriercode, --cast(flightnumber as int) as flightnumber, \n             (case when flightnumber='' then '0' when len(flightnumber)=7 then substring(flightnumber,4,4) \n \t\t\t\t\twhen flightnumber = '560Q' then '560'\n \t\t\t\t\telse flightnumber end)::int as flightnumber,\n             cast(flightdate as timestamp) as flightdate, \n\t\t\tdeparturestation, arrivalstation, cast(changetimeutc as timestamp) as changetimeutc from etl.flightdetailupdate1\n\t\t\tunion\n\t\t\tselect distinct carriercode, flightnumber, flightdate, departurestation, arrivalstation, effectivedatetimeutc \n\t\t\t\t\tfrom public.flightdetailhistory where LegHashkey in(select LegHashkey from etl.flightdetailupdate1)\n\t\t\t) A\n\t) B\n) C\n\n\n\n/* modified on 2019-05-09 to overcome the flight expirydate in case of multiple instances\nselect C.leghashkey, C.changetimeutc, (case when version_end_date='9999-12-31' then version_end_date else dateadd(s,-1,version_end_date) end) expireddatetime\nfrom\n(select leghashkey, changetimeutc, (case when RANK_=1 then '9999-12-31' else \nLAG(changetimeutc) over (partition by leghashkey order by RANK_) end) version_end_date\nfrom\n(select distinct leghashkey,changetimeutc, rank() over(partition by leghashkey order by changetimeutc desc) RANK_ \nfrom\n(select distinct leghashkey,changetimeutc from etl.flightdetailupdate1\nunion\nselect distinct leghashkey,effectivedatetimeutc from public.flightdetailhistory where LegHashkey in(select LegHashkey from etl.flightdetailupdate1)\n) A\n) B\n) C\n*/\n\n/*select C.leghashkey, C.changetimeutc, (case when version_end_date='9999-12-31' then version_end_date else dateadd(s,-1,version_end_date) end) expireddatetime\nfrom\n(select B.*, (case when RANK_=1 then '9999-12-31' else \nLAG(changetimeutc) over (partition by leghashkey order by RANK_) end) version_end_date\nfrom\n(select distinct leghashkey,changetimeutc, rank() over(partition by leghashkey order by changetimeutc desc) RANK_ \nfrom etl.flightdetailupdate1 A) B) C\norder by changetimeutc\n*/"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"52954":{"id":52954,"inputCardinality":"MANY","outputCardinality":"MANY","implementationID":-629958239,"x":480,"y":336,"width":32,"height":32,"inputConnectorIDs":[52957,52958],"outputConnectorIDs":[70560],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Join 0"}}}},"visible":true},"2":{"slot":2,"name":"Main Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SQL 0"}}}},"visible":true},"3":{"slot":3,"name":"Main Table Alias","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"taba"}}}},"visible":true},"4":{"slot":4,"name":"Joins","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SQL 1"},"2":{"slot":2,"type":"STRING","value":"tabb"},"3":{"slot":3,"type":"STRING","value":"Inner"}}}},"visible":true},"5":{"slot":5,"name":"Join Expressions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"\"taba\".\"changetimeutc\"= \"tabb\".\"changetimeutc\"\nAND \"taba\".\"carriercode\"=\"tabb\".\"carriercode\"\nAND \"taba\".\"flightnumber\"= \"tabb\".\"flightnumber\"\nAND \"taba\".\"flightdate\"=\"tabb\".\"flightdate\"\nAND \"taba\".\"departurestation\"=\"tabb\".\"departurestation\"\nAND \"taba\".\"arrivalstation\"=\"tabb\".\"arrivalstation\"\n"},"2":{"slot":2,"type":"STRING","value":"taba_Inner_tabb"}}}},"visible":true},"6":{"slot":6,"name":"Output Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"taba.changetimeutc"},"2":{"slot":2,"type":"STRING","value":"changetimeutc"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"taba.carriercode"},"2":{"slot":2,"type":"STRING","value":"carriercode"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"taba.registrationnumber"},"2":{"slot":2,"type":"STRING","value":"registrationnumber"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"taba.tailnum"},"2":{"slot":2,"type":"STRING","value":"tailnum"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"taba.uncorrectedtailnum"},"2":{"slot":2,"type":"STRING","value":"uncorrectedtailnum"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"taba.flightnumber"},"2":{"slot":2,"type":"STRING","value":"flightnumber"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"taba.flightdate"},"2":{"slot":2,"type":"STRING","value":"flightdate"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"taba.departurestation"},"2":{"slot":2,"type":"STRING","value":"departurestation"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"taba.arrivalstation"},"2":{"slot":2,"type":"STRING","value":"arrivalstation"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"taba.sdt"},"2":{"slot":2,"type":"STRING","value":"sdt"}}},"11":{"slot":11,"values":{"1":{"slot":1,"type":"STRING","value":"taba.sat"},"2":{"slot":2,"type":"STRING","value":"sat"}}},"12":{"slot":12,"values":{"1":{"slot":1,"type":"STRING","value":"taba.edt"},"2":{"slot":2,"type":"STRING","value":"edt"}}},"13":{"slot":13,"values":{"1":{"slot":1,"type":"STRING","value":"taba.eat"},"2":{"slot":2,"type":"STRING","value":"eat"}}},"14":{"slot":14,"values":{"1":{"slot":1,"type":"STRING","value":"taba.outtime"},"2":{"slot":2,"type":"STRING","value":"outtime"}}},"15":{"slot":15,"values":{"1":{"slot":1,"type":"STRING","value":"taba.offtime"},"2":{"slot":2,"type":"STRING","value":"offtime"}}},"16":{"slot":16,"values":{"1":{"slot":1,"type":"STRING","value":"taba.ontime"},"2":{"slot":2,"type":"STRING","value":"ontime"}}},"17":{"slot":17,"values":{"1":{"slot":1,"type":"STRING","value":"taba.intime"},"2":{"slot":2,"type":"STRING","value":"intime"}}},"18":{"slot":18,"values":{"1":{"slot":1,"type":"STRING","value":"taba.std_utc"},"2":{"slot":2,"type":"STRING","value":"std_utc"}}},"19":{"slot":19,"values":{"1":{"slot":1,"type":"STRING","value":"taba.sta_utc"},"2":{"slot":2,"type":"STRING","value":"sta_utc"}}},"20":{"slot":20,"values":{"1":{"slot":1,"type":"STRING","value":"taba.etd_utc"},"2":{"slot":2,"type":"STRING","value":"etd_utc"}}},"21":{"slot":21,"values":{"1":{"slot":1,"type":"STRING","value":"taba.eta_utc"},"2":{"slot":2,"type":"STRING","value":"eta_utc"}}},"22":{"slot":22,"values":{"1":{"slot":1,"type":"STRING","value":"taba.outtime_utc"},"2":{"slot":2,"type":"STRING","value":"outtime_utc"}}},"23":{"slot":23,"values":{"1":{"slot":1,"type":"STRING","value":"taba.offtime_utc"},"2":{"slot":2,"type":"STRING","value":"offtime_utc"}}},"24":{"slot":24,"values":{"1":{"slot":1,"type":"STRING","value":"taba.ontime_utc"},"2":{"slot":2,"type":"STRING","value":"ontime_utc"}}},"25":{"slot":25,"values":{"1":{"slot":1,"type":"STRING","value":"taba.intime_utc"},"2":{"slot":2,"type":"STRING","value":"intime_utc"}}},"26":{"slot":26,"values":{"1":{"slot":1,"type":"STRING","value":"taba.delaycode"},"2":{"slot":2,"type":"STRING","value":"delaycode"}}},"27":{"slot":27,"values":{"1":{"slot":1,"type":"STRING","value":"taba.iropstatus"},"2":{"slot":2,"type":"STRING","value":"iropstatus"}}},"28":{"slot":28,"values":{"1":{"slot":1,"type":"STRING","value":"taba.leghashkey"},"2":{"slot":2,"type":"STRING","value":"leghashkey"}}},"29":{"slot":29,"values":{"1":{"slot":1,"type":"STRING","value":"taba.arrdelaycode1"},"2":{"slot":2,"type":"STRING","value":"arrdelaycode1"}}},"30":{"slot":30,"values":{"1":{"slot":1,"type":"STRING","value":"taba.arrdelaytime1"},"2":{"slot":2,"type":"STRING","value":"arrdelaytime1"}}},"31":{"slot":31,"values":{"1":{"slot":1,"type":"STRING","value":"taba.arrdelaycontrollable1"},"2":{"slot":2,"type":"STRING","value":"arrdelaycontrollable1"}}},"32":{"slot":32,"values":{"1":{"slot":1,"type":"STRING","value":"taba.arrdelaycode2"},"2":{"slot":2,"type":"STRING","value":"arrdelaycode2"}}},"33":{"slot":33,"values":{"1":{"slot":1,"type":"STRING","value":"taba.arrdelaytime2"},"2":{"slot":2,"type":"STRING","value":"arrdelaytime2"}}},"34":{"slot":34,"values":{"1":{"slot":1,"type":"STRING","value":"taba.arrdelaycontrollable2"},"2":{"slot":2,"type":"STRING","value":"arrdelaycontrollable2"}}},"35":{"slot":35,"values":{"1":{"slot":1,"type":"STRING","value":"taba.depdelaycode1"},"2":{"slot":2,"type":"STRING","value":"depdelaycode1"}}},"36":{"slot":36,"values":{"1":{"slot":1,"type":"STRING","value":"taba.depdelaytime1"},"2":{"slot":2,"type":"STRING","value":"depdelaytime1"}}},"37":{"slot":37,"values":{"1":{"slot":1,"type":"STRING","value":"taba.depdelaycontrollable1"},"2":{"slot":2,"type":"STRING","value":"depdelaycontrollable1"}}},"38":{"slot":38,"values":{"1":{"slot":1,"type":"STRING","value":"taba.depdelaycode2"},"2":{"slot":2,"type":"STRING","value":"depdelaycode2"}}},"39":{"slot":39,"values":{"1":{"slot":1,"type":"STRING","value":"taba.depdelaytime2"},"2":{"slot":2,"type":"STRING","value":"depdelaytime2"}}},"40":{"slot":40,"values":{"1":{"slot":1,"type":"STRING","value":"taba.depdelaycontrollable2"},"2":{"slot":2,"type":"STRING","value":"depdelaycontrollable2"}}},"41":{"slot":41,"values":{"1":{"slot":1,"type":"STRING","value":"taba.depdelaycode3"},"2":{"slot":2,"type":"STRING","value":"depdelaycode3"}}},"42":{"slot":42,"values":{"1":{"slot":1,"type":"STRING","value":"taba.depdelaytime3"},"2":{"slot":2,"type":"STRING","value":"depdelaytime3"}}},"43":{"slot":43,"values":{"1":{"slot":1,"type":"STRING","value":"taba.depdelaycontrollable3"},"2":{"slot":2,"type":"STRING","value":"depdelaycontrollable3"}}},"44":{"slot":44,"values":{"1":{"slot":1,"type":"STRING","value":"taba.arroveralldelaycalctime"},"2":{"slot":2,"type":"STRING","value":"arroveralldelaycalctime"}}},"45":{"slot":45,"values":{"1":{"slot":1,"type":"STRING","value":"taba.arroveralldelaycode"},"2":{"slot":2,"type":"STRING","value":"arroveralldelaycode"}}},"46":{"slot":46,"values":{"1":{"slot":1,"type":"STRING","value":"taba.arroveralldelaycontrollable"},"2":{"slot":2,"type":"STRING","value":"arroveralldelaycontrollable"}}},"47":{"slot":47,"values":{"1":{"slot":1,"type":"STRING","value":"taba.depoveralldelaycalctime"},"2":{"slot":2,"type":"STRING","value":"depoveralldelaycalctime"}}},"48":{"slot":48,"values":{"1":{"slot":1,"type":"STRING","value":"taba.depoveralldelaycontrollable"},"2":{"slot":2,"type":"STRING","value":"depoveralldelaycontrollable"}}},"49":{"slot":49,"values":{"1":{"slot":1,"type":"STRING","value":"taba.pairingid"},"2":{"slot":2,"type":"STRING","value":"pairingid"}}},"50":{"slot":50,"values":{"1":{"slot":1,"type":"STRING","value":"taba.expireddatetime"},"2":{"slot":2,"type":"STRING","value":"expireddatetime"}}},"51":{"slot":51,"values":{"1":{"slot":1,"type":"STRING","value":"taba.depoveralldelaycode"},"2":{"slot":2,"type":"STRING","value":"depoveralldelaycode"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"52955":{"id":52955,"inputCardinality":"ZERO_OR_MANY","outputCardinality":"MANY","implementationID":-1266674941,"x":432,"y":480,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[52959],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SQL 2"}}}},"visible":true},"2":{"slot":2,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"select distinct legHashKey, 0 fltcancelflg\nfrom public.flightdetailhistory\nwhere uncorrectedtailnumber like '-%'\nand LegHashKey in (select LegHashKey from etl.flightdetailupdate1)"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"52956":{"id":52956,"inputCardinality":"MANY","outputCardinality":"MANY","implementationID":-629958239,"x":704,"y":336,"width":32,"height":32,"inputConnectorIDs":[70560,52959],"outputConnectorIDs":[52960],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Join 1"}}}},"visible":true},"2":{"slot":2,"name":"Main Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Join 0"}}}},"visible":true},"3":{"slot":3,"name":"Main Table Alias","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"main"}}}},"visible":true},"4":{"slot":4,"name":"Joins","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SQL 2"},"2":{"slot":2,"type":"STRING","value":"cncl"},"3":{"slot":3,"type":"STRING","value":"Left"}}}},"visible":true},"5":{"slot":5,"name":"Join Expressions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"\"main\".\"leghashkey\"=\"cncl\".\"leghashkey\""},"2":{"slot":2,"type":"STRING","value":"main_Left_cncl"}}}},"visible":true},"6":{"slot":6,"name":"Output Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"main.changetimeutc"},"2":{"slot":2,"type":"STRING","value":"changetimeutc"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"main.carriercode"},"2":{"slot":2,"type":"STRING","value":"carriercode"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"main.registrationnumber"},"2":{"slot":2,"type":"STRING","value":"registrationnumber"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"main.tailnum"},"2":{"slot":2,"type":"STRING","value":"tailnum"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"main.uncorrectedtailnum"},"2":{"slot":2,"type":"STRING","value":"uncorrectedtailnum"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"main.flightnumber"},"2":{"slot":2,"type":"STRING","value":"flightnumber"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"main.flightdate"},"2":{"slot":2,"type":"STRING","value":"flightdate"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"main.departurestation"},"2":{"slot":2,"type":"STRING","value":"departurestation"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"main.arrivalstation"},"2":{"slot":2,"type":"STRING","value":"arrivalstation"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"main.sdt"},"2":{"slot":2,"type":"STRING","value":"sdt"}}},"11":{"slot":11,"values":{"1":{"slot":1,"type":"STRING","value":"main.sat"},"2":{"slot":2,"type":"STRING","value":"sat"}}},"12":{"slot":12,"values":{"1":{"slot":1,"type":"STRING","value":"main.edt"},"2":{"slot":2,"type":"STRING","value":"edt"}}},"13":{"slot":13,"values":{"1":{"slot":1,"type":"STRING","value":"main.eat"},"2":{"slot":2,"type":"STRING","value":"eat"}}},"14":{"slot":14,"values":{"1":{"slot":1,"type":"STRING","value":"main.outtime"},"2":{"slot":2,"type":"STRING","value":"outtime"}}},"15":{"slot":15,"values":{"1":{"slot":1,"type":"STRING","value":"main.offtime"},"2":{"slot":2,"type":"STRING","value":"offtime"}}},"16":{"slot":16,"values":{"1":{"slot":1,"type":"STRING","value":"main.ontime"},"2":{"slot":2,"type":"STRING","value":"ontime"}}},"17":{"slot":17,"values":{"1":{"slot":1,"type":"STRING","value":"main.intime"},"2":{"slot":2,"type":"STRING","value":"intime"}}},"18":{"slot":18,"values":{"1":{"slot":1,"type":"STRING","value":"main.std_utc"},"2":{"slot":2,"type":"STRING","value":"std_utc"}}},"19":{"slot":19,"values":{"1":{"slot":1,"type":"STRING","value":"main.sta_utc"},"2":{"slot":2,"type":"STRING","value":"sta_utc"}}},"20":{"slot":20,"values":{"1":{"slot":1,"type":"STRING","value":"main.etd_utc"},"2":{"slot":2,"type":"STRING","value":"etd_utc"}}},"21":{"slot":21,"values":{"1":{"slot":1,"type":"STRING","value":"main.eta_utc"},"2":{"slot":2,"type":"STRING","value":"eta_utc"}}},"22":{"slot":22,"values":{"1":{"slot":1,"type":"STRING","value":"main.outtime_utc"},"2":{"slot":2,"type":"STRING","value":"outtime_utc"}}},"23":{"slot":23,"values":{"1":{"slot":1,"type":"STRING","value":"main.offtime_utc"},"2":{"slot":2,"type":"STRING","value":"offtime_utc"}}},"24":{"slot":24,"values":{"1":{"slot":1,"type":"STRING","value":"main.ontime_utc"},"2":{"slot":2,"type":"STRING","value":"ontime_utc"}}},"25":{"slot":25,"values":{"1":{"slot":1,"type":"STRING","value":"main.intime_utc"},"2":{"slot":2,"type":"STRING","value":"intime_utc"}}},"26":{"slot":26,"values":{"1":{"slot":1,"type":"STRING","value":"main.delaycode"},"2":{"slot":2,"type":"STRING","value":"delaycode"}}},"27":{"slot":27,"values":{"1":{"slot":1,"type":"STRING","value":"main.iropstatus"},"2":{"slot":2,"type":"STRING","value":"iropstatus"}}},"28":{"slot":28,"values":{"1":{"slot":1,"type":"STRING","value":"main.leghashkey"},"2":{"slot":2,"type":"STRING","value":"leghashkey"}}},"29":{"slot":29,"values":{"1":{"slot":1,"type":"STRING","value":"main.arrdelaycode1"},"2":{"slot":2,"type":"STRING","value":"arrdelaycode1"}}},"30":{"slot":30,"values":{"1":{"slot":1,"type":"STRING","value":"main.arrdelaytime1"},"2":{"slot":2,"type":"STRING","value":"arrdelaytime1"}}},"31":{"slot":31,"values":{"1":{"slot":1,"type":"STRING","value":"main.arrdelaycontrollable1"},"2":{"slot":2,"type":"STRING","value":"arrdelaycontrollable1"}}},"32":{"slot":32,"values":{"1":{"slot":1,"type":"STRING","value":"main.arrdelaycode2"},"2":{"slot":2,"type":"STRING","value":"arrdelaycode2"}}},"33":{"slot":33,"values":{"1":{"slot":1,"type":"STRING","value":"main.arrdelaytime2"},"2":{"slot":2,"type":"STRING","value":"arrdelaytime2"}}},"34":{"slot":34,"values":{"1":{"slot":1,"type":"STRING","value":"main.arrdelaycontrollable2"},"2":{"slot":2,"type":"STRING","value":"arrdelaycontrollable2"}}},"35":{"slot":35,"values":{"1":{"slot":1,"type":"STRING","value":"main.depdelaycode1"},"2":{"slot":2,"type":"STRING","value":"depdelaycode1"}}},"36":{"slot":36,"values":{"1":{"slot":1,"type":"STRING","value":"main.depdelaytime1"},"2":{"slot":2,"type":"STRING","value":"depdelaytime1"}}},"37":{"slot":37,"values":{"1":{"slot":1,"type":"STRING","value":"main.depdelaycontrollable1"},"2":{"slot":2,"type":"STRING","value":"depdelaycontrollable1"}}},"38":{"slot":38,"values":{"1":{"slot":1,"type":"STRING","value":"main.depdelaycode2"},"2":{"slot":2,"type":"STRING","value":"depdelaycode2"}}},"39":{"slot":39,"values":{"1":{"slot":1,"type":"STRING","value":"main.depdelaytime2"},"2":{"slot":2,"type":"STRING","value":"depdelaytime2"}}},"40":{"slot":40,"values":{"1":{"slot":1,"type":"STRING","value":"main.depdelaycontrollable2"},"2":{"slot":2,"type":"STRING","value":"depdelaycontrollable2"}}},"41":{"slot":41,"values":{"1":{"slot":1,"type":"STRING","value":"main.depdelaycode3"},"2":{"slot":2,"type":"STRING","value":"depdelaycode3"}}},"42":{"slot":42,"values":{"1":{"slot":1,"type":"STRING","value":"main.depdelaytime3"},"2":{"slot":2,"type":"STRING","value":"depdelaytime3"}}},"43":{"slot":43,"values":{"1":{"slot":1,"type":"STRING","value":"main.depdelaycontrollable3"},"2":{"slot":2,"type":"STRING","value":"depdelaycontrollable3"}}},"44":{"slot":44,"values":{"1":{"slot":1,"type":"STRING","value":"main.arroveralldelaycalctime"},"2":{"slot":2,"type":"STRING","value":"arroveralldelaycalctime"}}},"45":{"slot":45,"values":{"1":{"slot":1,"type":"STRING","value":"main.arroveralldelaycode"},"2":{"slot":2,"type":"STRING","value":"arroveralldelaycode"}}},"46":{"slot":46,"values":{"1":{"slot":1,"type":"STRING","value":"main.arroveralldelaycontrollable"},"2":{"slot":2,"type":"STRING","value":"arroveralldelaycontrollable"}}},"47":{"slot":47,"values":{"1":{"slot":1,"type":"STRING","value":"main.depoveralldelaycalctime"},"2":{"slot":2,"type":"STRING","value":"depoveralldelaycalctime"}}},"48":{"slot":48,"values":{"1":{"slot":1,"type":"STRING","value":"main.depoveralldelaycode"},"2":{"slot":2,"type":"STRING","value":"depoveralldelaycode"}}},"49":{"slot":49,"values":{"1":{"slot":1,"type":"STRING","value":"main.depoveralldelaycontrollable"},"2":{"slot":2,"type":"STRING","value":"depoveralldelaycontrollable"}}},"50":{"slot":50,"values":{"1":{"slot":1,"type":"STRING","value":"main.pairingid"},"2":{"slot":2,"type":"STRING","value":"pairingid"}}},"51":{"slot":51,"values":{"1":{"slot":1,"type":"STRING","value":"main.expireddatetime"},"2":{"slot":2,"type":"STRING","value":"expireddatetime"}}},"52":{"slot":52,"values":{"1":{"slot":1,"type":"STRING","value":"cncl.fltcancelflg"},"2":{"slot":2,"type":"STRING","value":"fltcancelflg"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"}},"connectors":{"52960":{"id":52960,"sourceID":52956,"targetID":52952},"70560":{"id":70560,"sourceID":52954,"targetID":52956},"52962":{"id":52962,"sourceID":52950,"targetID":52951},"52957":{"id":52957,"sourceID":52953,"targetID":52954},"52958":{"id":52958,"sourceID":52951,"targetID":52954},"52959":{"id":52959,"sourceID":52955,"targetID":52956}},"canUndo":true,"undoCommand":"Set Parameter","undoCreated":1577817466423,"canRedo":false,"redoCommand":"","redoCreated":-1,"notes":{"52945":{"id":52945,"x":151,"y":190,"width":185,"height":108,"text":"Generate Record validity date for each event","colour":"e6e63c"},"52946":{"id":52946,"x":70,"y":323,"width":259,"height":114,"text":"This SQL component need to introduce to handle flight number issue as \"flightnumber = '560Q' \"","colour":"e6e63c"},"52947":{"id":52947,"x":358,"y":419,"width":166,"height":102,"text":"Update Cancel Flight Flag","colour":"e6e63c"},"52948":{"id":52948,"x":809,"y":238,"width":222,"height":163,"text":"Update/insert records into Flight Detail history table","colour":"e6e63c"},"52949":{"id":52949,"x":52,"y":77,"width":316,"height":88,"text":"build the flight detail history record\n\nset the expiredatetimeutc 1 millisecond before the next effectivedatetime\n\nupdated:2019-11-17","colour":"e6e63c"}},"noteConnectors":{},"variables":{},"grids":{}},"info":{"name":"OPS - FlightDetailsHistory_Load","description":"","type":"TRANSFORMATION"}}