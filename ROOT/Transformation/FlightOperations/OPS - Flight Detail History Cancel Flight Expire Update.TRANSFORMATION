{"job":{"components":{"63044":{"id":63044,"inputCardinality":"ZERO","outputCardinality":"MANY","implementationID":1354890871,"x":381,"y":141,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[63047],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"etl.flightcanceliropcodeupdate"}}}},"visible":true},"2":{"slot":2,"name":"Table Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"flightcanceliropcodeupdate"}}}},"visible":true},"3":{"slot":3,"name":"Column Names","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"eventdatetimeutc"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"flightnumber"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"flightdate"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"departurestation"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"arrivalstation"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"iropcode"}}}},"visible":true},"4":{"slot":4,"name":"Trim Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true},"5":{"slot":5,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"etl"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"63045":{"id":63045,"inputCardinality":"ZERO_OR_MANY","outputCardinality":"MANY","implementationID":-1266674941,"x":576,"y":144,"width":32,"height":32,"inputConnectorIDs":[63047],"outputConnectorIDs":[63048],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"identify records to update"}}}},"visible":true},"2":{"slot":2,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SELECT \nflightdetailhistory.flightnumber\n,flightdetailhistory.flightdate\n,flightdetailhistory.departurestation\n,flightdetailhistory.arrivalstation\n,flightdetailhistory.activeflag\n,MAX(flightdetailhistory.effectivedatetimeutc) AS effectivedatetimeutc \n,CAST('9999-12-31' AS date) AS expireddatetimeutc\nFROM public.flightdetailhistory \nINNER JOIN etl.flightcanceliropcodeupdate AS fci\nON fci.flightnumber = flightdetailhistory.flightnumber\nAND fci.flightdate = flightdetailhistory.flightdate\nAND fci.departurestation = flightdetailhistory.departurestation\nAND fci.arrivalstation = flightdetailhistory.arrivalstation\nAND POSITION('X' IN flightdetailhistory.iropcode) > 0\nAND flightdetailhistory.activeflag = 1\nGROUP BY \nflightdetailhistory.flightnumber\n,flightdetailhistory.flightdate\n,flightdetailhistory.departurestation\n,flightdetailhistory.arrivalstation\n,flightdetailhistory.activeflag        "}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"63046":{"id":63046,"inputCardinality":"ONE","outputCardinality":"ZERO","implementationID":-1848704949,"x":768,"y":144,"width":32,"height":32,"inputConnectorIDs":[63048],"outputConnectorIDs":[],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"public.flightdetailhistory"}}}},"visible":true},"2":{"slot":2,"name":"Target Table Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"flightdetailhistory"}}}},"visible":true},"3":{"slot":3,"name":"Fix Data Type Mismatches","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true},"4":{"slot":4,"name":"Column Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"flightnumber"},"2":{"slot":2,"type":"STRING","value":"flightnumber"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"flightdate"},"2":{"slot":2,"type":"STRING","value":"flightdate"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"departurestation"},"2":{"slot":2,"type":"STRING","value":"departurestation"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"arrivalstation"},"2":{"slot":2,"type":"STRING","value":"arrivalstation"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"activeflag"},"2":{"slot":2,"type":"STRING","value":"activeflag"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"effectivedatetimeutc"},"2":{"slot":2,"type":"STRING","value":"effectivedatetimeutc"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"expireddatetimeutc"},"2":{"slot":2,"type":"STRING","value":"expireddatetimeutc"}}}},"visible":true},"5":{"slot":5,"name":"Unique Keys","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"flightnumber"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"flightdate"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"departurestation"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"arrivalstation"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"effectivedatetimeutc"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"activeflag"}}}},"visible":true},"6":{"slot":6,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"public"}}}},"visible":true},"7":{"slot":7,"name":"Update Strategy","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Update/Insert"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"}},"connectors":{"63047":{"id":63047,"sourceID":63044,"targetID":63045},"63048":{"id":63048,"sourceID":63045,"targetID":63046}},"canUndo":false,"undoCommand":"","undoCreated":-1,"canRedo":false,"redoCommand":"","redoCreated":-1,"notes":{"63043":{"id":63043,"x":346,"y":11,"width":450,"height":59,"text":"deactivate any flight records that change their iropcode after the cancelation and there was a return to base event\n\nupdated:2019-12-17","colour":"e6e63c"}},"noteConnectors":{},"variables":{},"grids":{}},"info":{"name":"OPS - Flight Detail History Cancel Flight Expire Update","description":"","type":"TRANSFORMATION"}}