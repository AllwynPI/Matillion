{"job":{"components":{"48063":{"id":48063,"inputCardinality":"ZERO","outputCardinality":"MANY","implementationID":1354890871,"x":256,"y":160,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[48066],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"etl.flightdetailupdate1"}}}},"visible":true},"2":{"slot":2,"name":"Table Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"flightdetailupdate1"}}}},"visible":true},"3":{"slot":3,"name":"Column Names","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"leghashkey"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"sdt"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"sat"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"sta_utc"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"std_utc"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"flightnumber"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"flightdate"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"departurestation"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"arrivalstation"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"changetimeutc"}}}},"visible":true},"4":{"slot":4,"name":"Trim Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true},"5":{"slot":5,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"etl"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"48064":{"id":48064,"inputCardinality":"ONE","outputCardinality":"ZERO","implementationID":-1848704949,"x":752,"y":160,"width":32,"height":32,"inputConnectorIDs":[48067],"outputConnectorIDs":[],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"update etl.flightdetailupdate1"}}}},"visible":true},"2":{"slot":2,"name":"Target Table Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"flightdetailupdate1"}}}},"visible":true},"3":{"slot":3,"name":"Fix Data Type Mismatches","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true},"4":{"slot":4,"name":"Column Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"leghashkey"},"2":{"slot":2,"type":"STRING","value":"leghashkey"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"sdt"},"2":{"slot":2,"type":"STRING","value":"sdt"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"std_utc"},"2":{"slot":2,"type":"STRING","value":"std_utc"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"sat"},"2":{"slot":2,"type":"STRING","value":"sat"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"sta_utc"},"2":{"slot":2,"type":"STRING","value":"sta_utc"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"changetimeutc"},"2":{"slot":2,"type":"STRING","value":"changetimeutc"}}}},"visible":true},"5":{"slot":5,"name":"Unique Keys","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"leghashkey"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"changetimeutc"}}}},"visible":true},"6":{"slot":6,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"etl"}}}},"visible":true},"7":{"slot":7,"name":"Update Strategy","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Update/Insert"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"48065":{"id":48065,"inputCardinality":"ZERO_OR_MANY","outputCardinality":"MANY","implementationID":-1266674941,"x":480,"y":160,"width":32,"height":32,"inputConnectorIDs":[48066],"outputConnectorIDs":[48067],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"update schedule times"}}}},"visible":true},"2":{"slot":2,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SELECT DISTINCT \nCASE WHEN fcr.SDT = '' OR LEFT(fcr.SDT,10) = '1900-01-01' THEN CAST(newfd.sdt AS varchar(23)) ELSE fcr.SDT END  AS SDT\n,CASE WHEN fcr.STD_UTC = '' OR LEFT(fcr.STD_UTC,10) = '1900-01-01'  THEN CAST(newfd.std_utc AS varchar(23))  ELSE fcr.STD_UTC END AS STD_UTC\n,CASE WHEN fcr.SAT = '' OR LEFT(fcr.SAT,10) = '1900-01-01'  THEN CAST(newfd.sat  AS varchar(23)) ELSE fcr.SAT END AS SAT\n,CASE WHEN fcr.STA_UTC = '' OR LEFT(fcr.STA_UTC,10) = '1900-01-01' THEN CAST(newfd.sta_utc  AS varchar(23)) ELSE fcr.STA_UTC END AS STA_UTC\n,fcr.ChangeTimeUTC\n,fcr.leghashkey\n/*\n,fcr.SDT\n,fcr.STD_UTC\n,fcr.SAT\n,fcr.STA_UTC\n*/\nFROM $T{etl.flightdetailupdate1} AS fcr\nINNER JOIN ops.FlightDetails AS newfd\nON fcr.flightnumber = CAST(RIGHT(newfd.fltnum,4) AS int)\nAND CAST(fcr.flightdate AS date) = newfd.fltdate\nAND fcr.departurestation = newfd.DepAirport\nAND fcr.arrivalstation = newfd.ArrAirport\nWHERE (fcr.SDT = '' OR LEFT(fcr.SDT,10) = '1900-01-01' OR  fcr.STD_UTC = '' OR LEFT(fcr.STD_UTC,10) = '1900-01-01' OR fcr.SAT = '' OR LEFT(fcr.SAT,10) = '1900-01-01' OR fcr.STA_UTC = '' OR LEFT(fcr.STA_UTC,10) = '1900-01-01')"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"}},"connectors":{"48066":{"id":48066,"sourceID":48063,"targetID":48065},"48067":{"id":48067,"sourceID":48065,"targetID":48064}},"canUndo":true,"undoCommand":"Rename Job","undoCreated":1574733631346,"canRedo":false,"redoCommand":"","redoCreated":-1,"notes":{"48062":{"id":48062,"x":239,"y":2,"width":355,"height":97,"text":"update the flight schedule times in the stage table if they are not available in the source\n\nuse the ops.flightdetails table for scheduled times\n\nupdate:2019-11-24","colour":"e6e63c"}},"noteConnectors":{},"variables":{},"grids":{}},"info":{"name":"20191212_OPS - Flight Detail Stage Update","description":"","type":"TRANSFORMATION"}}