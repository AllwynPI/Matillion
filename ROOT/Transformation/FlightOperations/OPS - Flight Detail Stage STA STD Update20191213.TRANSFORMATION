{"job":{"components":{"52965":{"id":52965,"inputCardinality":"ZERO","outputCardinality":"MANY","implementationID":1354890871,"x":256,"y":160,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[52968],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"etl.flightdetailupdate1"}}}},"visible":true},"2":{"slot":2,"name":"Table Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"flightdetailupdate1"}}}},"visible":true},"3":{"slot":3,"name":"Column Names","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"leghashkey"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"sdt"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"sat"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"sta_utc"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"std_utc"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"flightnumber"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"flightdate"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"departurestation"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"arrivalstation"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"changetimeutc"}}},"11":{"slot":11,"values":{"1":{"slot":1,"type":"STRING","value":"edt"}}},"12":{"slot":12,"values":{"1":{"slot":1,"type":"STRING","value":"eat"}}},"13":{"slot":13,"values":{"1":{"slot":1,"type":"STRING","value":"eta_utc"}}},"14":{"slot":14,"values":{"1":{"slot":1,"type":"STRING","value":"etd_utc"}}},"15":{"slot":15,"values":{"1":{"slot":1,"type":"STRING","value":"carriercode"}}}},"visible":true},"4":{"slot":4,"name":"Trim Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true},"5":{"slot":5,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"etl"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"52966":{"id":52966,"inputCardinality":"ONE","outputCardinality":"ZERO","implementationID":-1848704949,"x":752,"y":160,"width":32,"height":32,"inputConnectorIDs":[52969],"outputConnectorIDs":[],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"update etl.flightdetailupdate1"}}}},"visible":true},"2":{"slot":2,"name":"Target Table Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"flightdetailupdate1"}}}},"visible":true},"3":{"slot":3,"name":"Fix Data Type Mismatches","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true},"4":{"slot":4,"name":"Column Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"leghashkey"},"2":{"slot":2,"type":"STRING","value":"leghashkey"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"sdt"},"2":{"slot":2,"type":"STRING","value":"sdt"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"std_utc"},"2":{"slot":2,"type":"STRING","value":"std_utc"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"sat"},"2":{"slot":2,"type":"STRING","value":"sat"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"sta_utc"},"2":{"slot":2,"type":"STRING","value":"sta_utc"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"changetimeutc"},"2":{"slot":2,"type":"STRING","value":"changetimeutc"}}}},"visible":true},"5":{"slot":5,"name":"Unique Keys","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"leghashkey"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"changetimeutc"}}}},"visible":true},"6":{"slot":6,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"etl"}}}},"visible":true},"7":{"slot":7,"name":"Update Strategy","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Update/Insert"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"52967":{"id":52967,"inputCardinality":"ZERO_OR_MANY","outputCardinality":"MANY","implementationID":-1266674941,"x":480,"y":160,"width":32,"height":32,"inputConnectorIDs":[52968],"outputConnectorIDs":[52969],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"update schedule times"}}}},"visible":true},"2":{"slot":2,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SELECT DISTINCT \n\n/*schedule time updates */\n--CASE WHEN fcr.SDT = '' OR LEFT(fcr.SDT,10) = '1900-01-01' THEN CAST(newfd.sdt AS varchar(23)) ELSE fcr.SDT END  AS SDT\nCASE WHEN fcr.SDT = '' OR LEFT(fcr.SDT,10) = '1900-01-01' THEN CAST(newfd.std AS varchar(23)) ELSE fcr.SDT END  AS SDT\n--,CASE WHEN fcr.STD_UTC = '' OR LEFT(fcr.STD_UTC,10) = '1900-01-01'  THEN CAST(newfd.std_utc AS varchar(23))  ELSE fcr.STD_UTC END AS STD_UTC\n,CASE WHEN fcr.STD_UTC = '' OR LEFT(fcr.STD_UTC,10) = '1900-01-01'  THEN CAST(newfd.stdutc AS varchar(23))  ELSE fcr.STD_UTC END AS STD_UTC\n--,CASE WHEN fcr.SAT = '' OR LEFT(fcr.SAT,10) = '1900-01-01'  THEN CAST(newfd.sat  AS varchar(23)) ELSE fcr.SAT END AS SAT\n,CASE WHEN fcr.SAT = '' OR LEFT(fcr.SAT,10) = '1900-01-01'  THEN CAST(newfd.sta  AS varchar(23)) ELSE fcr.SAT END AS SAT\n--,CASE WHEN fcr.STA_UTC = '' OR LEFT(fcr.STA_UTC,10) = '1900-01-01' THEN CAST(newfd.sta_utc  AS varchar(23)) ELSE fcr.STA_UTC END AS STA_UTC\n,CASE WHEN fcr.STA_UTC = '' OR LEFT(fcr.STA_UTC,10) = '1900-01-01' THEN CAST(newfd.stautc  AS varchar(23)) ELSE fcr.STA_UTC END AS STA_UTC\n\n,fcr.ChangeTimeUTC\n,fcr.leghashkey\n\nFROM $T{etl.flightdetailupdate1} AS fcr\n/*\nINNER JOIN ops.FlightDetails AS newfd\nON fcr.flightnumber = newfd.flightnumber\nAND CAST(fcr.flightdate AS date) = newfd.flightdate\nAND fcr.departurestation = newfd.departurestation\nAND fcr.arrivalstation = newfd.arrivalstation\nAND newfd.activeflag =1\n*/\nINNER JOIN ods.inventoryleg AS newfd\nON CAST(LTRIM(RTRIM(newfd.flightnumber)) AS int) = fcr.flightnumber\nAND CAST(fcr.flightdate AS date) = newfd.departuredate\nAND newfd.departurestation = fcr.departurestation\nAND newfd.arrivalstation = fcr.arrivalstation\nAND newfd.carriercode = fcr.carriercode\nWHERE \n/* check for missing schedule values */\n(fcr.SDT = '' OR LEFT(fcr.SDT,10) = '1900-01-01' OR  fcr.STD_UTC = '' OR LEFT(fcr.STD_UTC,10) = '1900-01-01' OR fcr.SAT = '' OR LEFT(fcr.SAT,10) = '1900-01-01' OR fcr.STA_UTC = '' OR LEFT(fcr.STA_UTC,10) = '1900-01-01')\n"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"}},"connectors":{"52968":{"id":52968,"sourceID":52965,"targetID":52967},"52969":{"id":52969,"sourceID":52967,"targetID":52966}},"canUndo":true,"undoCommand":"Rename Job","undoCreated":1576178578898,"canRedo":false,"redoCommand":"","redoCreated":-1,"notes":{"52964":{"id":52964,"x":243,"y":-9,"width":460,"height":114,"text":"update the flight schedule times in the stage table if they are not available in the source\n\nuse the ops.flightdetails table for scheduled times\n\nuse the ods.inventoryleg table for scheduled times\n\nupdate:2019-12-06","colour":"e6e63c"}},"noteConnectors":{},"variables":{},"grids":{}},"info":{"name":"OPS - Flight Detail Stage STA STD Update20191213","description":"","type":"TRANSFORMATION"}}