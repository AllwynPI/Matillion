{"job":{"components":{"63037":{"id":63037,"inputCardinality":"ZERO","outputCardinality":"MANY","implementationID":1354890871,"x":381,"y":141,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[63040],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"etl.flightcanceliropcodeupdate"}}}},"visible":true},"2":{"slot":2,"name":"Table Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"flightcanceliropcodeupdate"}}}},"visible":true},"3":{"slot":3,"name":"Column Names","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"eventdatetimeutc"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"flightnumber"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"flightdate"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"departurestation"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"arrivalstation"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"iropcode"}}}},"visible":true},"4":{"slot":4,"name":"Trim Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true},"5":{"slot":5,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"etl"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"63038":{"id":63038,"inputCardinality":"ZERO_OR_MANY","outputCardinality":"MANY","implementationID":-1266674941,"x":576,"y":144,"width":32,"height":32,"inputConnectorIDs":[63040],"outputConnectorIDs":[63041],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"identify records to update"}}}},"visible":true},"2":{"slot":2,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SELECT flightdetailhistory.flightdetailhistoryid, CAST(0 AS int) AS activeflag   \nFROM public.flightdetailhistory \nINNER JOIN $T{etl.flightcanceliropcodeupdate} AS fci\n\t\tON fci.flightnumber = flightdetailhistory.flightnumber\n\t\tAND fci.flightdate = flightdetailhistory.flightdate\n\t\tAND fci.departurestation = flightdetailhistory.departurestation\n\t\tAND fci.arrivalstation = flightdetailhistory.arrivalstation\n\t\t/*active records after the iropcode switches to a non cancel code */\n\t\tAND fci.eventdatetimeutc <= flightdetailhistory.effectivedatetimeutc \n\t\tAND POSITION('X' IN flightdetailhistory.iropcode) = 0\n\t\tAND flightdetailhistory.activeflag = 1"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"63039":{"id":63039,"inputCardinality":"ONE","outputCardinality":"ZERO","implementationID":-1848704949,"x":752,"y":144,"width":32,"height":32,"inputConnectorIDs":[63041],"outputConnectorIDs":[],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"public.flightdetailhistory"}}}},"visible":true},"2":{"slot":2,"name":"Target Table Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"flightdetailhistory"}}}},"visible":true},"3":{"slot":3,"name":"Fix Data Type Mismatches","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true},"4":{"slot":4,"name":"Column Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"flightdetailhistoryid"},"2":{"slot":2,"type":"STRING","value":"flightdetailhistoryid"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"activeflag"},"2":{"slot":2,"type":"STRING","value":"activeflag"}}}},"visible":true},"5":{"slot":5,"name":"Unique Keys","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"flightdetailhistoryid"}}}},"visible":true},"6":{"slot":6,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"public"}}}},"visible":true},"7":{"slot":7,"name":"Update Strategy","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Update/Insert"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"}},"connectors":{"63040":{"id":63040,"sourceID":63037,"targetID":63038},"63041":{"id":63041,"sourceID":63038,"targetID":63039}},"canUndo":false,"undoCommand":"","undoCreated":-1,"canRedo":false,"redoCommand":"","redoCreated":-1,"notes":{"63036":{"id":63036,"x":350,"y":37,"width":450,"height":59,"text":"deactivate any flight records that change their iropcode after the cancelation and there was a return to base event\n\nupdated:2019-12-17","colour":"e6e63c"}},"noteConnectors":{},"variables":{},"grids":{}},"info":{"name":"OPS - Flight Detail History Cancel Flight Active Update","description":"","type":"TRANSFORMATION"}}