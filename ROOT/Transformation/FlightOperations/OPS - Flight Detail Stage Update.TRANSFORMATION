{"job":{"components":{"63002":{"id":63002,"inputCardinality":"ZERO","outputCardinality":"MANY","implementationID":1354890871,"x":256,"y":160,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[63005],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"etl.flightdetailupdate1"}}}},"visible":true},"2":{"slot":2,"name":"Table Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"flightdetailupdate1"}}}},"visible":true},"3":{"slot":3,"name":"Column Names","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"leghashkey"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"sdt"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"sat"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"sta_utc"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"std_utc"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"flightnumber"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"flightdate"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"departurestation"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"arrivalstation"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"changetimeutc"}}},"11":{"slot":11,"values":{"1":{"slot":1,"type":"STRING","value":"edt"}}},"12":{"slot":12,"values":{"1":{"slot":1,"type":"STRING","value":"eat"}}},"13":{"slot":13,"values":{"1":{"slot":1,"type":"STRING","value":"eta_utc"}}},"14":{"slot":14,"values":{"1":{"slot":1,"type":"STRING","value":"etd_utc"}}}},"visible":true},"4":{"slot":4,"name":"Trim Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true},"5":{"slot":5,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"etl"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"63003":{"id":63003,"inputCardinality":"ONE","outputCardinality":"ZERO","implementationID":-1848704949,"x":752,"y":160,"width":32,"height":32,"inputConnectorIDs":[63006],"outputConnectorIDs":[],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"update etl.flightdetailupdate1"}}}},"visible":true},"2":{"slot":2,"name":"Target Table Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"flightdetailupdate1"}}}},"visible":true},"3":{"slot":3,"name":"Fix Data Type Mismatches","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true},"4":{"slot":4,"name":"Column Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"leghashkey"},"2":{"slot":2,"type":"STRING","value":"leghashkey"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"sdt"},"2":{"slot":2,"type":"STRING","value":"sdt"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"std_utc"},"2":{"slot":2,"type":"STRING","value":"std_utc"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"sat"},"2":{"slot":2,"type":"STRING","value":"sat"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"sta_utc"},"2":{"slot":2,"type":"STRING","value":"sta_utc"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"changetimeutc"},"2":{"slot":2,"type":"STRING","value":"changetimeutc"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"edt"},"2":{"slot":2,"type":"STRING","value":"edt"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"etd_utc"},"2":{"slot":2,"type":"STRING","value":"etd_utc"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"eat"},"2":{"slot":2,"type":"STRING","value":"eat"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"eta_utc"},"2":{"slot":2,"type":"STRING","value":"eta_utc"}}}},"visible":true},"5":{"slot":5,"name":"Unique Keys","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"leghashkey"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"changetimeutc"}}}},"visible":true},"6":{"slot":6,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"etl"}}}},"visible":true},"7":{"slot":7,"name":"Update Strategy","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Update/Insert"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"63004":{"id":63004,"inputCardinality":"ZERO_OR_MANY","outputCardinality":"MANY","implementationID":-1266674941,"x":480,"y":160,"width":32,"height":32,"inputConnectorIDs":[63005],"outputConnectorIDs":[63006],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"update schedule times"}}}},"visible":true},"2":{"slot":2,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SELECT DISTINCT \n\n/*schedule time updates */\nCASE WHEN fcr.SDT = '' OR LEFT(fcr.SDT,10) = '1900-01-01' THEN CAST(newfd.sdt AS varchar(23)) ELSE fcr.SDT END  AS SDT\n,CASE WHEN fcr.STD_UTC = '' OR LEFT(fcr.STD_UTC,10) = '1900-01-01'  THEN CAST(newfd.std_utc AS varchar(23))  ELSE fcr.STD_UTC END AS STD_UTC\n,CASE WHEN fcr.SAT = '' OR LEFT(fcr.SAT,10) = '1900-01-01'  THEN CAST(newfd.sat  AS varchar(23)) ELSE fcr.SAT END AS SAT\n,CASE WHEN fcr.STA_UTC = '' OR LEFT(fcr.STA_UTC,10) = '1900-01-01' THEN CAST(newfd.sta_utc  AS varchar(23)) ELSE fcr.STA_UTC END AS STA_UTC\n\n/*estiamte time updates */\n,CASE WHEN fcr.EDT = '' OR LEFT(fcr.EDT,10) = '1900-01-01' THEN CAST(newfd.EDT AS varchar(23)) ELSE CAST(fcr.EDT AS varchar(23)) END  AS EDT\n,CASE WHEN fcr.ETD_UTC = '' OR LEFT(fcr.ETD_UTC,10) = '1900-01-01'  THEN CAST(newfd.ETD_UTC AS varchar(23))  ELSE CAST(fcr.ETD_UTC  AS varchar(23)) END AS ETD_UTC\n,CASE WHEN fcr.EAT = '' OR LEFT(fcr.EAT,10) = '1900-01-01'  THEN CAST(newfd.EAT AS varchar(23)) ELSE CAST(fcr.EAT AS varchar(23)) END AS EAT\n,CASE WHEN fcr.ETA_UTC = '' OR LEFT(fcr.ETA_UTC,10) = '1900-01-01' THEN CAST(newfd.ETA_UTC  AS varchar(23)) ELSE CAST(fcr.ETA_UTC AS varchar(23)) END AS ETA_UTC\n\n,fcr.ChangeTimeUTC\n,fcr.leghashkey\n\nFROM $T{etl.flightdetailupdate1} AS fcr\nINNER JOIN ops.FlightDetails AS newfd\nON fcr.flightnumber = CAST(RIGHT(newfd.fltnum,4) AS int)\nAND CAST(fcr.flightdate AS date) = newfd.fltdate\nAND fcr.departurestation = newfd.DepAirport\nAND fcr.arrivalstation = newfd.ArrAirport\nWHERE \n/* check for missing schedule values */\n(fcr.SDT = '' OR LEFT(fcr.SDT,10) = '1900-01-01' OR  fcr.STD_UTC = '' OR LEFT(fcr.STD_UTC,10) = '1900-01-01' OR fcr.SAT = '' OR LEFT(fcr.SAT,10) = '1900-01-01' OR fcr.STA_UTC = '' OR LEFT(fcr.STA_UTC,10) = '1900-01-01')\nOR \n/* check for missing estimate values */\n(fcr.EDT = '' OR LEFT(fcr.EDT,10) = '1900-01-01' OR  fcr.ETD_UTC = '' OR LEFT(fcr.ETD_UTC,10) = '1900-01-01' OR fcr.EAT = '' OR LEFT(fcr.EAT,10) = '1900-01-01' OR fcr.ETA_UTC = '' OR LEFT(fcr.ETA_UTC,10) = '1900-01-01')\n"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"}},"connectors":{"63005":{"id":63005,"sourceID":63002,"targetID":63004},"63006":{"id":63006,"sourceID":63004,"targetID":63003}},"canUndo":false,"undoCommand":"","undoCreated":-1,"canRedo":false,"redoCommand":"","redoCreated":-1,"notes":{"63001":{"id":63001,"x":239,"y":2,"width":460,"height":114,"text":"update the flight schedule times in the stage table if they are not available in the source\n\nuse the ops.flightdetails table for scheduled times\n\nuse the ops.flightdetails table for estimate times\n\nupdate:2019-11-27","colour":"e6e63c"}},"noteConnectors":{},"variables":{},"grids":{}},"info":{"name":"OPS - Flight Detail Stage Update","description":"","type":"TRANSFORMATION"}}