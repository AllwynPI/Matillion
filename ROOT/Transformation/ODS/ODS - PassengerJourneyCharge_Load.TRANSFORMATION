{"job":{"components":{"27476":{"id":27476,"inputCardinality":"ZERO","outputCardinality":"MANY","implementationID":1354890871,"x":-736,"y":121,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[27480],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"etl_passengerjourneycharge"}}}},"visible":true},"2":{"slot":2,"name":"Table Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"passengerjourneycharge"}}}},"visible":true},"3":{"slot":3,"name":"Column Names","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"passengerid"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"segmentid"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"createduserid"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"createdutc"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"currencycode"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"createdest"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"chargenumber"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"chargetype"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"chargecode"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"ticketcode"}}},"11":{"slot":11,"values":{"1":{"slot":1,"type":"STRING","value":"chargeamount"}}},"12":{"slot":12,"values":{"1":{"slot":1,"type":"STRING","value":"chargedetail"}}},"13":{"slot":13,"values":{"1":{"slot":1,"type":"STRING","value":"foreigncurrencycode"}}},"14":{"slot":14,"values":{"1":{"slot":1,"type":"STRING","value":"foreignamount"}}},"15":{"slot":15,"values":{"1":{"slot":1,"type":"STRING","value":"chargeamountcad"}}},"16":{"slot":16,"values":{"1":{"slot":1,"type":"STRING","value":"exchangerate"}}}},"visible":true},"4":{"slot":4,"name":"Trim Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true},"5":{"slot":5,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"etl"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"27477":{"id":27477,"inputCardinality":"ONE","outputCardinality":"ZERO","implementationID":-1848704949,"x":-259,"y":128,"width":32,"height":32,"inputConnectorIDs":[27479],"outputConnectorIDs":[],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ods.passengerjourneycharge"}}}},"visible":true},"2":{"slot":2,"name":"Target Table Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"passengerjourneycharge"}}}},"visible":true},"3":{"slot":3,"name":"Fix Data Type Mismatches","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"4":{"slot":4,"name":"Column Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"passengerid"},"2":{"slot":2,"type":"STRING","value":"passengerid"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"segmentid"},"2":{"slot":2,"type":"STRING","value":"segmentid"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"chargenumber"},"2":{"slot":2,"type":"STRING","value":"chargenumber"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"createduserid"},"2":{"slot":2,"type":"STRING","value":"createduserid"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"createdutc"},"2":{"slot":2,"type":"STRING","value":"createdutc"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"chargetype"},"2":{"slot":2,"type":"STRING","value":"chargetype"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"chargecode"},"2":{"slot":2,"type":"STRING","value":"chargecode"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"ticketcode"},"2":{"slot":2,"type":"STRING","value":"ticketcode"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"currencycode"},"2":{"slot":2,"type":"STRING","value":"currencycode"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"chargeamount"},"2":{"slot":2,"type":"STRING","value":"chargeamount"}}},"11":{"slot":11,"values":{"1":{"slot":1,"type":"STRING","value":"chargedetail"},"2":{"slot":2,"type":"STRING","value":"chargedetail"}}},"12":{"slot":12,"values":{"1":{"slot":1,"type":"STRING","value":"foreigncurrencycode"},"2":{"slot":2,"type":"STRING","value":"foreigncurrencycode"}}},"13":{"slot":13,"values":{"1":{"slot":1,"type":"STRING","value":"foreignamount"},"2":{"slot":2,"type":"STRING","value":"foreignamount"}}},"14":{"slot":14,"values":{"1":{"slot":1,"type":"STRING","value":"createdest"},"2":{"slot":2,"type":"STRING","value":"createdest"}}},"15":{"slot":15,"values":{"1":{"slot":1,"type":"STRING","value":"exchangerate"},"2":{"slot":2,"type":"STRING","value":"exchangerate"}}},"16":{"slot":16,"values":{"1":{"slot":1,"type":"STRING","value":"createdutcdateid"},"2":{"slot":2,"type":"STRING","value":"createdutcdateid"}}},"17":{"slot":17,"values":{"1":{"slot":1,"type":"STRING","value":"createdutctimeid"},"2":{"slot":2,"type":"STRING","value":"createdutctimeid"}}},"18":{"slot":18,"values":{"1":{"slot":1,"type":"STRING","value":"originalchargeamount"},"2":{"slot":2,"type":"STRING","value":"originalchargeamount"}}}},"visible":true},"5":{"slot":5,"name":"Unique Keys","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"passengerid"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"segmentid"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"chargenumber"}}}},"visible":true},"6":{"slot":6,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ods"}}}},"visible":true},"7":{"slot":7,"name":"Update Strategy","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Update/Insert"}}}},"visible":true}},"exportMappings":{"1":{"slot":1,"fromId":null,"fromName":"Message","mapTo":"Errormessage"}},"expectedFailure":null,"activationStatus":"ENABLED"},"27478":{"id":27478,"inputCardinality":"ZERO_OR_MANY","outputCardinality":"MANY","implementationID":-1266674941,"x":-468,"y":130,"width":32,"height":32,"inputConnectorIDs":[27480],"outputConnectorIDs":[27479],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"add_datetimeid_excludeskyledger updates"}}}},"visible":true},"2":{"slot":2,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SELECT \nnpjc.*\n,public.f_dateid(CAST(createdutc as timestamp)) AS createdutcdateid\n, public.f_timeid(CAST(createdutc as timestamp))  AS createdutctimeid\n,chargeamount AS originalchargeamount\nFROM $T{etl_passengerjourneycharge} AS npjc\nWHERE NOT EXISTS (SELECT 1 FROM ods.passengerjourneycharge AS pjc\n               \tWHERE npjc.passengerid = pjc.passengerid\n                AND npjc.segmentid = pjc.segmentid\n                AND npjc.chargenumber = pjc.chargenumber\n                AND pjc.skyledgerdatetime > CAST('2018-10-01' AS date)  \n                AND pjc.skyledgerkey > 0)"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"}},"connectors":{"27479":{"id":27479,"sourceID":27478,"targetID":27477},"27480":{"id":27480,"sourceID":27476,"targetID":27478}},"canUndo":true,"undoCommand":"Set Parameter","undoCreated":1569009978127,"canRedo":false,"redoCommand":"","redoCreated":-1,"notes":{"27474":{"id":27474,"x":-1034,"y":-60,"width":350,"height":144,"text":"Load new and updated records\n\nAdditional columns added for skyledger updates\n\ndate and time ids\nskyledger tracking columns\noriginal chargeamounts\n\nupdated: 2018-10-11","colour":"e6e63c"},"27475":{"id":27475,"x":-605,"y":2,"width":463,"height":213,"text":"**add logic to not update charge amount after skyledger process has updated it**","colour":"e6e63c"}},"noteConnectors":{},"variables":{},"grids":{}},"info":{"name":"ODS - PassengerJourneyCharge_Load","description":null,"type":"TRANSFORMATION"}}