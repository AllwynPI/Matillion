{"job":{"components":{"3481":{"id":3481,"inputCardinality":"ZERO","outputCardinality":"MANY","implementationID":1354890871,"x":32,"y":160,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[3592],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"etl.scp"}}}},"visible":true},"2":{"slot":2,"name":"Table Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"smscampaignpreference"}}}},"visible":true},"3":{"slot":3,"name":"Column Names","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"smscampaignpreferenceid"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"smscampaignid"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"customerprofileid"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"consent"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"campaigntypename"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"requeststartdatetimeutc"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"notificationlist"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"activeflag"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"createdatetimeutc"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"modifieddatetimeutc"}}},"11":{"slot":11,"values":{"1":{"slot":1,"type":"STRING","value":"viporternumber"}}}},"visible":true},"4":{"slot":4,"name":"Trim Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true},"5":{"slot":5,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"etl"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"3485":{"id":3485,"inputCardinality":"ZERO_OR_MANY","outputCardinality":"MANY","implementationID":-1266674941,"x":352,"y":160,"width":32,"height":32,"inputConnectorIDs":[3592],"outputConnectorIDs":[3701],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"rename columns"}}}},"visible":true},"2":{"slot":2,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SELECT \n\"SMSCampaignPreferenceID\" as \"scpid\",\n\"SMSCampaignID\" ,\n\"CustomerProfileID\" ,\n\"Consent\" ,\n\"CampaignTypeName\" , \n\"RequestStartDateTimeUTC\" ,\n\"NotificationList\" ,\n\"ActiveFlag\" ,\n\"CreateDatetimeUTC\"  ,\n\"ModifiedDatetimeUTC\" as \"scpmodifieddatetimeutc\" , \t\n\"VIPorterNumber\" \nFROM $T{etl.scp}\n--FROM smscampaignpreference"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"3691":{"id":3691,"inputCardinality":"ZERO","outputCardinality":"MANY","implementationID":1354890871,"x":344,"y":300,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[3704],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"public.scp"}}}},"visible":true},"2":{"slot":2,"name":"Table Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"smscampaignpreference"}}}},"visible":true},"3":{"slot":3,"name":"Column Names","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"smscampaignpreferenceid"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"viporternumber"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"smscampaignid"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"customerprofileid"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"consent"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"campaigntypename"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"requestdatetimeutc"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"notificationlist"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"activeflag"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"scpid"}}},"11":{"slot":11,"values":{"1":{"slot":1,"type":"STRING","value":"scpcreatedatetimeutc"}}},"12":{"slot":12,"values":{"1":{"slot":1,"type":"STRING","value":"scpmodifieddatetimeutc"}}},"13":{"slot":13,"values":{"1":{"slot":1,"type":"STRING","value":"createdttm"}}}},"visible":true},"4":{"slot":4,"name":"Trim Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true},"5":{"slot":5,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"public"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"3697":{"id":3697,"inputCardinality":"TWO","outputCardinality":"MANY","implementationID":-359894709,"x":624,"y":224,"width":32,"height":32,"inputConnectorIDs":[3701,3704],"outputConnectorIDs":[3851],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"cdc"}}}},"visible":true},"2":{"slot":2,"name":"Master Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"public.scp"}}}},"visible":true},"3":{"slot":3,"name":"Match Keys","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"scpid"}}}},"visible":true},"4":{"slot":4,"name":"Compare Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"smscampaignid"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"customerprofileid"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"consent"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"campaigntypename"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"notificationlist"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"activeflag"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"viporternumber"}}}},"visible":true},"5":{"slot":5,"name":"Output Column Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"master_scpmodifieddatetimeutc"},"2":{"slot":2,"type":"STRING","value":"modifieddatetimeutc_old"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"compare_scpmodifieddatetimeutc"},"2":{"slot":2,"type":"STRING","value":"modifieddatetimeutc"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"compare_smscampaignid"},"2":{"slot":2,"type":"STRING","value":"smscampaignid"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"compare_customerprofileid"},"2":{"slot":2,"type":"STRING","value":"customerprofileid"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"compare_consent"},"2":{"slot":2,"type":"STRING","value":"consent"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"compare_campaigntypename"},"2":{"slot":2,"type":"STRING","value":"campaigntypename"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"compare_requeststartdatetimeutc"},"2":{"slot":2,"type":"STRING","value":"requeststartdatetimeutc"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"compare_notificationlist"},"2":{"slot":2,"type":"STRING","value":"notificationlist"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"compare_activeflag"},"2":{"slot":2,"type":"STRING","value":"activeflag"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"compare_createdatetimeutc"},"2":{"slot":2,"type":"STRING","value":"createdatetimeutc"}}},"11":{"slot":11,"values":{"1":{"slot":1,"type":"STRING","value":"compare_viporternumber"},"2":{"slot":2,"type":"STRING","value":"viporternumber"}}}},"visible":true},"6":{"slot":6,"name":"Indicator Column","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Indicator"}}}},"visible":true},"7":{"slot":7,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"3849":{"id":3849,"inputCardinality":"ZERO_OR_MANY","outputCardinality":"MANY","implementationID":-1266674941,"x":816,"y":224,"width":32,"height":32,"inputConnectorIDs":[3851],"outputConnectorIDs":[3870],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"pull changed or new records"}}}},"visible":true},"2":{"slot":2,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SELECT * FROM $T{cdc} WHERE indicator IN ('C', 'N')"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"3868":{"id":3868,"inputCardinality":"ONE","outputCardinality":"ZERO","implementationID":211954775,"x":1040,"y":224,"width":32,"height":32,"inputConnectorIDs":[3870],"outputConnectorIDs":[],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"stage.smscampaignpreference"}}}},"visible":true},"2":{"slot":2,"name":"Target Table Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"smscampaignpreference"}}}},"visible":true},"3":{"slot":3,"name":"Fix Data Type Mismatches","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true},"4":{"slot":4,"name":"Column Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"viporternumber"},"2":{"slot":2,"type":"STRING","value":"viporternumber"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"smscampaignid"},"2":{"slot":2,"type":"STRING","value":"smscampaignid"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"customerprofileid"},"2":{"slot":2,"type":"STRING","value":"customerprofileid"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"consent"},"2":{"slot":2,"type":"STRING","value":"consent"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"campaigntypename"},"2":{"slot":2,"type":"STRING","value":"campaigntypename"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"requeststartdatetimeutc"},"2":{"slot":2,"type":"STRING","value":"requestdatetimeutc"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"notificationlist"},"2":{"slot":2,"type":"STRING","value":"notificationlist"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"activeflag"},"2":{"slot":2,"type":"STRING","value":"activeflag"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"scpid"},"2":{"slot":2,"type":"STRING","value":"scpid"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"createdatetimeutc"},"2":{"slot":2,"type":"STRING","value":"scpcreatedatetimeutc"}}},"11":{"slot":11,"values":{"1":{"slot":1,"type":"STRING","value":"modifieddatetimeutc"},"2":{"slot":2,"type":"STRING","value":"scpmodifieddatetimeutc"}}},"12":{"slot":12,"values":{"1":{"slot":1,"type":"STRING","value":"modifieddatetimeutc_old"},"2":{"slot":2,"type":"STRING","value":"scpmodifieddatetimeutc_old"}}},"13":{"slot":13,"values":{"1":{"slot":1,"type":"STRING","value":"indicator"},"2":{"slot":2,"type":"STRING","value":"indicator"}}}},"visible":true},"5":{"slot":5,"name":"Truncate","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Truncate"}}}},"visible":true},"6":{"slot":6,"name":"Automatic Compression","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true},"7":{"slot":7,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"stage"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"}},"connectors":{"3701":{"id":3701,"sourceID":3485,"targetID":3697},"3592":{"id":3592,"sourceID":3481,"targetID":3485},"3704":{"id":3704,"sourceID":3691,"targetID":3697},"3851":{"id":3851,"sourceID":3697,"targetID":3849},"3870":{"id":3870,"sourceID":3849,"targetID":3868}},"canUndo":true,"undoCommand":"Set Parameter","undoCreated":1568320942510,"canRedo":false,"redoCommand":"","redoCreated":-1,"notes":{"3671":{"id":3671,"x":-75,"y":-63,"width":720,"height":91,"text":"Load the changes into **campaign preferences staging** include the indicator field (N means new record and C means changed record)\n\nsmscampaignid and scpmodifieddatetimeutc are used to determine the updated SMS campaign preference. ","colour":"e6e63c"},"8547":{"id":8547,"x":-46,"y":103,"width":146,"height":106,"text":"Table input with new records","colour":"e6e63c"},"8551":{"id":8551,"x":255,"y":239,"width":204,"height":114,"text":"Table input with old record/ existing records in public schema","colour":"e6e63c"},"15230":{"id":15230,"x":252,"y":99,"width":205,"height":122,"text":"Rename SMSCampaignPreferenceID  and ModifiedDatetimeUTC","colour":"e6e63c"}},"noteConnectors":{},"variables":{},"grids":{}},"info":{"name":"SMS - SMSCampaignPreference_load","description":null,"type":"TRANSFORMATION"}}