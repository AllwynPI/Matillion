{"job":{"components":{"64957":{"id":64957,"inputCardinality":"ZERO","outputCardinality":"MANY","implementationID":1354890871,"x":304,"y":304,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[64960],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"pnrpassengerevent"}}}},"visible":true},"2":{"slot":2,"name":"Table Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"pnrpassengerevent"}}}},"visible":true},"3":{"slot":3,"name":"Column Names","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"eventdatetimeutc"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"pnr"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"passengerid"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"segmentid"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"inventorylegid"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"boardingsequence"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"createduserid"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"modifieduserid"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"journeynumber"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"segmentnumber"}}},"11":{"slot":11,"values":{"1":{"slot":1,"type":"STRING","value":"legnumber"}}},"12":{"slot":12,"values":{"1":{"slot":1,"type":"STRING","value":"liftstatus"}}},"13":{"slot":13,"values":{"1":{"slot":1,"type":"STRING","value":"prev_liftstatus"}}},"14":{"slot":14,"values":{"1":{"slot":1,"type":"STRING","value":"unitdesignator"}}},"15":{"slot":15,"values":{"1":{"slot":1,"type":"STRING","value":"prev_unitdesignator"}}},"16":{"slot":16,"values":{"1":{"slot":1,"type":"STRING","value":"flightnumber"}}},"17":{"slot":17,"values":{"1":{"slot":1,"type":"STRING","value":"departuredate"}}},"18":{"slot":18,"values":{"1":{"slot":1,"type":"STRING","value":"stdutc"}}},"19":{"slot":19,"values":{"1":{"slot":1,"type":"STRING","value":"std"}}},"20":{"slot":20,"values":{"1":{"slot":1,"type":"STRING","value":"departurestation"}}},"21":{"slot":21,"values":{"1":{"slot":1,"type":"STRING","value":"arrivalstation"}}},"22":{"slot":22,"values":{"1":{"slot":1,"type":"STRING","value":"bookingdatetimeutc"}}},"23":{"slot":23,"values":{"1":{"slot":1,"type":"STRING","value":"bookingid"}}},"24":{"slot":24,"values":{"1":{"slot":1,"type":"STRING","value":"segmentminstartdatetimeutc"}}},"25":{"slot":25,"values":{"1":{"slot":1,"type":"STRING","value":"segmentmaxstartdatetimeutc"}}},"26":{"slot":26,"values":{"1":{"slot":1,"type":"STRING","value":"segmentminenddatetimeutc"}}},"27":{"slot":27,"values":{"1":{"slot":1,"type":"STRING","value":"segmentmaxenddatetimeutc"}}},"28":{"slot":28,"values":{"1":{"slot":1,"type":"STRING","value":"legminstartdatetimeutc"}}},"29":{"slot":29,"values":{"1":{"slot":1,"type":"STRING","value":"legmaxstartdatetimeutc"}}},"30":{"slot":30,"values":{"1":{"slot":1,"type":"STRING","value":"legmaxenddatetimeutc"}}},"31":{"slot":31,"values":{"1":{"slot":1,"type":"STRING","value":"segmentchangereasoncode"}}},"32":{"slot":32,"values":{"1":{"slot":1,"type":"STRING","value":"bookingdateflag"}}},"33":{"slot":33,"values":{"1":{"slot":1,"type":"STRING","value":"seatassignedflag"}}},"34":{"slot":34,"values":{"1":{"slot":1,"type":"STRING","value":"checkinflag"}}},"35":{"slot":35,"values":{"1":{"slot":1,"type":"STRING","value":"boardedflag"}}},"36":{"slot":36,"values":{"1":{"slot":1,"type":"STRING","value":"noshowflag"}}},"37":{"slot":37,"values":{"1":{"slot":1,"type":"STRING","value":"unboardedflag"}}},"38":{"slot":38,"values":{"1":{"slot":1,"type":"STRING","value":"checkoutflag"}}},"39":{"slot":39,"values":{"1":{"slot":1,"type":"STRING","value":"segmentaddedflag"}}},"40":{"slot":40,"values":{"1":{"slot":1,"type":"STRING","value":"segmentdroppedflag"}}},"41":{"slot":41,"values":{"1":{"slot":1,"type":"STRING","value":"segmentchangeflag"}}},"42":{"slot":42,"values":{"1":{"slot":1,"type":"STRING","value":"legaddedflag"}}},"43":{"slot":43,"values":{"1":{"slot":1,"type":"STRING","value":"legaddedtempflag"}}},"44":{"slot":44,"values":{"1":{"slot":1,"type":"STRING","value":"legdroppedflag"}}},"45":{"slot":45,"values":{"1":{"slot":1,"type":"STRING","value":"flightflownflag"}}},"46":{"slot":46,"values":{"1":{"slot":1,"type":"STRING","value":"createdttm"}}},"47":{"slot":47,"values":{"1":{"slot":1,"type":"STRING","value":"pjlvid"}}},"48":{"slot":48,"values":{"1":{"slot":1,"type":"STRING","value":"eventtype"}}},"49":{"slot":49,"values":{"1":{"slot":1,"type":"STRING","value":"seatunassignedflag"}}},"50":{"slot":50,"values":{"1":{"slot":1,"type":"STRING","value":"carriercode"}}},"51":{"slot":51,"values":{"1":{"slot":1,"type":"STRING","value":"bookingparentdateflag"}}},"52":{"slot":52,"values":{"1":{"slot":1,"type":"STRING","value":"seatchangedflag"}}},"53":{"slot":53,"values":{"1":{"slot":1,"type":"STRING","value":"stautc"}}},"54":{"slot":54,"values":{"1":{"slot":1,"type":"STRING","value":"sta"}}},"55":{"slot":55,"values":{"1":{"slot":1,"type":"STRING","value":"eventsourceid"}}},"56":{"slot":56,"values":{"1":{"slot":1,"type":"STRING","value":"productclasscode"}}},"57":{"slot":57,"values":{"1":{"slot":1,"type":"STRING","value":"etautc"}}},"58":{"slot":58,"values":{"1":{"slot":1,"type":"STRING","value":"eta"}}},"59":{"slot":59,"values":{"1":{"slot":1,"type":"STRING","value":"parentpnrflag"}}},"60":{"slot":60,"values":{"1":{"slot":1,"type":"STRING","value":"etd"}}},"61":{"slot":61,"values":{"1":{"slot":1,"type":"STRING","value":"etdutc"}}},"62":{"slot":62,"values":{"1":{"slot":1,"type":"STRING","value":"bookingstatus"}}},"63":{"slot":63,"values":{"1":{"slot":1,"type":"STRING","value":"prev_bookingstatus"}}},"64":{"slot":64,"values":{"1":{"slot":1,"type":"STRING","value":"standbyflag"}}},"65":{"slot":65,"values":{"1":{"slot":1,"type":"STRING","value":"pnrpassengereventid"}}}},"visible":true},"4":{"slot":4,"name":"Trim Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true},"5":{"slot":5,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"stage"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"64958":{"id":64958,"inputCardinality":"ZERO_OR_MANY","outputCardinality":"MANY","implementationID":-1266674941,"x":512,"y":304,"width":32,"height":32,"inputConnectorIDs":[64960],"outputConnectorIDs":[64961],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"update_productclasscode"}}}},"visible":true},"2":{"slot":2,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SELECT \npnr,\npassengerid,\neventtype,\neventdatetimeutc,\n--departurestation,\n--arrivalstation,\n--departuredate,\njourneynumber,\n\n(SELECT TOP 1 pjsv.productclasscode\n\t\tFROM ods.passengerjourneysegmentversion AS pjsv\n\t\twhere  pjsv.passengerid = pfe.passengerid\n        AND pjsv.journeynumber= pfe.journeynumber\n\t\tAND ISNULL(pjsv.productclasscode,'') > ''\n\t\tORDER BY pjsv.versionstartutc DESC )  AS productcodeclass\n        \nFROM stage.pnrpassengerevent AS pfe\nWHERE eventtype is NOT NULL \nAND EXISTS (SELECT 1 FROM stage.pnrpassengereventlist AS ppel\nWHERE pfe.pnr = ppel.pnr)\n"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"64959":{"id":64959,"inputCardinality":"ONE","outputCardinality":"ZERO","implementationID":-1848704949,"x":752,"y":304,"width":32,"height":32,"inputConnectorIDs":[64961],"outputConnectorIDs":[],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"stage.pnrpassengereventcalc"}}}},"visible":true},"2":{"slot":2,"name":"Target Table Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"pnrpassengereventcalc"}}}},"visible":true},"3":{"slot":3,"name":"Fix Data Type Mismatches","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true},"4":{"slot":4,"name":"Column Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"pnr"},"2":{"slot":2,"type":"STRING","value":"pnr"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"passengerid"},"2":{"slot":2,"type":"STRING","value":"passengerid"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"eventtype"},"2":{"slot":2,"type":"STRING","value":"eventtype"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"eventdatetimeutc"},"2":{"slot":2,"type":"STRING","value":"eventdatetimeutc"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"productcodeclass"},"2":{"slot":2,"type":"STRING","value":"productclasscode"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"journeynumber"},"2":{"slot":2,"type":"STRING","value":"journeynumber"}}}},"visible":true},"5":{"slot":5,"name":"Unique Keys","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"eventtype"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"eventdatetimeutc"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"passengerid"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"pnr"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"journeynumber"}}}},"visible":true},"6":{"slot":6,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"stage"}}}},"visible":true},"7":{"slot":7,"name":"Update Strategy","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Update/Insert"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"}},"connectors":{"64960":{"id":64960,"sourceID":64957,"targetID":64958},"64961":{"id":64961,"sourceID":64958,"targetID":64959}},"canUndo":false,"undoCommand":"","undoCreated":-1,"canRedo":false,"redoCommand":"","redoCreated":-1,"notes":{"64956":{"id":64956,"x":280,"y":179,"width":535,"height":73,"text":"Update the productcodeclass when the value is not provided in the pnrpassenger event table\n\n\nupdated:2019-12-18","colour":"e6e63c"}},"noteConnectors":{},"variables":{},"grids":{}},"info":{"name":"PNR - ProductCodeClass_Update","description":"","type":"TRANSFORMATION"}}