{"job":{"components":{"64912":{"id":64912,"inputCardinality":"ZERO","outputCardinality":"MANY","implementationID":1354890871,"x":256,"y":256,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[64918],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"pnrpassengereventcalc"}}}},"visible":true},"2":{"slot":2,"name":"Table Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"pnrpassengereventcalc"}}}},"visible":true},"3":{"slot":3,"name":"Column Names","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"eventtype"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"eventdatetimeutc"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"eventname"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"eventuser"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"eventlocation"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"eventreason"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"pnr"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"passengerid"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"segmentstautc"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"segmentsta"}}},"11":{"slot":11,"values":{"1":{"slot":1,"type":"STRING","value":"journeystautc"}}},"12":{"slot":12,"values":{"1":{"slot":1,"type":"STRING","value":"journeysta"}}},"13":{"slot":13,"values":{"1":{"slot":1,"type":"STRING","value":"segmentid"}}},"14":{"slot":14,"values":{"1":{"slot":1,"type":"STRING","value":"inventorylegid"}}},"15":{"slot":15,"values":{"1":{"slot":1,"type":"STRING","value":"boardingsequence"}}},"16":{"slot":16,"values":{"1":{"slot":1,"type":"STRING","value":"createduserid"}}},"17":{"slot":17,"values":{"1":{"slot":1,"type":"STRING","value":"modifieduserid"}}},"18":{"slot":18,"values":{"1":{"slot":1,"type":"STRING","value":"journeynumber"}}},"19":{"slot":19,"values":{"1":{"slot":1,"type":"STRING","value":"segmentnumber"}}},"20":{"slot":20,"values":{"1":{"slot":1,"type":"STRING","value":"legnumber"}}},"21":{"slot":21,"values":{"1":{"slot":1,"type":"STRING","value":"liftstatus"}}},"22":{"slot":22,"values":{"1":{"slot":1,"type":"STRING","value":"prev_liftstatus"}}},"23":{"slot":23,"values":{"1":{"slot":1,"type":"STRING","value":"unitdesignator"}}},"24":{"slot":24,"values":{"1":{"slot":1,"type":"STRING","value":"prev_unitdesignator"}}},"25":{"slot":25,"values":{"1":{"slot":1,"type":"STRING","value":"flightnumber"}}},"26":{"slot":26,"values":{"1":{"slot":1,"type":"STRING","value":"departuredate"}}},"27":{"slot":27,"values":{"1":{"slot":1,"type":"STRING","value":"stdutc"}}},"28":{"slot":28,"values":{"1":{"slot":1,"type":"STRING","value":"std"}}},"29":{"slot":29,"values":{"1":{"slot":1,"type":"STRING","value":"departurestation"}}},"30":{"slot":30,"values":{"1":{"slot":1,"type":"STRING","value":"arrivalstation"}}},"31":{"slot":31,"values":{"1":{"slot":1,"type":"STRING","value":"bookingdatetimeutc"}}},"32":{"slot":32,"values":{"1":{"slot":1,"type":"STRING","value":"bookingid"}}},"33":{"slot":33,"values":{"1":{"slot":1,"type":"STRING","value":"segmentminstartdatetimeutc"}}},"34":{"slot":34,"values":{"1":{"slot":1,"type":"STRING","value":"segmentmaxstartdatetimeutc"}}},"35":{"slot":35,"values":{"1":{"slot":1,"type":"STRING","value":"segmentminenddatetimeutc"}}},"36":{"slot":36,"values":{"1":{"slot":1,"type":"STRING","value":"segmentmaxenddatetimeutc"}}},"37":{"slot":37,"values":{"1":{"slot":1,"type":"STRING","value":"legminstartdatetimeutc"}}},"38":{"slot":38,"values":{"1":{"slot":1,"type":"STRING","value":"legmaxstartdatetimeutc"}}},"39":{"slot":39,"values":{"1":{"slot":1,"type":"STRING","value":"legmaxenddatetimeutc"}}},"40":{"slot":40,"values":{"1":{"slot":1,"type":"STRING","value":"segmentchangereasoncode"}}},"41":{"slot":41,"values":{"1":{"slot":1,"type":"STRING","value":"bookingdateflag"}}},"42":{"slot":42,"values":{"1":{"slot":1,"type":"STRING","value":"seatassignedflag"}}},"43":{"slot":43,"values":{"1":{"slot":1,"type":"STRING","value":"checkinflag"}}},"44":{"slot":44,"values":{"1":{"slot":1,"type":"STRING","value":"boardedflag"}}},"45":{"slot":45,"values":{"1":{"slot":1,"type":"STRING","value":"noshowflag"}}},"46":{"slot":46,"values":{"1":{"slot":1,"type":"STRING","value":"unboardedflag"}}},"47":{"slot":47,"values":{"1":{"slot":1,"type":"STRING","value":"checkoutflag"}}},"48":{"slot":48,"values":{"1":{"slot":1,"type":"STRING","value":"segmentaddedflag"}}},"49":{"slot":49,"values":{"1":{"slot":1,"type":"STRING","value":"segmentdroppedflag"}}},"50":{"slot":50,"values":{"1":{"slot":1,"type":"STRING","value":"segmentchangeflag"}}},"51":{"slot":51,"values":{"1":{"slot":1,"type":"STRING","value":"legaddedflag"}}},"52":{"slot":52,"values":{"1":{"slot":1,"type":"STRING","value":"legaddedtempflag"}}},"53":{"slot":53,"values":{"1":{"slot":1,"type":"STRING","value":"legdroppedflag"}}},"54":{"slot":54,"values":{"1":{"slot":1,"type":"STRING","value":"flightflownflag"}}},"55":{"slot":55,"values":{"1":{"slot":1,"type":"STRING","value":"createdttm"}}},"56":{"slot":56,"values":{"1":{"slot":1,"type":"STRING","value":"pjlvid"}}},"57":{"slot":57,"values":{"1":{"slot":1,"type":"STRING","value":"sdtops"}}},"58":{"slot":58,"values":{"1":{"slot":1,"type":"STRING","value":"outtime"}}},"59":{"slot":59,"values":{"1":{"slot":1,"type":"STRING","value":"ontime"}}},"60":{"slot":60,"values":{"1":{"slot":1,"type":"STRING","value":"intime"}}},"61":{"slot":61,"values":{"1":{"slot":1,"type":"STRING","value":"arrivalvsscheduled"}}},"62":{"slot":62,"values":{"1":{"slot":1,"type":"STRING","value":"arrivaloveralldelaytime"}}},"63":{"slot":63,"values":{"1":{"slot":1,"type":"STRING","value":"arrivaloveralldelaycode"}}},"64":{"slot":64,"values":{"1":{"slot":1,"type":"STRING","value":"arrivaloveralldelaycontrollable"}}},"65":{"slot":65,"values":{"1":{"slot":1,"type":"STRING","value":"arrivaldelaycode1"}}},"66":{"slot":66,"values":{"1":{"slot":1,"type":"STRING","value":"arrivaldelaytime1"}}},"67":{"slot":67,"values":{"1":{"slot":1,"type":"STRING","value":"arrivaldelaycode2"}}},"68":{"slot":68,"values":{"1":{"slot":1,"type":"STRING","value":"arrivaldelaytime2"}}},"69":{"slot":69,"values":{"1":{"slot":1,"type":"STRING","value":"iropcode"}}},"70":{"slot":70,"values":{"1":{"slot":1,"type":"STRING","value":"totalarrivaldelayminute"}}},"71":{"slot":71,"values":{"1":{"slot":1,"type":"STRING","value":"arrivaldelaycontrollableminute"}}},"72":{"slot":72,"values":{"1":{"slot":1,"type":"STRING","value":"arrivaldelaycontrollablesafetyminute"}}},"73":{"slot":73,"values":{"1":{"slot":1,"type":"STRING","value":"arrivaldelayuncontrollableminute"}}},"74":{"slot":74,"values":{"1":{"slot":1,"type":"STRING","value":"scheduledarrivalflightflag"}}},"75":{"slot":75,"values":{"1":{"slot":1,"type":"STRING","value":"actualarrivalflightflag"}}},"76":{"slot":76,"values":{"1":{"slot":1,"type":"STRING","value":"scheduleactualstaminutedifference"}}},"77":{"slot":77,"values":{"1":{"slot":1,"type":"STRING","value":"customerflightchangeflag"}}},"78":{"slot":78,"values":{"1":{"slot":1,"type":"STRING","value":"departureoveralldelaytime"}}},"79":{"slot":79,"values":{"1":{"slot":1,"type":"STRING","value":"departureoveralldelaycode"}}},"80":{"slot":80,"values":{"1":{"slot":1,"type":"STRING","value":"departureoveralldelaycontrollable"}}},"81":{"slot":81,"values":{"1":{"slot":1,"type":"STRING","value":"departureoveralldelaymaintenance"}}},"82":{"slot":82,"values":{"1":{"slot":1,"type":"STRING","value":"departuredelaycode1"}}},"83":{"slot":83,"values":{"1":{"slot":1,"type":"STRING","value":"departuredelaytime1"}}},"84":{"slot":84,"values":{"1":{"slot":1,"type":"STRING","value":"departuredelaycode2"}}},"85":{"slot":85,"values":{"1":{"slot":1,"type":"STRING","value":"departuredelaytime2"}}},"86":{"slot":86,"values":{"1":{"slot":1,"type":"STRING","value":"departuredelaycode3"}}},"87":{"slot":87,"values":{"1":{"slot":1,"type":"STRING","value":"departuredelaytime3"}}},"88":{"slot":88,"values":{"1":{"slot":1,"type":"STRING","value":"offtime"}}},"89":{"slot":89,"values":{"1":{"slot":1,"type":"STRING","value":"departurevsscheduled"}}},"90":{"slot":90,"values":{"1":{"slot":1,"type":"STRING","value":"carriercode"}}},"91":{"slot":91,"values":{"1":{"slot":1,"type":"STRING","value":"voluntaryflag"}}},"92":{"slot":92,"values":{"1":{"slot":1,"type":"STRING","value":"eat"}}},"93":{"slot":93,"values":{"1":{"slot":1,"type":"STRING","value":"edt"}}},"94":{"slot":94,"values":{"1":{"slot":1,"type":"STRING","value":"sta"}}},"95":{"slot":95,"values":{"1":{"slot":1,"type":"STRING","value":"stautc"}}},"96":{"slot":96,"values":{"1":{"slot":1,"type":"STRING","value":"eta"}}},"97":{"slot":97,"values":{"1":{"slot":1,"type":"STRING","value":"etd"}}},"98":{"slot":98,"values":{"1":{"slot":1,"type":"STRING","value":"productclasscode"}}},"99":{"slot":99,"values":{"1":{"slot":1,"type":"STRING","value":"interlinebookingflag"}}},"100":{"slot":100,"values":{"1":{"slot":1,"type":"STRING","value":"etautc"}}},"101":{"slot":101,"values":{"1":{"slot":1,"type":"STRING","value":"iropcodecontrolcategory"}}},"102":{"slot":102,"values":{"1":{"slot":1,"type":"STRING","value":"arrivaldelaycontrolcategory1"}}},"103":{"slot":103,"values":{"1":{"slot":1,"type":"STRING","value":"arrivaldelaycontrolcategory2"}}},"104":{"slot":104,"values":{"1":{"slot":1,"type":"STRING","value":"departuredelaycontrolcategory1"}}},"105":{"slot":105,"values":{"1":{"slot":1,"type":"STRING","value":"departuredelaycontrolcategory2"}}},"106":{"slot":106,"values":{"1":{"slot":1,"type":"STRING","value":"departuredelaycontrolcategory3"}}},"107":{"slot":107,"values":{"1":{"slot":1,"type":"STRING","value":"pnrdividedflag"}}},"108":{"slot":108,"values":{"1":{"slot":1,"type":"STRING","value":"etdutc"}}},"109":{"slot":109,"values":{"1":{"slot":1,"type":"STRING","value":"interlinebookingtype"}}},"110":{"slot":110,"values":{"1":{"slot":1,"type":"STRING","value":"standbyflag"}}},"111":{"slot":111,"values":{"1":{"slot":1,"type":"STRING","value":"journeyod"}}},"112":{"slot":112,"values":{"1":{"slot":1,"type":"STRING","value":"gdsmultiplejourneyflag"}}},"113":{"slot":113,"values":{"1":{"slot":1,"type":"STRING","value":"samedayroundtripflag"}}}},"visible":true},"4":{"slot":4,"name":"Trim Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true},"5":{"slot":5,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"stage"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"64913":{"id":64913,"inputCardinality":"ZERO_OR_MANY","outputCardinality":"MANY","implementationID":-1266674941,"x":432,"y":259,"width":32,"height":32,"inputConnectorIDs":[64918],"outputConnectorIDs":[64917],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"format data"}}}},"visible":true},"2":{"slot":2,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SELECT \nppec.pnr, \nppec.bookingdatetimeutc, \nppec.departuredate, \nppec.eventdatetimeutc,\nppec.eventname, \nCOALESCE(ppec.eventreason, '') as eventreason, \nppec.eventuser, \nppec.eventlocation, \nppec.flightnumber, \nppec.carriercode, \nppec.departurestation, \nppec.arrivalstation, \nppec.stdutc, \nppec.std, \n--CONVERT_TIMEZONE(ap.awstimezone, 'UTC', ppec.sta) as stautc, \nppec.stautc, \nppec.etautc, \nppec.sta, \nppec.eta,\nppec.etd,\nppec.etdutc,\nppec.ontime, \nppec.intime, \nppec.passengerid, \nppec.flightflownflag, \nppec.bookingdateflag, \nppec.liftstatus,\nppec.offtime,\nppec.outtime,\nCASE WHEN ppec.liftstatus = 0 THEN 'booked'\n\tWHEN ppec.liftstatus = 1 THEN  'checkin'\n    WHEN ppec.liftstatus = 2 THEN 'boarded'\n    WHEN ppec.liftstatus = 3 THEN 'noshow'\n    ELSE 'unknoww' END AS passengerflightstatus,\nppec.boardingsequence,\nCASE WHEN ppec.eventdatetimeutc <= DATEADD(d, -1, ppec.departuredate) \n          AND eventname IN ('BOOKED', 'SEATASSIGNED', 'CHECKEDIN') \nTHEN 1 ELSE 0 \nEND as scheduledflightflag,\n\nCOALESCE(ppec.scheduledarrivalflightflag, 0) as scheduledarrivalflightflag, \nCOALESCE(ppec.actualarrivalflightflag, 0) as actualarrivalflightflag, \nppec.journeynumber,\nppec.segmentnumber,\nppec.legnumber,\nppec.unitdesignator as assignedseat,\nppec.arrivaldelaycontrollableminute as arrivalvsscheduledcontrollable,\nppec.arrivaldelayuncontrollableminute as arrivalvsscheduleduncontrollable,\nppec.arrivaldelaycontrollablesafetyminute as arrivalvsscheduledcontrollablesafety,\nppec.arrivaldelaycontrollableminute,\nppec.arrivaldelaycontrollablesafetyminute,\nppec.arrivaldelayuncontrollableminute,\nppec.arrivalvsscheduled,\nppec.arrivaloveralldelaytime,\nppec.arrivaloveralldelaycode,\nppec.arrivaloveralldelaycontrollable,\nppec.arrivaldelaycode1,\nppec.arrivaldelaytime1,\nppec.arrivaldelaycontrolcategory1,\nppec.arrivaldelaycode2,\nppec.arrivaldelaytime2,\nppec.arrivaldelaycontrolcategory2,\nppec.iropcode,\nppec.iropcodecontrolcategory,\nppec.segmentid,\nppec.inventorylegid,\nppec.pjlvid, \nppec.bookingid,\nCASE WHEN ppec.eventname = 'BOARDED' AND actualarrivalflightflag = 1 THEN ISNULL(ppec.scheduleactualstaminutedifference,0) ELSE 0 END as finalflightarrivaldelayminute,\nCASE WHEN ppec.eventname = 'BOARDED' AND actualarrivalflightflag = 1 THEN ISNULL(ppec.scheduleactualstaminutedifference,0) +  ppec.arrivalvsscheduled ELSE 0 END as totalfinalarrivaldelayminute,\nCASE WHEN ppec.eventname = 'BOARDED' THEN ppec.totalArrivalDelayMinute ELSE 0 END AS totalarrivaldelayminute,\nCASE WHEN UPPER(ppec.eventuser) = 'CUSTOMER' AND UPPER(ppec.eventname) IN ('FLIGHT ADDED','FLIGHT CHANGED','FLIGHT DROPPED') THEN 1 ELSE 0 END AS customerflightchangeflag, \n\nppec.departurevsscheduled,\nppec.departureoveralldelaytime,\nppec.departureoveralldelaycode,\nppec.departureoveralldelaycontrollable, \nppec.departureoveralldelaymaintenance,\nCOALESCE(ppec.departuredelaycode1, '') as departuredelaycode1, \nCOALESCE(ppec.departuredelaytime1, 0) as departuredelaytime1, \n--CASE WHEN ppec.departuredelaycontrollable1 = 'false' THEN 0 ELSE 1 END as departuredelaycontrollable1,\nppec.departuredelaycontrolcategory1,\nCOALESCE(ppec.departuredelaycode2, '') as departuredelaycode2, \nCOALESCE(ppec.departuredelaytime2, 0) as departuredelaytime2, \n--CASE WHEN ppec.departuredelaycontrollable2 = 'false' THEN 0 ELSE 1 END as departuredelaycontrollable2, \nppec.departuredelaycontrolcategory2,\nCOALESCE(ppec.departuredelaycode3, '') as departuredelaycode3, \nCOALESCE(ppec.departuredelaytime3, 0) as departuredelaytime3,\n--CASE WHEN ppec.departuredelaycontrollable1 = 'false' THEN 0 ELSE 1 END as departuredelaycontrollable3,\nppec.departuredelaycontrolcategory3,\nCASE WHEN Voluntaryflag IS NULL THEN 0 ELSE Voluntaryflag END AS voluntaryflag\n,ppec.productclasscode\n,ISNULL(ppec.interlinebookingflag,0) as interlinebookingflag\n,ppec.journeysta\n,ppec.journeystautc\n,ppec.segmentsta\n,ppec.segmentstautc\n/*incremental delay minutes for an event */\n, CASE \n\tWHEN ppec.eventname ='FLIGHT ADDED'  THEN DATEDIFF(minute, ppec.journeysta,ppec.sta) \n\t/* sequential flight changes use the related flight drop sta to adjust the delay minutes differences */\n\t WHEN ppec.eventname ='FLIGHT ADDED' THEN DATEDIFF(minute, ppec.journeysta, ppec.sta) \n\t\n\t WHEN POSITION ('DELAY' IN ppec.eventname) > 0 THEN DATEDIFF(minute, ppec.sta, ppec.eta) \n\t \n\t WHEN ppec.eventname = 'FLIGHT ARRIVAL' THEN DATEDIFF(minute, ppec.eta,ppec.intime) \n\t\t \n\t ELSE 0 END AS journeydelayminute\n,ISNULL(interlinebookingtype,0) AS interlinebookingtype\n,ISNULL(standbyflag,0) AS standbyflag\n,ISNULL(ppec.pnrdividedflag,0) AS pnrdividedflag\n,ISNULL(ppec.gdsmultiplejourneyflag,0) AS gdsmultiplejourneyflag\n,ISNULL(ppec.journeyod,'') AS journeyod\n,ISNULL(ppec.samedayroundtripflag,0) AS samedayroundtripflag\nFROm $T{pnrpassengereventcalc} ppec\n--LEFT JOIN public.airport ap\n--ON ppec.arrivalstation = ap.airportcode \nWHERE ppec.eventname IS NOT NULL \nAND ppec.pnr is NOT NULL\nAND EXISTS (SELECT 1 FROM stage.pnrpassengereventlist AS ppel\n\t\t\t\tWHERE ppec.pnr = ppel.pnr)"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"64914":{"id":64914,"inputCardinality":"ONE","outputCardinality":"ZERO","implementationID":-1848704949,"x":864,"y":256,"width":32,"height":32,"inputConnectorIDs":[64916],"outputConnectorIDs":[],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"load public.pnrpassengerhistory"}}}},"visible":true},"2":{"slot":2,"name":"Target Table Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"pnrpassengerhistory"}}}},"visible":true},"3":{"slot":3,"name":"Fix Data Type Mismatches","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true},"4":{"slot":4,"name":"Column Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"eventdatetimeutc"},"2":{"slot":2,"type":"STRING","value":"eventdatetimeutc"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"eventname"},"2":{"slot":2,"type":"STRING","value":"eventname"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"eventuser"},"2":{"slot":2,"type":"STRING","value":"eventuser"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"eventlocation"},"2":{"slot":2,"type":"STRING","value":"eventlocation"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"eventreason"},"2":{"slot":2,"type":"STRING","value":"eventreason"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"pnr"},"2":{"slot":2,"type":"STRING","value":"pnr"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"bookingdatetimeutc"},"2":{"slot":2,"type":"STRING","value":"bookingdatetimeutc"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"bookingid"},"2":{"slot":2,"type":"STRING","value":"bookingid"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"passengerid"},"2":{"slot":2,"type":"STRING","value":"passengerid"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"journeynumber"},"2":{"slot":2,"type":"STRING","value":"journeynumber"}}},"11":{"slot":11,"values":{"1":{"slot":1,"type":"STRING","value":"segmentnumber"},"2":{"slot":2,"type":"STRING","value":"segmentnumber"}}},"12":{"slot":12,"values":{"1":{"slot":1,"type":"STRING","value":"legnumber"},"2":{"slot":2,"type":"STRING","value":"legnumber"}}},"13":{"slot":13,"values":{"1":{"slot":1,"type":"STRING","value":"liftstatus"},"2":{"slot":2,"type":"STRING","value":"liftstatus"}}},"14":{"slot":14,"values":{"1":{"slot":1,"type":"STRING","value":"flightnumber"},"2":{"slot":2,"type":"STRING","value":"flightnumber"}}},"15":{"slot":15,"values":{"1":{"slot":1,"type":"STRING","value":"departuredate"},"2":{"slot":2,"type":"STRING","value":"departuredate"}}},"16":{"slot":16,"values":{"1":{"slot":1,"type":"STRING","value":"stdutc"},"2":{"slot":2,"type":"STRING","value":"stdutc"}}},"17":{"slot":17,"values":{"1":{"slot":1,"type":"STRING","value":"std"},"2":{"slot":2,"type":"STRING","value":"std"}}},"18":{"slot":18,"values":{"1":{"slot":1,"type":"STRING","value":"stautc"},"2":{"slot":2,"type":"STRING","value":"stautc"}}},"19":{"slot":19,"values":{"1":{"slot":1,"type":"STRING","value":"sta"},"2":{"slot":2,"type":"STRING","value":"sta"}}},"20":{"slot":20,"values":{"1":{"slot":1,"type":"STRING","value":"ontime"},"2":{"slot":2,"type":"STRING","value":"ontime"}}},"21":{"slot":21,"values":{"1":{"slot":1,"type":"STRING","value":"intime"},"2":{"slot":2,"type":"STRING","value":"intime"}}},"22":{"slot":22,"values":{"1":{"slot":1,"type":"STRING","value":"departurestation"},"2":{"slot":2,"type":"STRING","value":"departurestation"}}},"23":{"slot":23,"values":{"1":{"slot":1,"type":"STRING","value":"arrivalstation"},"2":{"slot":2,"type":"STRING","value":"arrivalstation"}}},"24":{"slot":24,"values":{"1":{"slot":1,"type":"STRING","value":"assignedseat"},"2":{"slot":2,"type":"STRING","value":"assignedseat"}}},"25":{"slot":25,"values":{"1":{"slot":1,"type":"STRING","value":"boardingsequence"},"2":{"slot":2,"type":"STRING","value":"boardingsequence"}}},"26":{"slot":26,"values":{"1":{"slot":1,"type":"STRING","value":"flightflownflag"},"2":{"slot":2,"type":"STRING","value":"flownflightflag"}}},"27":{"slot":27,"values":{"1":{"slot":1,"type":"STRING","value":"bookingdateflag"},"2":{"slot":2,"type":"STRING","value":"bookingflightflag"}}},"28":{"slot":28,"values":{"1":{"slot":1,"type":"STRING","value":"scheduledflightflag"},"2":{"slot":2,"type":"STRING","value":"scheduledflightflag"}}},"29":{"slot":29,"values":{"1":{"slot":1,"type":"STRING","value":"arrivaldelaycontrollableminute"},"2":{"slot":2,"type":"STRING","value":"arrivaldelaycontrollableminute"}}},"30":{"slot":30,"values":{"1":{"slot":1,"type":"STRING","value":"arrivaldelaycontrollablesafetyminute"},"2":{"slot":2,"type":"STRING","value":"arrivaldelaycontrollablesafetyminute"}}},"31":{"slot":31,"values":{"1":{"slot":1,"type":"STRING","value":"arrivaldelayuncontrollableminute"},"2":{"slot":2,"type":"STRING","value":"arrivaldelayuncontrollableminute"}}},"32":{"slot":32,"values":{"1":{"slot":1,"type":"STRING","value":"arrivalvsscheduled"},"2":{"slot":2,"type":"STRING","value":"arrivalvsscheduled"}}},"33":{"slot":33,"values":{"1":{"slot":1,"type":"STRING","value":"arrivaloveralldelaytime"},"2":{"slot":2,"type":"STRING","value":"arrivaloveralldelaytime"}}},"34":{"slot":34,"values":{"1":{"slot":1,"type":"STRING","value":"arrivaloveralldelaycode"},"2":{"slot":2,"type":"STRING","value":"arrivaloveralldelaycode"}}},"35":{"slot":35,"values":{"1":{"slot":1,"type":"STRING","value":"arrivaloveralldelaycontrollable"},"2":{"slot":2,"type":"STRING","value":"arrivaloveralldelaycontrollable"}}},"36":{"slot":36,"values":{"1":{"slot":1,"type":"STRING","value":"arrivaldelaycode1"},"2":{"slot":2,"type":"STRING","value":"arrivaldelaycode1"}}},"37":{"slot":37,"values":{"1":{"slot":1,"type":"STRING","value":"arrivaldelaytime1"},"2":{"slot":2,"type":"STRING","value":"arrivaldelaytime1"}}},"38":{"slot":38,"values":{"1":{"slot":1,"type":"STRING","value":"arrivaldelaycontrolcategory1"},"2":{"slot":2,"type":"STRING","value":"arrivaldelaycontrolcategory1"}}},"39":{"slot":39,"values":{"1":{"slot":1,"type":"STRING","value":"arrivaldelaycode2"},"2":{"slot":2,"type":"STRING","value":"arrivaldelaycode2"}}},"40":{"slot":40,"values":{"1":{"slot":1,"type":"STRING","value":"arrivaldelaytime2"},"2":{"slot":2,"type":"STRING","value":"arrivaldelaytime2"}}},"41":{"slot":41,"values":{"1":{"slot":1,"type":"STRING","value":"arrivaldelaycontrolcategory2"},"2":{"slot":2,"type":"STRING","value":"arrivaldelaycontrolcategory2"}}},"42":{"slot":42,"values":{"1":{"slot":1,"type":"STRING","value":"iropcode"},"2":{"slot":2,"type":"STRING","value":"iropcode"}}},"43":{"slot":43,"values":{"1":{"slot":1,"type":"STRING","value":"segmentid"},"2":{"slot":2,"type":"STRING","value":"segmentid"}}},"44":{"slot":44,"values":{"1":{"slot":1,"type":"STRING","value":"inventorylegid"},"2":{"slot":2,"type":"STRING","value":"inventorylegid"}}},"45":{"slot":45,"values":{"1":{"slot":1,"type":"STRING","value":"pjlvid"},"2":{"slot":2,"type":"STRING","value":"pjlvid"}}},"46":{"slot":46,"values":{"1":{"slot":1,"type":"STRING","value":"scheduledarrivalflightflag"},"2":{"slot":2,"type":"STRING","value":"scheduledarrivalflightflag"}}},"47":{"slot":47,"values":{"1":{"slot":1,"type":"STRING","value":"actualarrivalflightflag"},"2":{"slot":2,"type":"STRING","value":"actualarrivalflightflag"}}},"48":{"slot":48,"values":{"1":{"slot":1,"type":"STRING","value":"totalfinalarrivaldelayminute"},"2":{"slot":2,"type":"STRING","value":"totalfinalarrivaldelayminute"}}},"49":{"slot":49,"values":{"1":{"slot":1,"type":"STRING","value":"totalarrivaldelayminute"},"2":{"slot":2,"type":"STRING","value":"totalarrivaldelayminute"}}},"50":{"slot":50,"values":{"1":{"slot":1,"type":"STRING","value":"finalflightarrivaldelayminute"},"2":{"slot":2,"type":"STRING","value":"finalflightarrivaldelayminute"}}},"51":{"slot":51,"values":{"1":{"slot":1,"type":"STRING","value":"customerflightchangeflag"},"2":{"slot":2,"type":"STRING","value":"customerflightchangeflag"}}},"52":{"slot":52,"values":{"1":{"slot":1,"type":"STRING","value":"departureoveralldelaytime"},"2":{"slot":2,"type":"STRING","value":"departureoveralldelaytime"}}},"53":{"slot":53,"values":{"1":{"slot":1,"type":"STRING","value":"departureoveralldelaycode"},"2":{"slot":2,"type":"STRING","value":"departureoveralldelaycode"}}},"54":{"slot":54,"values":{"1":{"slot":1,"type":"STRING","value":"departureoveralldelaycontrollable"},"2":{"slot":2,"type":"STRING","value":"departureoveralldelaycontrollable"}}},"55":{"slot":55,"values":{"1":{"slot":1,"type":"STRING","value":"departureoveralldelaymaintenance"},"2":{"slot":2,"type":"STRING","value":"departureoveralldelaymaintenance"}}},"56":{"slot":56,"values":{"1":{"slot":1,"type":"STRING","value":"departuredelaycode1"},"2":{"slot":2,"type":"STRING","value":"departuredelaycode1"}}},"57":{"slot":57,"values":{"1":{"slot":1,"type":"STRING","value":"departuredelaytime1"},"2":{"slot":2,"type":"STRING","value":"departuredelaytime1"}}},"58":{"slot":58,"values":{"1":{"slot":1,"type":"STRING","value":"departuredelaycontrolcategory1"},"2":{"slot":2,"type":"STRING","value":"departuredelaycontrolcategory1"}}},"59":{"slot":59,"values":{"1":{"slot":1,"type":"STRING","value":"departuredelaycode2"},"2":{"slot":2,"type":"STRING","value":"departuredelaycode2"}}},"60":{"slot":60,"values":{"1":{"slot":1,"type":"STRING","value":"departuredelaytime2"},"2":{"slot":2,"type":"STRING","value":"departuredelaytime2"}}},"61":{"slot":61,"values":{"1":{"slot":1,"type":"STRING","value":"departuredelaycontrolcategory2"},"2":{"slot":2,"type":"STRING","value":"departuredelaycontrolcategory2"}}},"62":{"slot":62,"values":{"1":{"slot":1,"type":"STRING","value":"departuredelaycode3"},"2":{"slot":2,"type":"STRING","value":"departuredelaycode3"}}},"63":{"slot":63,"values":{"1":{"slot":1,"type":"STRING","value":"departuredelaytime3"},"2":{"slot":2,"type":"STRING","value":"departuredelaytime3"}}},"64":{"slot":64,"values":{"1":{"slot":1,"type":"STRING","value":"departuredelaycontrolcategory3"},"2":{"slot":2,"type":"STRING","value":"departuredelaycontrolcategory3"}}},"65":{"slot":65,"values":{"1":{"slot":1,"type":"STRING","value":"offtime"},"2":{"slot":2,"type":"STRING","value":"offtime"}}},"66":{"slot":66,"values":{"1":{"slot":1,"type":"STRING","value":"outtime"},"2":{"slot":2,"type":"STRING","value":"outtime"}}},"67":{"slot":67,"values":{"1":{"slot":1,"type":"STRING","value":"passengerflightstatus"},"2":{"slot":2,"type":"STRING","value":"passengerflightstatus"}}},"68":{"slot":68,"values":{"1":{"slot":1,"type":"STRING","value":"departurevsscheduled"},"2":{"slot":2,"type":"STRING","value":"departurevsscheduled"}}},"69":{"slot":69,"values":{"1":{"slot":1,"type":"STRING","value":"carriercode"},"2":{"slot":2,"type":"STRING","value":"carriercode"}}},"70":{"slot":70,"values":{"1":{"slot":1,"type":"STRING","value":"voluntaryflag"},"2":{"slot":2,"type":"STRING","value":"voluntaryflag"}}},"71":{"slot":71,"values":{"1":{"slot":1,"type":"STRING","value":"etd"},"2":{"slot":2,"type":"STRING","value":"etd"}}},"72":{"slot":72,"values":{"1":{"slot":1,"type":"STRING","value":"productclasscode"},"2":{"slot":2,"type":"STRING","value":"productclasscode"}}},"73":{"slot":73,"values":{"1":{"slot":1,"type":"STRING","value":"interlinebookingflag"},"2":{"slot":2,"type":"STRING","value":"interlinebookingflag"}}},"74":{"slot":74,"values":{"1":{"slot":1,"type":"STRING","value":"journeysta"},"2":{"slot":2,"type":"STRING","value":"journeysta"}}},"75":{"slot":75,"values":{"1":{"slot":1,"type":"STRING","value":"journeystautc"},"2":{"slot":2,"type":"STRING","value":"journeystautc"}}},"76":{"slot":76,"values":{"1":{"slot":1,"type":"STRING","value":"segmentsta"},"2":{"slot":2,"type":"STRING","value":"segmentsta"}}},"77":{"slot":77,"values":{"1":{"slot":1,"type":"STRING","value":"segmentstautc"},"2":{"slot":2,"type":"STRING","value":"segmentstautc"}}},"78":{"slot":78,"values":{"1":{"slot":1,"type":"STRING","value":"eta"},"2":{"slot":2,"type":"STRING","value":"eta"}}},"79":{"slot":79,"values":{"1":{"slot":1,"type":"STRING","value":"etautc"},"2":{"slot":2,"type":"STRING","value":"etautc"}}},"80":{"slot":80,"values":{"1":{"slot":1,"type":"STRING","value":"journeydelayminute"},"2":{"slot":2,"type":"STRING","value":"journeydelayminute"}}},"81":{"slot":81,"values":{"1":{"slot":1,"type":"STRING","value":"iropcodecontrolcategory"},"2":{"slot":2,"type":"STRING","value":"iropcodecontrolcategory"}}},"82":{"slot":82,"values":{"1":{"slot":1,"type":"STRING","value":"pnrdividedflag"},"2":{"slot":2,"type":"STRING","value":"pnrdividedflag"}}},"83":{"slot":83,"values":{"1":{"slot":1,"type":"STRING","value":"etdutc"},"2":{"slot":2,"type":"STRING","value":"etdutc"}}},"84":{"slot":84,"values":{"1":{"slot":1,"type":"STRING","value":"standbyflag"},"2":{"slot":2,"type":"STRING","value":"standbyflag"}}},"85":{"slot":85,"values":{"1":{"slot":1,"type":"STRING","value":"interlinebookingtype"},"2":{"slot":2,"type":"STRING","value":"interlinebookingtype"}}},"86":{"slot":86,"values":{"1":{"slot":1,"type":"STRING","value":"samedayroundtripflag"},"2":{"slot":2,"type":"STRING","value":"samedayroundtripflag"}}},"87":{"slot":87,"values":{"1":{"slot":1,"type":"STRING","value":"journeyod"},"2":{"slot":2,"type":"STRING","value":"journeyod"}}},"88":{"slot":88,"values":{"1":{"slot":1,"type":"STRING","value":"gdsmultiplejourneyflag"},"2":{"slot":2,"type":"STRING","value":"gdsmultiplejourneyflag"}}}},"visible":true},"5":{"slot":5,"name":"Unique Keys","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"eventdatetimeutc"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"eventname"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"segmentid"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"legnumber"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"passengerid"}}}},"visible":true},"6":{"slot":6,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"public"}}}},"visible":true},"7":{"slot":7,"name":"Update Strategy","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Update/Insert"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"64915":{"id":64915,"inputCardinality":"ZERO_OR_MANY","outputCardinality":"MANY","implementationID":-1266674941,"x":656,"y":256,"width":32,"height":32,"inputConnectorIDs":[64917],"outputConnectorIDs":[64916],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"filter events"}}}},"visible":true},"2":{"slot":2,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SELECT \n*\nFROM $T{format data}\nWHERE eventname NOT IN ('UNKNOWN EVENT TYPE','UNKNOWN PAX EVENT')\nAND eventname IS NOT NULL   "}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"}},"connectors":{"64916":{"id":64916,"sourceID":64915,"targetID":64914},"64917":{"id":64917,"sourceID":64913,"targetID":64915},"64918":{"id":64918,"sourceID":64912,"targetID":64913}},"canUndo":false,"undoCommand":"","undoCreated":-1,"canRedo":false,"redoCommand":"","redoCreated":-1,"notes":{"64910":{"id":64910,"x":233,"y":84,"width":413,"height":103,"text":"Format the data staged records before loading the records into the public schema\n\nprevent any unknown events or nulls inserted into the public table\n\nupdate:2019-11-19","colour":"e6e63c"},"64911":{"id":64911,"x":387,"y":221,"width":100,"height":146,"text":"\n\n\n\n\n\nadd conditions to only add values on to records based on their event","colour":"e6e63c"}},"noteConnectors":{},"variables":{},"grids":{}},"info":{"name":"PNR - Final Calcs and History Load","description":"","type":"TRANSFORMATION"}}