{"job":{"components":{"64717":{"id":64717,"inputCardinality":"ZERO_OR_MANY","outputCardinality":"MANY","implementationID":-1266674941,"x":-48,"y":176,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[64720],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"baggageevents"}}}},"visible":true},"2":{"slot":2,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SELECT \nbookingid\n,bookingdatetimeutc\n,pnr\n,createdutc AS eventdatetimeutc\n,passengerid\n,journeynumber\n,segmentnumber\n,segmentid\n,legnumber\n,baggagestatus\n,createduserid\n,createduserid AS modifieduserid\n,BaggageID\n,ostagdate\n,stationcode\n,taggedtoflightnumber\n,taggedtocarriercode\n,departurestation\n,arrivalstation\n,departuredate\n,carriercode\n,flightnumber\n,inventorylegid\nFROM etl.odsbaggagecheck"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"64718":{"id":64718,"inputCardinality":"ONE","outputCardinality":"ZERO","implementationID":-1848704949,"x":528,"y":176,"width":32,"height":32,"inputConnectorIDs":[64721],"outputConnectorIDs":[],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"stage.passengerflightevent"}}}},"visible":true},"2":{"slot":2,"name":"Target Table Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"passengerflightevent"}}}},"visible":true},"3":{"slot":3,"name":"Fix Data Type Mismatches","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true},"4":{"slot":4,"name":"Column Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"eventdatetimeutc"},"2":{"slot":2,"type":"STRING","value":"eventdatetimeutc"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"passengerid"},"2":{"slot":2,"type":"STRING","value":"passengerid"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"journeynumber"},"2":{"slot":2,"type":"STRING","value":"journeynumber"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"segmentnumber"},"2":{"slot":2,"type":"STRING","value":"segmentnumber"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"eventtype"},"2":{"slot":2,"type":"STRING","value":"eventtype"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"bookingid"},"2":{"slot":2,"type":"STRING","value":"bookingid"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"bookingdatetimeutc"},"2":{"slot":2,"type":"STRING","value":"bookingdatetimeutc"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"pnr"},"2":{"slot":2,"type":"STRING","value":"pnr"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"inventorylegid"},"2":{"slot":2,"type":"STRING","value":"inventorylegid"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"carriercode"},"2":{"slot":2,"type":"STRING","value":"carriercode"}}},"11":{"slot":11,"values":{"1":{"slot":1,"type":"STRING","value":"flightnumber"},"2":{"slot":2,"type":"STRING","value":"flightnumber"}}},"12":{"slot":12,"values":{"1":{"slot":1,"type":"STRING","value":"departuredate"},"2":{"slot":2,"type":"STRING","value":"departuredate"}}},"13":{"slot":13,"values":{"1":{"slot":1,"type":"STRING","value":"departurestation"},"2":{"slot":2,"type":"STRING","value":"departurestation"}}},"14":{"slot":14,"values":{"1":{"slot":1,"type":"STRING","value":"arrivalstation"},"2":{"slot":2,"type":"STRING","value":"arrivalstation"}}},"15":{"slot":15,"values":{"1":{"slot":1,"type":"STRING","value":"createduserid"},"2":{"slot":2,"type":"STRING","value":"createduserid"}}},"16":{"slot":16,"values":{"1":{"slot":1,"type":"STRING","value":"modifieduserid"},"2":{"slot":2,"type":"STRING","value":"modifieduserid"}}},"17":{"slot":17,"values":{"1":{"slot":1,"type":"STRING","value":"legnumber"},"2":{"slot":2,"type":"STRING","value":"legnumber"}}},"18":{"slot":18,"values":{"1":{"slot":1,"type":"STRING","value":"bagcheckinflag"},"2":{"slot":2,"type":"STRING","value":"bagcheckinflag"}}},"19":{"slot":19,"values":{"1":{"slot":1,"type":"STRING","value":"bagcheckoutflag"},"2":{"slot":2,"type":"STRING","value":"bagcheckoutflag"}}},"20":{"slot":20,"values":{"1":{"slot":1,"type":"STRING","value":"baggageid"},"2":{"slot":2,"type":"STRING","value":"eventsourceid"}}},"21":{"slot":21,"values":{"1":{"slot":1,"type":"STRING","value":"segmentid"},"2":{"slot":2,"type":"STRING","value":"segmentid"}}}},"visible":true},"5":{"slot":5,"name":"Unique Keys","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"eventdatetimeutc"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"eventtype"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"eventsourceid"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"passengerid"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"segmentid"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"legnumber"}}}},"visible":true},"6":{"slot":6,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"stage"}}}},"visible":true},"7":{"slot":7,"name":"Update Strategy","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Update/Insert"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"64719":{"id":64719,"inputCardinality":"ZERO_OR_MANY","outputCardinality":"MANY","implementationID":-1266674941,"x":256,"y":176,"width":32,"height":32,"inputConnectorIDs":[64720],"outputConnectorIDs":[64721],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"baggagecheckin_checkout_eventflag"}}}},"visible":true},"2":{"slot":2,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SELECT \nCASE WHEN baggagestatus =  1 THEN 'bagcheckin' \n\tWHEN baggagestatus = 2 THEN 'bagcheckout' \n    ELSE 'unknown' END AS eventtype\n,CASE WHEN baggagestatus =  1 THEN 1 ELSE 0 END AS bagcheckinFlag\n,CASE WHEN baggagestatus =  2 THEN 1 ELSE 0 END AS bagcheckoutFlag\n\n,*\nFROM $T{baggageevents}"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"}},"connectors":{"64720":{"id":64720,"sourceID":64717,"targetID":64719},"64721":{"id":64721,"sourceID":64719,"targetID":64718}},"canUndo":false,"undoCommand":"","undoCreated":-1,"canRedo":false,"redoCommand":"","redoCreated":-1,"notes":{"64713":{"id":64713,"x":-141,"y":-39,"width":513,"height":77,"text":"identify the type of baggage events and update the attributes of the events\n\nUpdate:2019-08-20","colour":"e6e63c"},"64714":{"id":64714,"x":-140,"y":85,"width":229,"height":143,"text":"baggage event data\n\nthe createdutc is used to identify new events since the last time the process ran","colour":"e6e63c"},"64715":{"id":64715,"x":429,"y":72,"width":206,"height":174,"text":"**For testing purpose, we use update/insert\n We will change this to truncate when run in production\n**\n","colour":"e6e63c"},"64716":{"id":64716,"x":187,"y":74,"width":137,"height":176,"text":"add indicators to identify the event of the record","colour":"e6e63c"}},"noteConnectors":{},"variables":{},"grids":{}},"info":{"name":"PNR - Baggage Event Extract","description":"extract the baggage data to create the events added to the pnr","type":"TRANSFORMATION"}}