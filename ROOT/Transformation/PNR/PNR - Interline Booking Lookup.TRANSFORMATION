{"job":{"components":{"64725":{"id":64725,"inputCardinality":"ZERO_OR_MANY","outputCardinality":"MANY","implementationID":-1266674941,"x":480,"y":208,"width":32,"height":32,"inputConnectorIDs":[64728],"outputConnectorIDs":[64729],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"interline booking lookup"}}}},"visible":true},"2":{"slot":2,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SELECT \n\n/*return only records that are interline bookings*/\npil.interlineflag /*will always be 1 */\n,CASE WHEN pil.interlineflag = 1 AND pil.platingcarriercode = 'PD' THEN 1\n\t\tWHEN pil.interlineflag = 1 AND pil.platingcarriercode <> 'PD' THEN 2\n        WHEN pil.interlineflag = 0 THEN 0 \n        ELSE 0\n        END AS interlinebookingtype\n,pfe.eventtype, \npfe.eventname, \npfe.eventuser, \npfe.eventdatetimeutc, \npfe.passengerid, \npfe.segmentid, \npfe.legnumber\nFROM $T{stage.pnrpassengereventcalc_src} AS pfe\nINNER JOIN stage.pnrinterlinebooking AS pil\nON pfe.pnr = pil.pnr\nAND pfe.passengerid = pil.passengerid\nWHERE EXISTS (SELECT 1 FROM stage.pnrpassengereventlist AS ppel\n\t\t\t\tWHERE pfe.pnr = ppel.pnr)"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"64726":{"id":64726,"inputCardinality":"ZERO","outputCardinality":"MANY","implementationID":1354890871,"x":272,"y":208,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[64728],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"stage.pnrpassengereventcalc_src"}}}},"visible":true},"2":{"slot":2,"name":"Table Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"pnrpassengereventcalc"}}}},"visible":true},"3":{"slot":3,"name":"Column Names","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"eventtype"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"eventname"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"eventuser"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"eventdatetimeutc"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"passengerid"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"segmentid"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"legnumber"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"flightdeparturedelayflag"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"departuredate"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"pnr"}}}},"visible":true},"4":{"slot":4,"name":"Trim Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true},"5":{"slot":5,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"stage"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"64727":{"id":64727,"inputCardinality":"ONE","outputCardinality":"ZERO","implementationID":-1848704949,"x":704,"y":208,"width":32,"height":32,"inputConnectorIDs":[64729],"outputConnectorIDs":[],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"stage.pnrpassengereventcalc"}}}},"visible":true},"2":{"slot":2,"name":"Target Table Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"pnrpassengereventcalc"}}}},"visible":true},"3":{"slot":3,"name":"Fix Data Type Mismatches","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true},"4":{"slot":4,"name":"Column Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"eventdatetimeutc"},"2":{"slot":2,"type":"STRING","value":"eventdatetimeutc"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"passengerid"},"2":{"slot":2,"type":"STRING","value":"passengerid"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"segmentid"},"2":{"slot":2,"type":"STRING","value":"segmentid"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"legnumber"},"2":{"slot":2,"type":"STRING","value":"legnumber"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"interlineflag"},"2":{"slot":2,"type":"STRING","value":"interlinebookingflag"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"interlinebookingtype"},"2":{"slot":2,"type":"STRING","value":"interlinebookingtype"}}}},"visible":true},"5":{"slot":5,"name":"Unique Keys","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"eventdatetimeutc"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"passengerid"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"segmentid"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"legnumber"}}}},"visible":true},"6":{"slot":6,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"stage"}}}},"visible":true},"7":{"slot":7,"name":"Update Strategy","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Update/Insert"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"}},"connectors":{"64728":{"id":64728,"sourceID":64726,"targetID":64725},"64729":{"id":64729,"sourceID":64725,"targetID":64727}},"canUndo":false,"undoCommand":"","undoCreated":-1,"canRedo":false,"redoCommand":"","redoCreated":-1,"notes":{"64723":{"id":64723,"x":215,"y":81,"width":513,"height":64,"text":"Identify the PNRs that are interline and update the Interlinebookingflag column\n\nupdated: 2019-09-06","colour":"e6e63c"},"64724":{"id":64724,"x":405,"y":174,"width":163,"height":143,"text":"\n\n\n\n\n\nreturn only pnrs that are interline bookings","colour":"e6e63c"}},"noteConnectors":{},"variables":{},"grids":{}},"info":{"name":"PNR - Interline Booking Lookup","description":"Identifies the PNRs that are interline","type":"TRANSFORMATION"}}