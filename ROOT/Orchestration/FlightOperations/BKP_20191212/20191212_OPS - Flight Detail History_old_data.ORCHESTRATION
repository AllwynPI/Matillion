{"job":{"components":{"42126":{"id":42126,"inputCardinality":"ZERO","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":444132438,"x":-1872,"y":-48,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[42174],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Start 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"42127":{"id":42127,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186960,"x":-1744,"y":-48,"width":32,"height":32,"inputConnectorIDs":[42174],"outputSuccessConnectorIDs":[42156],"outputFailureConnectorIDs":[42180],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Get Last change date processed"}}}},"visible":true},"2":{"slot":2,"name":"Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"###\n# Variables are directly accessible: \n###\n\ncursor = context.cursor()\n\n###effectivedatetimeutc - ultimate required\n\nSQL = \"SELECT to_char(MAX(effectivedatetimeutc),'yyyy-mm-dd hh24:mi:ss') FROM public.flightdetailhistory\"\n\n\n\ncursor.execute(SQL)\nactdt = cursor.fetchone()[0]\n\ncontext.updateVariable(\"last_changetimeutc\", str(actdt))\n\nprint \"last_changetimeutc: \" + str(last_changetimeutc)"}}}},"visible":true},"3":{"slot":3,"name":"Interpreter","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Jython"}}}},"visible":true},"4":{"slot":4,"name":"Timeout","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"42128":{"id":42128,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1896325668,"x":-336,"y":-48,"width":32,"height":32,"inputConnectorIDs":[42165],"outputSuccessConnectorIDs":[42168],"outputFailureConnectorIDs":[42176],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"OPS - FlightDetailsHistory_Load_Change"}}}},"visible":true},"2":{"slot":2,"name":"Transformation Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"OPS - FlightDetailsHistory_Load"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"42129":{"id":42129,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-741198691,"x":-560,"y":-48,"width":32,"height":32,"inputConnectorIDs":[42153],"outputSuccessConnectorIDs":[42165],"outputFailureConnectorIDs":[42181],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Extract Flight Details Changes"}}}},"visible":true},"2":{"slot":2,"name":"Database Type","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Microsoft SQL Server"}}}},"visible":true},"3":{"slot":3,"name":"Connection URL","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${db_server_url_operations}"}}}},"visible":true},"6":{"slot":6,"name":"Username","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${db_user_operations}"}}}},"visible":true},"7":{"slot":7,"name":"Password","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"PASSWORD","value":"${db_pswd_operations}"}}}},"visible":true},"8":{"slot":8,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"WITH flightdetail AS\n( SELECT \"action\",LegHashKey,ChangeTimeUTC,CarrierCode,flightnumber,flightdate,departurestation,arrivalstation,TailNum\n,UncorrectedTailNum ,DelayCode--,DepDelayCode1--,DepDelayCode2--,DepDelayCode3\n,IROPStatus, SDT,SAT, EDT, EAT,EDTC,INTime,INTime_UTC,OFFTime,OFFTime_UTC,ONTime,ONTime_UTC,OUTTime,OUTTime_UTC,STA_UTC\n,STD_UTC,ETA_UTC,ETD_UTC,ArrDelayCode1,ArrDelayTime1,ArrDelayControllable1,ArrDelayCode2,ArrDelayTime2,\nArrDelayControllable2,DepDelayCode1,DepDelayTime1,DepDelayControllable1,DepDelayCode2,DepDelayTime2,DepDelayControllable2\n,DepDelayCode3,DepDelayTime3,DepDelayControllable3,ArrOverallDelayCalcTime,ArrOverallDelayCode,\nArrOverallDelayControllable,DepOverallDelayCalcTime,DepOverallDelayCode,DepOverallDelayControllable,PairingId\nfrom  (SELECT\t/*include these columns to identify a unique record */\n\t\t\t'update' Action\n\t\t\t,A.LegHashKey\n\t\t\t,A.ChangeTimeUTC\n\t\t\t,A.ColumnName\n\t\t\t,CASE WHEN substring(A.LegHashKey,12,3)='POE' THEN 'PD' else substring(A.LegHashKey,12,3) end as CarrierCode\n\t\t\t,replace(substring(A.LegHashKey,15,4),' ','') flightnumber\n\t\t\t,substring(A.LegHashKey,1,10) flightdate\n\t\t\t,substring(A.LegHashKey,20,3) departurestation\n\t\t\t,substring(A.LegHashKey,24,3) arrivalstation\n            ,A.New --return the new value of the attribute\n    FROM dbo.FlightDetailsChanges A \n\tleft outer join \n \tdbo.FlightDetails P on (a.LegHashKey=p.LegHashKey)\n where substring(A.LegHashKey,1,9) = '2018-12-3' --and A.LegHashKey like '2018-06-01_POE 472_YTZ_YQT%'\n --ChangeTimeUTC >='2018-11-22 00:00:00' and ChangeTimeUTC <'2018-11-25 00:00:00'\n --ChangeTimeUTC >'${last_changetimeutc}'\n    --a.LegHashKey in (select distinct leghashkey from dbo.FlightDetails where ChangeTimeUTC >='${last_changetimeutc}') \n\t/*a.LegHashKey in (select distinct leghashkey from dbo.FlightDetails where leghashkey = '2019-07-12_POE 938_BOS_YTZ_1032') */\n     AND (A.ColumnName IN ('DelayCode','DepDelayCode1','DepDelayCode2','DepDelayCode3','TailNum','UncorrectedTailNum','IROPStatus', 'SDT','SAT', 'EDT', 'EAT',\n\t'EDTC','INTime','INTime_UTC','OFFTime','OFFTime_UTC','ONTime','ONTime_UTC','OUTTime','OUTTime_UTC','STA_UTC','STD_UTC','ETA_UTC','ETD_UTC','ArrDelayCode1',\n\t'ArrDelayTime1','ArrDelayControllable1','ArrDelayCode2','ArrDelayTime2','ArrDelayControllable2','DepDelayCode1','DepDelayTime1','DepDelayControllable1',\n\t'DepDelayCode2','DepDelayTime2','DepDelayControllable2','DepDelayCode3','DepDelayTime3','DepDelayControllable3','ArrOverallDelayCalcTime','ArrOverallDelayCode',\n\t'ArrOverallDelayControllable','DepOverallDelayCalcTime','DepOverallDelayCode','DepOverallDelayControllable','PairingId') or ACTION in ('INSERT','UPDATE'))\n) AS SourceTable PIVOT(MAX(New) FOR ColumnName IN \n\t--specify the columns to create\n\t(DelayCode\n\t,DepDelayCode1\n\t,DepDelayCode2\n\t,DepDelayCode3\n\t,TailNum\n\t,UncorrectedTailNum\n\t,IROPStatus\n\t,SDT\n\t,SAT\n\t,EDT\n\t,EAT\n\t,EDTC\n\t,INTime\n\t,INTime_UTC\n\t,OFFTime\n\t,OFFTime_UTC\n\t,ONTime\n\t,ONTime_UTC\n\t,OUTTime\n\t,OUTTime_UTC\n\t,STA_UTC\n\t,STD_UTC\n\t,ETA_UTC\n\t,ETD_UTC\n\t,ArrDelayCode1\n\t,ArrDelayTime1\n\t,ArrDelayControllable1\n\t,ArrDelayCode2\n\t,ArrDelayTime2\n\t,ArrDelayControllable2\n\t,DepDelayTime1\n\t,DepDelayControllable1\n\t,DepDelayTime2\n\t,DepDelayControllable2\n\t,DepDelayTime3\n\t,DepDelayControllable3\n\t,ArrOverallDelayCalcTime\n\t,ArrOverallDelayCode\n\t,ArrOverallDelayControllable\n\t,DepOverallDelayCalcTime\n\t,DepOverallDelayCode\n\t,DepOverallDelayControllable\n\t,PairingId)) as A)\n\n\nselect D.LegHashKey, D.ChangeTimeUTC, D.CarrierCode, substring(D.FlightNumber,1,50) as FlightNumber, convert(varchar,D.FlightDate,20) as FlightDate, D.departurestation, D.arrivalstation\n, ISNULL((case when max(isnull(newTailNum,'0')) over(partition by D.leghashkey) = '0' then E.TailNum else D.newTailNum end),'') as TailNum\n, ISNULL((case when max(isnull(newUncorrectedTailNum,'0')) over(partition by D.leghashkey) = '0' then E.UncorrectedTailNum else D.newUncorrectedTailNum end),'') as UncorrectedTailNum\n, ISNULL((case when max(isnull(newDelayCode,'0')) over(partition by D.leghashkey) = '0' then E.DelayCode else D.newDelayCode end),'') as DelayCode\n, ISNULL((case when max(isnull(newIROPStatus,'0')) over(partition by D.leghashkey) = '0' then E.IROPStatus else D.newIROPStatus end),'') as IROPStatus\n, ISNULL((case when max(isnull(newSDT,'0')) over(partition by D.leghashkey) = '0' then convert(varchar,E.SDT,20) else D.newSDT end),'') as SDT\n, ISNULL((case when max(isnull(newSAT,'0')) over(partition by D.leghashkey) = '0' then convert(varchar,E.SAT,20) else D.newSAT end),'') as SAT\n, ISNULL((case when max(isnull(newEDT,'0')) over(partition by D.leghashkey) = '0' then convert(varchar,E.EDT,20) else D.newEDT end),'') as EDT\n, ISNULL((case when max(isnull(newEAT,'0')) over(partition by D.leghashkey) = '0' then convert(varchar,E.EAT,20) else D.newEAT end),'') as EAT\n, ISNULL((case when max(isnull(newEDTC,'0')) over(partition by D.leghashkey) = '0' then convert(varchar,E.EDCT,20) else D.newEDTC end),'') as EDTC\n, ISNULL((case when max(isnull(newINTime,'0')) over(partition by D.leghashkey) = '0' then convert(varchar,E.INTime,20) else D.newINTime end),'') as INTime\n, ISNULL((case when max(isnull(newINTime_UTC,'0')) over(partition by D.leghashkey) = '0' then E.INTime_UTC else D.newINTime_UTC end),'') as INTime_UTC\n, ISNULL((case when max(isnull(newOFFTime,'0')) over(partition by D.leghashkey) = '0' then convert(varchar,E.OFFTime,20) else D.newOFFTime end),'') as OFFTime\n, ISNULL((case when max(isnull(newOFFTime_UTC,'0')) over(partition by D.leghashkey) = '0' then E.OFFTime_UTC else D.newOFFTime_UTC end),'') as OFFTime_UTC\n, ISNULL((case when max(isnull(newONTime,'0')) over(partition by D.leghashkey) = '0' then convert(varchar,E.ONTime,20) else D.newONTime end),'') as ONTime\n, ISNULL((case when max(isnull(newONTime_UTC,'0')) over(partition by D.leghashkey) = '0' then E.ONTime_UTC else D.newONTime_UTC end),'') as ONTime_UTC\n, ISNULL((case when max(isnull(newOUTTime,'0')) over(partition by D.leghashkey) = '0' then convert(varchar,E.OUTTime,20) else D.newOUTTime end),'') as OUTTime\n, ISNULL((case when max(isnull(newOUTTime_UTC,'0')) over(partition by D.leghashkey) = '0' then E.OUTTime_UTC else D.newOUTTime_UTC end),'') as OUTTime_UTC\n, ISNULL((case when max(isnull(newSTA_UTC,'0')) over(partition by D.leghashkey) = '0' then E.STA_UTC else D.newSTA_UTC end),'') as STA_UTC\n, ISNULL((case when max(isnull(newSTD_UTC,'0')) over(partition by D.leghashkey) = '0' then E.STD_UTC else D.newSTD_UTC end),'') as STD_UTC\n, ISNULL((case when max(isnull(newETA_UTC,'0')) over(partition by D.leghashkey) = '0' then E.ETA_UTC else D.newETA_UTC end),'') as ETA_UTC\n, ISNULL((case when max(isnull(newETD_UTC,'0')) over(partition by D.leghashkey) = '0' then E.ETD_UTC else D.newETD_UTC end),'') as ETD_UTC\n, ISNULL((case when max(isnull(newArrDelayCode1,'0')) over(partition by D.leghashkey) = '0' then E.ArrDelayCode1 else D.newArrDelayCode1 end),'') as ArrDelayCode1\n, ISNULL((case when max(isnull(newArrDelayTime1,'0')) over(partition by D.leghashkey) = '0' then cast(E.ArrDelayTime1 as varchar(50)) else D.newArrDelayTime1 end),'') as ArrDelayTime1\n, ISNULL((case when max(isnull(newArrDelayControllable1,'0')) over(partition by D.leghashkey) = '0' then IIF(E.ArrDelayControllable1=1,'1','0') else D.newArrDelayControllable1 end),'') as ArrDelayControllable1\n, ISNULL((case when max(isnull(newArrDelayCode2,'0')) over(partition by D.leghashkey) = '0' then E.ArrDelayCode2 else D.newArrDelayCode2 end),'') as ArrDelayCode2\n, ISNULL((case when max(isnull(newArrDelayTime2,'0')) over(partition by D.leghashkey) = '0' then cast(E.ArrDelayTime2 as varchar(50)) else D.newArrDelayTime2 end),'') as ArrDelayTime2\n, ISNULL((case when max(isnull(newArrDelayControllable2,'0')) over(partition by D.leghashkey) = '0' then IIF(E.ArrDelayControllable2=1,'1','0') else D.newArrDelayControllable2 end),'') as ArrDelayControllable2\n, ISNULL((case when max(isnull(newDepDelayCode1,'0')) over(partition by D.leghashkey) = '0' then E.DepDelayCode1 else D.newDepDelayCode1 end),'') as DepDelayCode1\n, ISNULL((case when max(isnull(newDepDelayTime1,'0')) over(partition by D.leghashkey) = '0' then cast(E.DepDelayTime1 as varchar(50)) else D.newDepDelayTime1 end),'') as DepDelayTime1\n, ISNULL((case when max(isnull(newDepDelayControllable1,'0')) over(partition by D.leghashkey) = '0' then IIF(E.DepDelayControllable1=1,'1','0') else D.newDepDelayControllable1 end),'') as DepDelayControllable1\n, ISNULL((case when max(isnull(newDepDelayCode2,'0')) over(partition by D.leghashkey) = '0' then E.DepDelayCode2 else D.newDepDelayCode2 end),'') as DepDelayCode2\n, ISNULL((case when max(isnull(newDepDelayTime2,'0')) over(partition by D.leghashkey) = '0' then cast(E.DepDelayTime2 as varchar(50)) else D.newDepDelayTime2 end),'') as DepDelayTime2\n, ISNULL((case when max(isnull(newDepDelayControllable2,'0')) over(partition by D.leghashkey) = '0' then IIF(E.DepDelayControllable2=1,'1','0') else D.newDepDelayControllable2 end),'') as DepDelayControllable2\n, ISNULL((case when max(isnull(newDepDelayCode3,'0')) over(partition by D.leghashkey) = '0' then E.DepDelayCode3 else D.newDepDelayCode3 end),'') as DepDelayCode3\n, ISNULL((case when max(isnull(newDepDelayTime3,'0')) over(partition by D.leghashkey) = '0' then cast(E.DepDelayTime3 as varchar(50)) else D.newDepDelayTime3 end),'') as DepDelayTime3\n, ISNULL((case when max(isnull(newDepDelayControllable3,'0')) over(partition by D.leghashkey) = '0' then IIF(E.DepDelayControllable3=1,'1','0') else D.newDepDelayControllable3 end),'') as DepDelayControllable3\n, ISNULL((case when max(isnull(newArrOverallDelayCalcTime,'0')) over(partition by D.leghashkey) = '0' then cast(E.ArrOverallDelayCalcTime as varchar(50)) else D.newArrOverallDelayCalcTime end),'') as ArrOverallDelayCalcTime\n, ISNULL((case when max(isnull(newArrOverallDelayCode,'0')) over(partition by D.leghashkey) = '0' then E.ArrOverallDelayCode else D.newArrOverallDelayCode end),'') as ArrOverallDelayCode\n, ISNULL((case when max(isnull(newArrOverallDelayControllable,'0')) over(partition by D.leghashkey) = '0' then IIF(E.ArrOverallDelayControllable=1,'1','0') else D.newArrOverallDelayControllable end),'') as ArrOverallDelayControllable\n, ISNULL((case when max(isnull(newDepOverallDelayCalcTime,'0')) over(partition by D.leghashkey) = '0' then cast(E.DepOverallDelayCalcTime as varchar(50)) else D.newDepOverallDelayCalcTime end),'') as DepOverallDelayCalcTime\n, ISNULL((case when max(isnull(newDepOverallDelayCode,'0')) over(partition by D.leghashkey) = '0' then E.DepOverallDelayCode else D.newDepOverallDelayCode end),'') as DepOverallDelayCode\n, ISNULL((case when max(isnull(newDepOverallDelayControllable,'0')) over(partition by D.leghashkey) = '0' then IIF(E.DepOverallDelayControllable=1,'1','0') else D.newDepOverallDelayControllable end),'') as DepOverallDelayControllable\n, ISNULL((case when max(isnull(newPairingId,'0')) over(partition by D.leghashkey) = '0' then E.PairingId else D.newPairingId end),'') as PairingId\nfrom\n(select C.LegHashKey, C.ChangeTimeUTC, C.CarrierCode, C.FlightNumber, C.FlightDate, C.departurestation, C.arrivalstation\n,FIRST_VALUE(C.TailNum) over(partition by C.LegHashKey, C.TailNum_grp order by C.ChangeTimeUTC) as newTailNum\n,FIRST_VALUE(C.UncorrectedTailNum) over(partition by C.LegHashKey,C.UncorrectedTailNum_grp order by C.ChangeTimeUTC) as newUncorrectedTailNum\n,FIRST_VALUE(C.DelayCode) over(partition by C.LegHashKey, C.DelayCode_grp order by C.ChangeTimeUTC) as newDelayCode\n--,FIRST_VALUE(C.DepDelayCode1) over(partition by C.DepDelayCode1_grp order by C.ChangeTimeUTC) as newDepDelayCode1\n--,FIRST_VALUE(C.DepDelayCode2) over(partition by C.DepDelayCode2_grp order by C.ChangeTimeUTC) as newDepDelayCode2\n--,FIRST_VALUE(C.DepDelayCode3) over(partition by C.DepDelayCode3_grp order by C.ChangeTimeUTC) as newDepDelayCode3\n,FIRST_VALUE(C.IROPStatus) over(partition by C.LegHashKey, C.IROPStatus_grp order by C.ChangeTimeUTC) as newIROPStatus\n,FIRST_VALUE(C.SDT) over(partition by C.LegHashKey, C.SDT_grp order by C.ChangeTimeUTC) as newSDT\n,FIRST_VALUE(C.SAT) over(partition by C.LegHashKey, C.SAT_grp order by C.ChangeTimeUTC) as newSAT\n,FIRST_VALUE(C.EDT) over(partition by C.LegHashKey, C.EDT_grp order by C.ChangeTimeUTC) as newEDT\n,FIRST_VALUE(C.EAT) over(partition by C.LegHashKey, C.EAT_grp order by C.ChangeTimeUTC) as newEAT\n,FIRST_VALUE(C.EDTC) over(partition by C.LegHashKey, C.EDTC_grp order by C.ChangeTimeUTC) as newEDTC\n,FIRST_VALUE(C.INTime) over(partition by C.LegHashKey, C.INTime_grp order by C.ChangeTimeUTC) as newINTime\n,FIRST_VALUE(C.INTime_UTC) over(partition by C.LegHashKey, C.INTime_UTC_grp order by C.ChangeTimeUTC) as newINTime_UTC\n,FIRST_VALUE(C.OFFTime) over(partition by C.LegHashKey, C.OFFTime_grp order by C.ChangeTimeUTC) as newOFFTime\n,FIRST_VALUE(C.OFFTime_UTC) over(partition by C.LegHashKey, C.OFFTime_UTC_grp order by C.ChangeTimeUTC) as newOFFTime_UTC\n,FIRST_VALUE(C.ONTime) over(partition by C.LegHashKey, C.ONTime_grp order by C.ChangeTimeUTC) as newONTime\n,FIRST_VALUE(C.ONTime_UTC) over(partition by C.LegHashKey, C.ONTime_UTC_grp order by C.ChangeTimeUTC) as newONTime_UTC\n,FIRST_VALUE(C.OUTTime) over(partition by C.LegHashKey, C.OUTTime_grp order by C.ChangeTimeUTC) as newOUTTime\n,FIRST_VALUE(C.OUTTime_UTC) over(partition by C.LegHashKey, C.OUTTime_UTC_grp order by C.ChangeTimeUTC) as newOUTTime_UTC\n,FIRST_VALUE(C.STA_UTC) over(partition by C.LegHashKey, C.STA_UTC_grp order by C.ChangeTimeUTC) as newSTA_UTC\n,FIRST_VALUE(C.STD_UTC) over(partition by C.LegHashKey, C.STD_UTC_grp order by C.ChangeTimeUTC) as newSTD_UTC\n,FIRST_VALUE(C.ETA_UTC) over(partition by C.LegHashKey, C.ETA_UTC_grp order by C.ChangeTimeUTC) as newETA_UTC\n,FIRST_VALUE(C.ETD_UTC) over(partition by C.LegHashKey, C.ETD_UTC_grp order by C.ChangeTimeUTC) as newETD_UTC\n,FIRST_VALUE(C.ArrDelayCode1) over(partition by C.LegHashKey, C.ArrDelayCode1_grp order by C.ChangeTimeUTC) as newArrDelayCode1\n,FIRST_VALUE(C.ArrDelayTime1) over(partition by C.LegHashKey, C.ArrDelayTime1_grp order by C.ChangeTimeUTC) as newArrDelayTime1\n,FIRST_VALUE(C.ArrDelayControllable1) over(partition by C.LegHashKey, C.ArrDelayControllable1_grp order by C.ChangeTimeUTC) as newArrDelayControllable1\n,FIRST_VALUE(C.ArrDelayCode2) over(partition by C.LegHashKey, C.ArrDelayCode2_grp order by C.ChangeTimeUTC) as newArrDelayCode2\n,FIRST_VALUE(C.ArrDelayTime2) over(partition by C.LegHashKey, C.ArrDelayTime2_grp order by C.ChangeTimeUTC) as newArrDelayTime2\n,FIRST_VALUE(C.ArrDelayControllable2) over(partition by C.LegHashKey, C.ArrDelayControllable2_grp order by C.ChangeTimeUTC) as newArrDelayControllable2\n,FIRST_VALUE(C.DepDelayCode1) over(partition by C.LegHashKey, C.DepDelayCode1_grp order by C.ChangeTimeUTC) as newDepDelayCode1\n,FIRST_VALUE(C.DepDelayTime1) over(partition by C.LegHashKey, C.DepDelayTime1_grp order by C.ChangeTimeUTC) as newDepDelayTime1\n,FIRST_VALUE(C.DepDelayControllable1) over(partition by C.LegHashKey, C.DepDelayControllable1_grp order by C.ChangeTimeUTC) as newDepDelayControllable1\n,FIRST_VALUE(C.DepDelayCode2) over(partition by C.LegHashKey, C.DepDelayCode2_grp order by C.ChangeTimeUTC) as newDepDelayCode2\n,FIRST_VALUE(C.DepDelayTime2) over(partition by C.LegHashKey, C.DepDelayTime2_grp order by C.ChangeTimeUTC) as newDepDelayTime2\n,FIRST_VALUE(C.DepDelayControllable2) over(partition by C.LegHashKey, C.DepDelayControllable2_grp order by C.ChangeTimeUTC) as newDepDelayControllable2\n,FIRST_VALUE(C.DepDelayCode3) over(partition by C.LegHashKey, C.DepDelayCode3_grp order by C.ChangeTimeUTC) as newDepDelayCode3\n,FIRST_VALUE(C.DepDelayTime3) over(partition by C.LegHashKey, C.DepDelayTime3_grp order by C.ChangeTimeUTC) as newDepDelayTime3\n,FIRST_VALUE(C.DepDelayControllable3) over(partition by C.LegHashKey, C.DepDelayControllable3_grp order by C.ChangeTimeUTC) as newDepDelayControllable3\n,FIRST_VALUE(C.ArrOverallDelayCalcTime) over(partition by C.LegHashKey, C.ArrOverallDelayCalcTime_grp order by C.ChangeTimeUTC) as newArrOverallDelayCalcTime\n,FIRST_VALUE(C.ArrOverallDelayCode) over(partition by C.LegHashKey, C.ArrOverallDelayCode_grp order by C.ChangeTimeUTC) as newArrOverallDelayCode\n,FIRST_VALUE(C.ArrOverallDelayControllable) over(partition by C.LegHashKey, C.ArrOverallDelayControllable_grp order by C.ChangeTimeUTC) as newArrOverallDelayControllable\n,FIRST_VALUE(C.DepOverallDelayCalcTime) over(partition by C.LegHashKey, C.DepOverallDelayCalcTime_grp order by C.ChangeTimeUTC) as newDepOverallDelayCalcTime\n,FIRST_VALUE(C.DepOverallDelayCode) over(partition by C.LegHashKey, C.DepOverallDelayCode_grp order by C.ChangeTimeUTC) as newDepOverallDelayCode\n,FIRST_VALUE(C.DepOverallDelayControllable) over(partition by C.LegHashKey, C.DepOverallDelayControllable_grp order by C.ChangeTimeUTC) as newDepOverallDelayControllable\n,FIRST_VALUE(C.PairingId) over(partition by C.LegHashKey, C.PairingId_grp order by C.ChangeTimeUTC) as newPairingId\nfrom\n(select flightdetail.*\n,sum(case when TailNum is null then 0 else 1 end) over(partition by LegHashKey order by ChangeTimeUTC) as TailNum_grp\n,sum(case when UncorrectedTailNum is null then 0 else 1 end) over(partition by LegHashKey order by ChangeTimeUTC) as UncorrectedTailNum_grp\n,sum(case when DelayCode is null then 0 else 1 end) over(partition by LegHashKey order by ChangeTimeUTC) as DelayCode_grp\n--,sum(case when DepDelayCode1 is null then 0 else 1 end) over(partition by LegHashKey order by ChangeTimeUTC) as DepDelayCode1_grp\n--,sum(case when DepDelayCode2 is null then 0 else 1 end) over(partition by LegHashKey order by ChangeTimeUTC) as DepDelayCode2_grp\n--,sum(case when DepDelayCode3 is null then 0 else 1 end) over(partition by LegHashKey order by ChangeTimeUTC) as DepDelayCode3_grp\n,sum(case when IROPStatus is null then 0 else 1 end) over(partition by LegHashKey order by ChangeTimeUTC) as IROPStatus_grp\n,sum(case when SDT is null then 0 else 1 end) over(partition by LegHashKey order by ChangeTimeUTC) as SDT_grp\n,sum(case when SAT is null then 0 else 1 end) over(partition by LegHashKey order by ChangeTimeUTC) as SAT_grp\n,sum(case when EDT is null then 0 else 1 end) over(partition by LegHashKey order by ChangeTimeUTC) as EDT_grp\n,sum(case when EAT is null then 0 else 1 end) over(partition by LegHashKey order by ChangeTimeUTC) as EAT_grp\n,sum(case when EDTC is null then 0 else 1 end) over(partition by LegHashKey order by ChangeTimeUTC) as EDTC_grp\n,sum(case when INTime is null then 0 else 1 end) over(partition by LegHashKey order by ChangeTimeUTC) as INTime_grp\n,sum(case when INTime_UTC is null then 0 else 1 end) over(partition by LegHashKey order by ChangeTimeUTC) as INTime_UTC_grp\n,sum(case when OFFTime is null then 0 else 1 end) over(partition by LegHashKey order by ChangeTimeUTC) as OFFTime_grp\n,sum(case when OFFTime_UTC is null then 0 else 1 end) over(partition by LegHashKey order by ChangeTimeUTC) as OFFTime_UTC_grp\n,sum(case when ONTime is null then 0 else 1 end) over(partition by LegHashKey order by ChangeTimeUTC) as ONTime_grp\n,sum(case when ONTime_UTC is null then 0 else 1 end) over(partition by LegHashKey order by ChangeTimeUTC) as ONTime_UTC_grp\n,sum(case when OUTTime is null then 0 else 1 end) over(partition by LegHashKey order by ChangeTimeUTC) as OUTTime_grp\n,sum(case when OUTTime_UTC is null then 0 else 1 end) over(partition by LegHashKey order by ChangeTimeUTC) as OUTTime_UTC_grp\n,sum(case when STA_UTC is null then 0 else 1 end) over(partition by LegHashKey order by ChangeTimeUTC) as STA_UTC_grp\n,sum(case when STD_UTC is null then 0 else 1 end) over(partition by LegHashKey order by ChangeTimeUTC) as STD_UTC_grp\n,sum(case when ETA_UTC is null then 0 else 1 end) over(partition by LegHashKey order by ChangeTimeUTC) as ETA_UTC_grp\n,sum(case when ETD_UTC is null then 0 else 1 end) over(partition by LegHashKey order by ChangeTimeUTC) as ETD_UTC_grp\n,sum(case when ArrDelayCode1 is null then 0 else 1 end) over(partition by LegHashKey order by ChangeTimeUTC) as ArrDelayCode1_grp\n,sum(case when ArrDelayTime1 is null then 0 else 1 end) over(partition by LegHashKey order by ChangeTimeUTC) as ArrDelayTime1_grp\n,sum(case when ArrDelayControllable1 is null then 0 else 1 end) over(partition by LegHashKey order by ChangeTimeUTC) as ArrDelayControllable1_grp\n,sum(case when ArrDelayCode2 is null then 0 else 1 end) over(partition by LegHashKey order by ChangeTimeUTC) as ArrDelayCode2_grp\n,sum(case when ArrDelayTime2 is null then 0 else 1 end) over(partition by LegHashKey order by ChangeTimeUTC) as ArrDelayTime2_grp\n,sum(case when ArrDelayControllable2 is null then 0 else 1 end) over(partition by LegHashKey order by ChangeTimeUTC) as ArrDelayControllable2_grp\n,sum(case when DepDelayCode1 is null then 0 else 1 end) over(partition by LegHashKey order by ChangeTimeUTC) as DepDelayCode1_grp\n,sum(case when DepDelayTime1 is null then 0 else 1 end) over(partition by LegHashKey order by ChangeTimeUTC) as DepDelayTime1_grp\n,sum(case when DepDelayControllable1 is null then 0 else 1 end) over(partition by LegHashKey order by ChangeTimeUTC) as DepDelayControllable1_grp\n,sum(case when DepDelayCode2 is null then 0 else 1 end) over(partition by LegHashKey order by ChangeTimeUTC) as DepDelayCode2_grp\n,sum(case when DepDelayTime2 is null then 0 else 1 end) over(partition by LegHashKey order by ChangeTimeUTC) as DepDelayTime2_grp\n,sum(case when DepDelayControllable2 is null then 0 else 1 end) over(partition by LegHashKey order by ChangeTimeUTC) as DepDelayControllable2_grp\n,sum(case when DepDelayCode3 is null then 0 else 1 end) over(partition by LegHashKey order by ChangeTimeUTC) as DepDelayCode3_grp\n,sum(case when DepDelayTime3 is null then 0 else 1 end) over(partition by LegHashKey order by ChangeTimeUTC) as DepDelayTime3_grp\n,sum(case when DepDelayControllable3 is null then 0 else 1 end) over(partition by LegHashKey order by ChangeTimeUTC) as DepDelayControllable3_grp\n,sum(case when ArrOverallDelayCalcTime is null then 0 else 1 end) over(partition by LegHashKey order by ChangeTimeUTC) as ArrOverallDelayCalcTime_grp\n,sum(case when ArrOverallDelayCode is null then 0 else 1 end) over(partition by LegHashKey order by ChangeTimeUTC) as ArrOverallDelayCode_grp\n,sum(case when ArrOverallDelayControllable is null then 0 else 1 end) over(partition by LegHashKey order by ChangeTimeUTC) as ArrOverallDelayControllable_grp\n,sum(case when DepOverallDelayCalcTime is null then 0 else 1 end) over(partition by LegHashKey order by ChangeTimeUTC) as DepOverallDelayCalcTime_grp\n,sum(case when DepOverallDelayCode is null then 0 else 1 end) over(partition by LegHashKey order by ChangeTimeUTC) as DepOverallDelayCode_grp\n,sum(case when DepOverallDelayControllable is null then 0 else 1 end) over(partition by LegHashKey order by ChangeTimeUTC) as DepOverallDelayControllable_grp\n,sum(case when PairingId is null then 0 else 1 end) over(partition by LegHashKey order by ChangeTimeUTC) as PairingId_grp\nfrom flightdetail) as C ) as D\nleft outer join\ndbo.flightdetails E\non (D.LegHashKey=E.LegHashKey)\n--where D.LegHashKey='2018-11-27_POE 389_YTZ_MDW'\norder by ChangeTimeUTC"}}}},"visible":true},"9":{"slot":9,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"flightdetailupdate1"}}}},"visible":true},"10":{"slot":10,"name":"S3 Staging Area","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"porterdatawarehouse"}}}},"visible":true},"11":{"slot":11,"name":"Connection Options","elements":{},"visible":true},"12":{"slot":12,"name":"Concurrency","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"2"}}}},"visible":true},"13":{"slot":13,"name":"Distribution Style","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Even"}}}},"visible":true},"14":{"slot":14,"name":"Distribution Key","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"15":{"slot":15,"name":"Sort Key","elements":{},"visible":true},"16":{"slot":16,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"etl"}}}},"visible":true},"17":{"slot":17,"name":"Sort Key Options","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"18":{"slot":18,"name":"Primary Key","elements":{},"visible":true},"20":{"slot":20,"name":"Data Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"96":{"slot":96,"name":"Location","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"s3://<bucket>/<path>"}}}},"visible":false},"97":{"slot":97,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"98":{"slot":98,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"99":{"slot":99,"name":"Type","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Standard"}}}},"visible":true},"101":{"slot":101,"name":"Basic/Advanced Mode","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Advanced"}}}},"visible":true},"102":{"slot":102,"name":"Data Source","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"103":{"slot":103,"name":"Data Selection","elements":{},"visible":false},"104":{"slot":104,"name":"Data Source Filter","elements":{},"visible":false},"105":{"slot":105,"name":"Combine Filters","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"And"}}}},"visible":false},"106":{"slot":106,"name":"Limit","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"100"}}}},"visible":false},"1001":{"slot":1001,"name":"","elements":{},"visible":false},"1034":{"slot":1034,"name":"Load Options","elements":{},"visible":true},"40000":{"slot":40000,"name":"Encryption","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"None"}}}},"visible":true},"40001":{"slot":40001,"name":"KMS Key ID","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"42130":{"id":42130,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-741198691,"x":-1552,"y":-48,"width":32,"height":32,"inputConnectorIDs":[42156],"outputSuccessConnectorIDs":[42172],"outputFailureConnectorIDs":[42182],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Initial Record Population"}}}},"visible":true},"2":{"slot":2,"name":"Database Type","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Microsoft SQL Server"}}}},"visible":true},"3":{"slot":3,"name":"Connection URL","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${db_server_url_operations}"}}}},"visible":true},"6":{"slot":6,"name":"Username","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${db_user_operations}"}}}},"visible":true},"7":{"slot":7,"name":"Password","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"PASSWORD","value":"${db_pswd_operations}"}}}},"visible":true},"8":{"slot":8,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"select B.action,B.LegHashKey,N.ChangeTimeUTC\n,isnull(B.CarrierCode, case when substring(B.LegHashKey,12,3)='POE' then 'PD' else substring(B.LegHashKey,12,3) end) as CarrierCode\n--,isnull(B.flightnumber, substring(B.LegHashKey,charindex(' ',B.Leghashkey,1)+1,3)) as FlightNumber\n,isnull(B.flightnumber, replace(substring(B.LegHashKey,15,4),' ','')) as FlightNumber\n,isnull(B.flightdate, substring(B.Leghashkey,1,10)) as FlightDate\n,isnull(B.departurestation,substring(B.Leghashkey,20,3)) as departurestation\n,isnull(B.arrivalstation, substring(B.Leghashkey,24,3)) as arrivalstation\n,isnull(B.TailNum, isnull(P.TailNum,'')) as Tailnum\n,isnull(B.UncorrectedTailNum, isnull(P.UncorrectedTailNum,'')) as UncorrectedTailNum\n,isnull(B.DelayCode, isnull(P.DelayCode,'')) as DelayCode\n,isnull(B.IROPStatus, isnull(P.IROPStatus,'')) as IROPStatus\n,isnull(B.SDT,isnull(convert(varchar, P.SDT, 20),'')) as SDT\n,isnull(B.SAT,isnull(convert(varchar, P.SAT, 20),'')) as SAT\n,isnull(B.EDT,isnull(convert(varchar, P.EDT, 20),'')) as EDT\n,isnull(B.EAT,isnull(convert(varchar, P.EAT, 20),'')) as EAT\n,isnull(B.EDTC,isnull(convert(varchar, P.EDCT, 20),'')) as EDTC\n,isnull(B.INTime,isnull(convert(varchar, P.INTime, 20),'')) as INTime\n,isnull(B.INTime_UTC,isnull(convert(varchar, P.INTime_UTC, 20),'')) as INTime_UTC\n,isnull(B.OFFTime,isnull(convert(varchar, P.OFFTime, 20),'')) as OFFTime\n,isnull(B.OFFTime_UTC,isnull(convert(varchar, P.OFFTime_UTC, 20),'')) as OFFTime_UTC\n,isnull(B.ONTime,isnull(convert(varchar, P.ONTime, 20),'')) as ONTime\n,isnull(B.ONTime_UTC,isnull(convert(varchar, P.ONTime_UTC, 20),'')) as ONTime_UTC\n,isnull(B.OUTTime,isnull(convert(varchar, P.OUTTime, 20),'')) as OUTTime\n,isnull(B.OUTTime_UTC,isnull(convert(varchar, P.OUTTime_UTC, 20),'')) as OUTTime_UTC\n,isnull(B.ETA_UTC,isnull(convert(varchar, P.ETA_UTC, 20),'')) as ETA_UTC\n,isnull(B.ETD_UTC,isnull(convert(varchar, P.ETD_UTC, 20),'')) as ETD_UTC\n,isnull(B.STA_UTC,isnull(convert(varchar, P.STA_UTC, 20),'')) as STA_UTC\n,isnull(B.STD_UTC,isnull(convert(varchar, P.STD_UTC, 20),'')) as STD_UTC\n,isnull(B.ArrDelayCode1,isnull(P.ArrDelayCode1,'')) as ArrDelayCode1\n,isnull(B.ArrDelayTime1,isnull(P.ArrDelayTime1,'')) as ArrDelayTime1\n,isnull(B.ArrDelayControllable1,isnull(P.ArrDelayControllable1,'')) as ArrDelayControllable1\n,isnull(B.ArrDelayCode2,isnull(P.ArrDelayCode2,'')) as ArrDelayCode2\n,isnull(B.ArrDelayTime2,isnull(P.ArrDelayTime2,'')) as ArrDelayTime2\n,isnull(B.ArrDelayControllable2,isnull(P.ArrDelayControllable2,'')) as ArrDelayControllable2\n,isnull(B.DepDelayCode1,isnull(P.DepDelayCode1,'')) as DepDelayCode1\n,isnull(B.DepDelayTime1,isnull(P.DepDelayTime1,'')) as DepDelayTime1\n,isnull(B.DepDelayControllable1,isnull(P.DepDelayControllable1,'')) as DepDelayControllable1\n,isnull(B.DepDelayCode2,isnull(P.DepDelayCode2,'')) as DepDelayCode2\n,isnull(B.DepDelayTime2,isnull(P.DepDelayTime2,'')) as DepDelayTime2\n,isnull(B.DepDelayControllable2,isnull(P.DepDelayControllable2,'')) as DepDelayControllable2\n,isnull(B.DepDelayCode3,isnull(P.DepDelayCode3,'')) as DepDelayCode3\n,isnull(B.DepDelayTime3,isnull(P.DepDelayTime3,'')) as DepDelayTime3\n,isnull(B.DepDelayControllable3,isnull(P.DepDelayControllable3,'')) as DepDelayControllable3\n,isnull(B.ArrOverallDelayCalcTime,isnull(P.ArrOverallDelayCalcTime,'')) as ArrOverallDelayCalcTime\n,isnull(B.ArrOverallDelayCode,isnull(P.ArrOverallDelayCode,'')) as ArrOverallDelayCode\n,isnull(B.ArrOverallDelayControllable,isnull(P.ArrOverallDelayControllable,'')) as ArrOverallDelayControllable\n,isnull(B.DepOverallDelayCalcTime,isnull(P.DepOverallDelayCalcTime,'')) as DepOverallDelayCalcTime\n,isnull(B.DepOverallDelayCode,isnull(P.DepOverallDelayCode,'')) as DepOverallDelayCode\n,isnull(B.DepOverallDelayControllable,isnull(P.DepOverallDelayControllable,'')) as DepOverallDelayControllable\n,isnull(B.PairingId,isnull(P.PairingId,'')) as PairingId\nfrom\n(select * from \n\t(SELECT\t/*include these columns to identify a unique record */\n\t\t\t'update' Action\n\t\t\t,A.LegHashKey\n\t\t\t--,A.ChangeTimeUTC\n\t\t\t,A.ColumnName\n\t\t\t--,substring(A.LegHashKey,12,3)='POE' THEN 'PD' else 'NA' end as CarrierCode\n\t\t\t,CASE WHEN P.CarrierCode='POE' THEN 'PD' else P.CarrierCode end as CarrierCode\n\t\t\t--,Y. registrationnumber\n\t\t\t--,substring(A.LegHashKey,charindex(' ',P.FltNum)+1,LEN(P.FltNum)) flightnumber\n\t\t\t,substring(P.FltNum,charindex(' ',P.FltNum)+1,LEN(P.FltNum))  flightnumber\n\t\t\t,P.FltDate flightdate\n\t\t\t,P.DepAirport departurestation\n\t\t\t,P.ArrAirport arrivalstation\n            ,A.Old\n\tfrom \n\t(select * from\n\t(select ChangetimeUTC, \n\tLegHashKey, Action, ColumnName, isnull(Old,'') Old, rank() over (partition by LegHashKey, ColumnName order by ChangeTimeUTC asc) RANK_\n\tfrom dbo.FlightDetailsChanges\n\twhere substring(LegHashKey,1,9)='2019-10-2'\n    --LegHashKey in (select distinct leghashkey from dbo.FlightDetails where ChangeTimeUTC >='${last_changetimeutc}')  \n     /*LegHashKey in (select distinct leghashkey from dbo.FlightDetails where leghashkey = '2019-07-12_POE 938_BOS_YTZ_1032') */ \n\tand (ColumnName IN ('DelayCode','DepDelayCode1','DepDelayCode2','DepDelayCode3','TailNum','UncorrectedTailNum','IROPStatus', 'SDT','SAT', 'EDT', 'EAT',\n\t'EDTC','INTime','INTime_UTC','OFFTime','OFFTime_UTC','ONTime','ONTime_UTC','OUTTime','OUTTime_UTC','STA_UTC','STD_UTC','ETA_UTC','ETD_UTC','ArrDelayCode1',\n\t'ArrDelayTime1','ArrDelayControllable1','ArrDelayCode2','ArrDelayTime2','ArrDelayControllable2','DepDelayCode1','DepDelayTime1','DepDelayControllable1',\n\t'DepDelayCode2','DepDelayTime2','DepDelayControllable2','DepDelayCode3','DepDelayTime3','DepDelayControllable3','ArrOverallDelayCalcTime','ArrOverallDelayCode',\n\t'ArrOverallDelayControllable','DepOverallDelayCalcTime','DepOverallDelayCode','DepOverallDelayControllable','PairingId') or ACTION in ('INSERT','UPDATE'))) A\n\twhere RANK_=1) A\nleft outer join dbo.FlightDetails P on (a.LegHashKey=p.LegHashKey))\n AS SourceTable PIVOT(max(old) FOR ColumnName IN \n\t--specify the columns to create\n\t(DelayCode\n\t,DepDelayCode1\n\t,DepDelayCode2\n\t,DepDelayCode3\n\t,TailNum\n\t,UncorrectedTailNum\n\t,IROPStatus\n\t,SDT\n\t,SAT\n\t,EDT\n\t,EAT\n\t,EDTC\n\t,INTime\n\t,INTime_UTC\n\t,OFFTime\n\t,OFFTime_UTC\n\t,ONTime\n\t,ONTime_UTC\n\t,OUTTime\n\t,OUTTime_UTC\n\t,STA_UTC\n\t,STD_UTC\n\t,ETA_UTC\n\t,ETD_UTC\n\t,ArrDelayCode1\n\t,ArrDelayTime1\n\t,ArrDelayControllable1\n\t,ArrDelayCode2\n\t,ArrDelayTime2\n\t,ArrDelayControllable2\n\t,DepDelayTime1\n\t,DepDelayControllable1\n\t,DepDelayTime2\n\t,DepDelayControllable2\n\t,DepDelayTime3\n\t,DepDelayControllable3\n\t,ArrOverallDelayCalcTime\n\t,ArrOverallDelayCode\n\t,ArrOverallDelayControllable\n\t,DepOverallDelayCalcTime\n\t,DepOverallDelayCode\n\t,DepOverallDelayControllable\n\t,PairingId) ) AS flightdetailupdate) as B\n\tleft outer join dbo.flightdetails as P on (B.LegHashKey=P.LegHashKey)\n\tinner join dbo.FlightDetailsChanges N\n\ton (B.LegHashKey=N.LegHashKey)"}}}},"visible":true},"9":{"slot":9,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"flightdetailupdate1"}}}},"visible":true},"10":{"slot":10,"name":"S3 Staging Area","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"porterdatawarehouse"}}}},"visible":true},"11":{"slot":11,"name":"Connection Options","elements":{},"visible":true},"12":{"slot":12,"name":"Concurrency","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"2"}}}},"visible":true},"13":{"slot":13,"name":"Distribution Style","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Even"}}}},"visible":true},"14":{"slot":14,"name":"Distribution Key","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"15":{"slot":15,"name":"Sort Key","elements":{},"visible":true},"16":{"slot":16,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"etl"}}}},"visible":true},"17":{"slot":17,"name":"Sort Key Options","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"18":{"slot":18,"name":"Primary Key","elements":{},"visible":true},"20":{"slot":20,"name":"Data Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"96":{"slot":96,"name":"Location","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"s3://<bucket>/<path>"}}}},"visible":false},"97":{"slot":97,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"98":{"slot":98,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"99":{"slot":99,"name":"Type","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Standard"}}}},"visible":true},"101":{"slot":101,"name":"Basic/Advanced Mode","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Advanced"}}}},"visible":true},"102":{"slot":102,"name":"Data Source","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"103":{"slot":103,"name":"Data Selection","elements":{},"visible":false},"104":{"slot":104,"name":"Data Source Filter","elements":{},"visible":false},"105":{"slot":105,"name":"Combine Filters","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"And"}}}},"visible":false},"106":{"slot":106,"name":"Limit","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"100"}}}},"visible":false},"1001":{"slot":1001,"name":"","elements":{},"visible":false},"1034":{"slot":1034,"name":"Load Options","elements":{},"visible":true},"40000":{"slot":40000,"name":"Encryption","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"None"}}}},"visible":true},"40001":{"slot":40001,"name":"KMS Key ID","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"42131":{"id":42131,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1896325668,"x":160,"y":-32,"width":32,"height":32,"inputConnectorIDs":[42158],"outputSuccessConnectorIDs":[42152],"outputFailureConnectorIDs":[42179],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"OPS - FlightDetailsHistoryExpiredDateUpdate_Load_Change"}}}},"visible":true},"2":{"slot":2,"name":"Transformation Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"OPS - FlightDetailsHistoryExpiredDateUpdate_Load"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"42132":{"id":42132,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1896325668,"x":208,"y":-176,"width":32,"height":32,"inputConnectorIDs":[42152],"outputSuccessConnectorIDs":[42164],"outputFailureConnectorIDs":[42178],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"OPS - FlightDetailsHistoryActiveFlagUpdate_Load_Change"}}}},"visible":true},"2":{"slot":2,"name":"Transformation Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"OPS - FlightDetailsHistoryActiveFlagUpdate_Load"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{},"visible":true}},"expectedFailure":null,"activationStatus":"DISABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"42133":{"id":42133,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1896325668,"x":-1376,"y":-48,"width":32,"height":32,"inputConnectorIDs":[42172],"outputSuccessConnectorIDs":[42166],"outputFailureConnectorIDs":[42184],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"OPS - FlightDetailsHistory_Load_Initial"}}}},"visible":true},"2":{"slot":2,"name":"Transformation Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"OPS - FlightDetailsHistory_Load"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"42134":{"id":42134,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1896325668,"x":-880,"y":-32,"width":32,"height":32,"inputConnectorIDs":[42162],"outputSuccessConnectorIDs":[42154],"outputFailureConnectorIDs":[42177],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"OPS - FlightDetailsHistoryExpiredDateUpdate_Load_Initial"}}}},"visible":true},"2":{"slot":2,"name":"Transformation Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"OPS - FlightDetailsHistoryExpiredDateUpdate_Load"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"42135":{"id":42135,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1896325668,"x":-832,"y":-144,"width":32,"height":32,"inputConnectorIDs":[42154],"outputSuccessConnectorIDs":[42153],"outputFailureConnectorIDs":[42183],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"OPS - FlightDetailsHistoryActiveFlagUpdate_Load_Initial"}}}},"visible":true},"2":{"slot":2,"name":"Transformation Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"OPS - FlightDetailsHistoryActiveFlagUpdate_Load"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{},"visible":true}},"expectedFailure":null,"activationStatus":"DISABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"42136":{"id":42136,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":515156205,"x":-432,"y":320,"width":32,"height":32,"inputConnectorIDs":[42157],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Failure 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"42137":{"id":42137,"inputCardinality":"MANY","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":-1343684451,"x":-1104,"y":336,"width":32,"height":32,"inputConnectorIDs":[42160,42161,42163,42167,42169,42170,42155,42171,42159],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[42175],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Or 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"42138":{"id":42138,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":438858066,"x":-1744,"y":112,"width":32,"height":32,"inputConnectorIDs":[42180],"outputSuccessConnectorIDs":[42160],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SNS Message 0"}}}},"visible":true},"2":{"slot":2,"name":"AWS Region","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"us-east-1"}}}},"visible":true},"3":{"slot":3,"name":"Topic Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"DW_ETL"}}}},"visible":true},"4":{"slot":4,"name":"Subject","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${job_name} - Job Failed"}}}},"visible":true},"5":{"slot":5,"name":"Message","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Environment: ${environment_name}\n\nJob failed: ${job_name}\n\nError Message: ${Errormessage}\n\nPlease check the database connection to \"Operations DB\" or check the component in the job"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"DISABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"42139":{"id":42139,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":438858066,"x":-1552,"y":112,"width":32,"height":32,"inputConnectorIDs":[42182],"outputSuccessConnectorIDs":[42171],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Initial Record Population Error"}}}},"visible":true},"2":{"slot":2,"name":"AWS Region","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"us-east-1"}}}},"visible":true},"3":{"slot":3,"name":"Topic Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"DW_ETL"}}}},"visible":true},"4":{"slot":4,"name":"Subject","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${job_name} - Job Failed"}}}},"visible":true},"5":{"slot":5,"name":"Message","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Environment: ${environment_name}\n\nJob failed: ${job_name}\n\nError Message: ${Errormessage}\n\nPlease check the database connection to \"Operations DB\" or check the Query in \"Initial record Population\" object"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"DISABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"42140":{"id":42140,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":438858066,"x":-1376,"y":112,"width":32,"height":32,"inputConnectorIDs":[42184],"outputSuccessConnectorIDs":[42170],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"FlightDetailHistory_Load_initial ERROR"}}}},"visible":true},"2":{"slot":2,"name":"AWS Region","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"us-east-1"}}}},"visible":true},"3":{"slot":3,"name":"Topic Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"DW_ETL"}}}},"visible":true},"4":{"slot":4,"name":"Subject","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${job_name} - Job Failed"}}}},"visible":true},"5":{"slot":5,"name":"Message","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Environment: ${environment_name}\n\nJob failed: ${job_name}\n\nError Message: ${Errormessage}\n\nPlease check the database connection to \"Operations DB\" or check the Query in \"Initial record Population\" object"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"DISABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"42141":{"id":42141,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":-1946388514,"x":592,"y":-48,"width":32,"height":32,"inputConnectorIDs":[42173],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Success 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"42142":{"id":42142,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":438858066,"x":-1024,"y":112,"width":32,"height":32,"inputConnectorIDs":[42177],"outputSuccessConnectorIDs":[42161],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"FlightDetailsHistoryExpiredDateUpdate_Load_Initial Error"}}}},"visible":true},"2":{"slot":2,"name":"AWS Region","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"us-east-1"}}}},"visible":true},"3":{"slot":3,"name":"Topic Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"DW_ETL"}}}},"visible":true},"4":{"slot":4,"name":"Subject","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${job_name} - Job Failed"}}}},"visible":true},"5":{"slot":5,"name":"Message","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Environment: ${environment_name}\n\nJob failed: ${job_name}\n\nError Message: ${Errormessage}\n\nPlease check the database connection to \"Operations DB\" or check the Query in \"Initial record Population\" object"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"DISABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"42143":{"id":42143,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":438858066,"x":-800,"y":112,"width":32,"height":32,"inputConnectorIDs":[42183],"outputSuccessConnectorIDs":[42163],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"FlightDetailsHistoryActiveFlagUpdate_Load_Initial Error"}}}},"visible":true},"2":{"slot":2,"name":"AWS Region","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"us-east-1"}}}},"visible":true},"3":{"slot":3,"name":"Topic Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"DW_ETL"}}}},"visible":true},"4":{"slot":4,"name":"Subject","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${job_name} - Job Failed"}}}},"visible":true},"5":{"slot":5,"name":"Message","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Environment: ${environment_name}\n\nJob failed: ${job_name}\n\nError Message: ${Errormessage}\n\nPlease check the database connection to \"Operations DB\" or check the Query in \"Initial record Population\" object"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"DISABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"42144":{"id":42144,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":438858066,"x":-560,"y":112,"width":32,"height":32,"inputConnectorIDs":[42181],"outputSuccessConnectorIDs":[42159],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Extract Flight Details Changes Error"}}}},"visible":true},"2":{"slot":2,"name":"AWS Region","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"us-east-1"}}}},"visible":true},"3":{"slot":3,"name":"Topic Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"DW_ETL"}}}},"visible":true},"4":{"slot":4,"name":"Subject","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${job_name} - Job Failed"}}}},"visible":true},"5":{"slot":5,"name":"Message","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Environment: ${environment_name}\n\nJob failed: ${job_name}\n\nError Message: ${Errormessage}\n\nPlease check the database connection to \"Operations DB\" or check the Query in \"Initial record Population\" object"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"DISABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"42145":{"id":42145,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":438858066,"x":-336,"y":112,"width":32,"height":32,"inputConnectorIDs":[42176],"outputSuccessConnectorIDs":[42167],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"FlightDetailsHistory_Load_Change Error"}}}},"visible":true},"2":{"slot":2,"name":"AWS Region","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"us-east-1"}}}},"visible":true},"3":{"slot":3,"name":"Topic Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"DW_ETL"}}}},"visible":true},"4":{"slot":4,"name":"Subject","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${job_name} - Job Failed"}}}},"visible":true},"5":{"slot":5,"name":"Message","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Environment: ${environment_name}\n\nJob failed: ${job_name}\n\nError Message: ${Errormessage}\n\nPlease check the database connection to \"Operations DB\" or check the Query in \"Initial record Population\" object"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"DISABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"42146":{"id":42146,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":438858066,"x":-96,"y":112,"width":32,"height":32,"inputConnectorIDs":[42179],"outputSuccessConnectorIDs":[42155],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"FlightDetailsHistoryExpiredDateUpdate_Load_Change Error"}}}},"visible":true},"2":{"slot":2,"name":"AWS Region","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"us-east-1"}}}},"visible":true},"3":{"slot":3,"name":"Topic Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"DW_ETL"}}}},"visible":true},"4":{"slot":4,"name":"Subject","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${job_name} - Job Failed"}}}},"visible":true},"5":{"slot":5,"name":"Message","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Environment: ${environment_name}\n\nJob failed: ${job_name}\n\nError Message: ${Errormessage}\n\nPlease check the database connection to \"Operations DB\" or check the Query in \"Initial record Population\" object"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"DISABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"42147":{"id":42147,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":438858066,"x":224,"y":112,"width":32,"height":32,"inputConnectorIDs":[42178],"outputSuccessConnectorIDs":[42169],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"FlightDetailsHistoryActiveFlagUpdate_Load_Change Error"}}}},"visible":true},"2":{"slot":2,"name":"AWS Region","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"us-east-1"}}}},"visible":true},"3":{"slot":3,"name":"Topic Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"DW_ETL"}}}},"visible":true},"4":{"slot":4,"name":"Subject","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${job_name} - Job Failed"}}}},"visible":true},"5":{"slot":5,"name":"Message","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Environment: ${environment_name}\n\nJob failed: ${job_name}\n\nError Message: ${Errormessage}\n\nPlease check the database connection to \"Operations DB\" or check the Query in \"Initial record Population\" object"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"DISABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"42148":{"id":42148,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":438858066,"x":-752,"y":320,"width":32,"height":32,"inputConnectorIDs":[42175],"outputSuccessConnectorIDs":[42157],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SNS Message 1"}}}},"visible":true},"2":{"slot":2,"name":"AWS Region","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"us-east-1"}}}},"visible":true},"3":{"slot":3,"name":"Topic Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"DW_ETL"}}}},"visible":true},"4":{"slot":4,"name":"Subject","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${job_name} - Job Failed"}}}},"visible":true},"5":{"slot":5,"name":"Message","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Environment: ${environment_name}\n\nJob failed: ${job_name}\n\nError Message: ${Errormessage}"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"DISABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"42149":{"id":42149,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":438858066,"x":432,"y":-48,"width":32,"height":32,"inputConnectorIDs":[42164],"outputSuccessConnectorIDs":[42173],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SNS Message 2"}}}},"visible":true},"2":{"slot":2,"name":"AWS Region","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"us-east-1"}}}},"visible":true},"3":{"slot":3,"name":"Topic Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"DW_ETL"}}}},"visible":true},"4":{"slot":4,"name":"Subject","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${job_name} Completed"}}}},"visible":true},"5":{"slot":5,"name":"Message","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Environment: ${environment_name}\n\nJob: ${job_name}\n"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"DISABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"42150":{"id":42150,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1896325668,"x":-1120,"y":-64,"width":32,"height":32,"inputConnectorIDs":[42166],"outputSuccessConnectorIDs":[42162],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"OPS - FlightDetailsHistoryActiveFlagUpdate_Load_Initial_new"}}}},"visible":true},"2":{"slot":2,"name":"Transformation Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"OPS - FlightDetailsHistoryActiveFlagUpdate_Load"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"42151":{"id":42151,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1896325668,"x":-64,"y":-64,"width":32,"height":32,"inputConnectorIDs":[42168],"outputSuccessConnectorIDs":[42158],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Copy of OPS - FlightDetailsHistoryActiveFlagUpdate_Load_Change"}}}},"visible":true},"2":{"slot":2,"name":"Transformation Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"OPS - FlightDetailsHistoryActiveFlagUpdate_Load"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]}},"successConnectors":{"42152":{"id":42152,"sourceID":42131,"targetID":42132},"42153":{"id":42153,"sourceID":42135,"targetID":42129},"42154":{"id":42154,"sourceID":42134,"targetID":42135},"42155":{"id":42155,"sourceID":42146,"targetID":42137},"42156":{"id":42156,"sourceID":42127,"targetID":42130},"42157":{"id":42157,"sourceID":42148,"targetID":42136},"42158":{"id":42158,"sourceID":42151,"targetID":42131},"42159":{"id":42159,"sourceID":42144,"targetID":42137},"42160":{"id":42160,"sourceID":42138,"targetID":42137},"42161":{"id":42161,"sourceID":42142,"targetID":42137},"42162":{"id":42162,"sourceID":42150,"targetID":42134},"42163":{"id":42163,"sourceID":42143,"targetID":42137},"42164":{"id":42164,"sourceID":42132,"targetID":42149},"42165":{"id":42165,"sourceID":42129,"targetID":42128},"42166":{"id":42166,"sourceID":42133,"targetID":42150},"42167":{"id":42167,"sourceID":42145,"targetID":42137},"42168":{"id":42168,"sourceID":42128,"targetID":42151},"42169":{"id":42169,"sourceID":42147,"targetID":42137},"42170":{"id":42170,"sourceID":42140,"targetID":42137},"42171":{"id":42171,"sourceID":42139,"targetID":42137},"42172":{"id":42172,"sourceID":42130,"targetID":42133},"42173":{"id":42173,"sourceID":42149,"targetID":42141}},"failureConnectors":{"42176":{"id":42176,"sourceID":42128,"targetID":42145},"42177":{"id":42177,"sourceID":42134,"targetID":42142},"42178":{"id":42178,"sourceID":42132,"targetID":42147},"42179":{"id":42179,"sourceID":42131,"targetID":42146},"42180":{"id":42180,"sourceID":42127,"targetID":42138},"42181":{"id":42181,"sourceID":42129,"targetID":42144},"42182":{"id":42182,"sourceID":42130,"targetID":42139},"42183":{"id":42183,"sourceID":42135,"targetID":42143},"42184":{"id":42184,"sourceID":42133,"targetID":42140}},"unconditionalConnectors":{"42174":{"id":42174,"sourceID":42126,"targetID":42127},"42175":{"id":42175,"sourceID":42137,"targetID":42148}},"trueConnectors":{},"falseConnectors":{},"iterationConnectors":{},"noteConnectors":{},"canUndo":true,"undoCommand":"Rename Job","undoCreated":1571692511602,"canRedo":false,"redoCommand":"","redoCreated":-1,"notes":{"42123":{"id":42123,"x":-1887,"y":-204,"width":263,"height":68,"text":"Load the flight detail history\n\nupdated:2019-10-01","colour":"e6e63c"},"42124":{"id":42124,"x":-1629,"y":-101,"width":925,"height":122,"text":"**Load initial flight record**","colour":"e6e63c"},"42125":{"id":42125,"x":-636,"y":-98,"width":1001,"height":129,"text":"**Load additional flight record changes**","colour":"e6e63c"}},"variables":{"last_changetimeutc":{"definition":{"name":"last_changetimeutc","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"1900-01-01"},"last_flighttimeutc":{"definition":{"name":"last_flighttimeutc","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"1900-01-01"}},"grids":{}},"info":{"name":"20191212_OPS - Flight Detail History_old_data","description":"Inserts and updates records into the flightdetailhistory table","type":"ORCHESTRATION"}}