{"job":{"components":{"64310":{"id":64310,"inputCardinality":"ZERO","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":444132438,"x":-736,"y":16,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[64335],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Start 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"64311":{"id":64311,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1896325668,"x":-592,"y":128,"width":32,"height":32,"inputConnectorIDs":[64330],"outputSuccessConnectorIDs":[64324],"outputFailureConnectorIDs":[64337],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{"1":{"slot":1,"fromId":null,"fromName":"Component","mapTo":"ErrorComponent"}},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"PNR - Ops Flight Arrival Event"}}}},"visible":true},"2":{"slot":2,"name":"Transformation Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"PNR - Ops Flight Arrival Event"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"maxflightarrivaleventdatetime"},"2":{"slot":2,"type":"STRING","value":"${maxflightarrivaleventdatetime}"}}}},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"64312":{"id":64312,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":-1946388514,"x":688,"y":80,"width":32,"height":32,"inputConnectorIDs":[64332],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Success 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"64313":{"id":64313,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":515156205,"x":192,"y":272,"width":32,"height":32,"inputConnectorIDs":[64331],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Failure 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"64314":{"id":64314,"inputCardinality":"MANY","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":-1343684451,"x":-288,"y":272,"width":32,"height":32,"inputConnectorIDs":[64336,64337,64338,64339,64340,64341,64342,64343],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[64334],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Or 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"64315":{"id":64315,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":438858066,"x":-16,"y":272,"width":32,"height":32,"inputConnectorIDs":[64334],"outputSuccessConnectorIDs":[64331],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"process failed"}}}},"visible":true},"2":{"slot":2,"name":"AWS Region","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"us-east-1"}}}},"visible":true},"3":{"slot":3,"name":"Topic Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"DW_ETL"}}}},"visible":true},"4":{"slot":4,"name":"Subject","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${job_name} Failed"}}}},"visible":true},"5":{"slot":5,"name":"Message","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Environment: ${environment_name}\n\nJob failed: ${job_name}\nComponent: ${ErrorComponent}\n\nError Message: ${Errormessage}"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"64316":{"id":64316,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1785813072,"x":384,"y":112,"width":32,"height":32,"inputConnectorIDs":[64325],"outputSuccessConnectorIDs":[64327],"outputFailureConnectorIDs":[64338],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"PNR - Passenger Events Process"}}}},"visible":true},"2":{"slot":2,"name":"Orchestration Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"PNR - Passenger Events Process"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"64317":{"id":64317,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186960,"x":-592,"y":16,"width":32,"height":32,"inputConnectorIDs":[64335],"outputSuccessConnectorIDs":[64330],"outputFailureConnectorIDs":[64343],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"max arrival eventdatetimeutc"}}}},"visible":true},"2":{"slot":2,"name":"Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"###\n# retrieve the latest flight arrival event date from the pnr flight history table\n###\ncursor = context.cursor()\n\n###### check the time for FLIGHT Arrival events\n\n#cursor.execute( \"SELECT TO_CHAR(ISNULL(MAX(eventdatetimeutc),getdate()),'YYYY-MM-DD HH:MI:SS') FROM public.flighteventhistory  WHERE eventname IN ('ARRIVAL')\" )\ncursor.execute( \"SELECT TO_CHAR(ISNULL(MAX(eventdatetimeutc),getdate()),'YYYY-MM-DD HH24:MI:SS') FROM public.pnrpassengerhistory  WHERE eventname IN ('FLIGHT ARRIVAL')\" )\nflight_arrival_time = cursor.fetchone()[0]\n\ncontext.updateVariable(\"maxflightarrivaleventdatetime\", str(flight_arrival_time))\n\nprint 'maxflightarrivaleventdatetime: ' + str(maxflightarrivaleventdatetime)"}}}},"visible":true},"3":{"slot":3,"name":"Interpreter","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Jython"}}}},"visible":true},"4":{"slot":4,"name":"Timeout","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"64318":{"id":64318,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":438858066,"x":560,"y":80,"width":32,"height":32,"inputConnectorIDs":[64327],"outputSuccessConnectorIDs":[64332],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"process successful"}}}},"visible":true},"2":{"slot":2,"name":"AWS Region","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"us-east-1"}}}},"visible":true},"3":{"slot":3,"name":"Topic Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"DW_ETL"}}}},"visible":true},"4":{"slot":4,"name":"Subject","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${job_name} Completed"}}}},"visible":true},"5":{"slot":5,"name":"Message","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Environment: ${environment_name}\n\n${job_name} - Job Completed\n"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"64319":{"id":64319,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1896325668,"x":-320,"y":128,"width":32,"height":32,"inputConnectorIDs":[64328],"outputSuccessConnectorIDs":[64333],"outputFailureConnectorIDs":[64339],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"PNR - Ops Flight Cancel Events"}}}},"visible":true},"2":{"slot":2,"name":"Transformation Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"PNR - Ops Flight Cancel Events"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"maxflightcanceleventdatetime"},"2":{"slot":2,"type":"STRING","value":"${maxflightcanceleventdatetime}"}}}},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"64320":{"id":64320,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1896325668,"x":-64,"y":128,"width":32,"height":32,"inputConnectorIDs":[64326],"outputSuccessConnectorIDs":[64329],"outputFailureConnectorIDs":[64342],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"PNR - PNR Flight ETD ETA Events"}}}},"visible":true},"2":{"slot":2,"name":"Transformation Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"PNR - PNR Flight ETD ETA Events"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"maxflightetaeventdatetime"},"2":{"slot":2,"type":"STRING","value":"${maxflightetaeventdatetime}"}}}},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"64321":{"id":64321,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186960,"x":-320,"y":16,"width":32,"height":32,"inputConnectorIDs":[64324],"outputSuccessConnectorIDs":[64328],"outputFailureConnectorIDs":[64340],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"max cancel eventdatetimeutc"}}}},"visible":true},"2":{"slot":2,"name":"Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"###\n# retrieve the latest event date from the pnr flight history table\n###\ncursor = context.cursor()\ncursor.execute(\"SELECT ISNULL(MAX(eventdatetimeutc),getdate()) FROM public.pnrpassengerhistory WHERE eventname IN ('FLIGHT CANCEL')\")\n\nresult = cursor.fetchone()[0]\n#result = '2019-06-20 19:00:00'\ncontext.updateVariable(\"maxflightcanceleventdatetime\", str(result))\n\nprint 'flight maxflightcanceleventdatetime: ' + str(maxflightcanceleventdatetime)"}}}},"visible":true},"3":{"slot":3,"name":"Interpreter","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Jython"}}}},"visible":true},"4":{"slot":4,"name":"Timeout","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"64322":{"id":64322,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186960,"x":-64,"y":16,"width":32,"height":32,"inputConnectorIDs":[64333],"outputSuccessConnectorIDs":[64326],"outputFailureConnectorIDs":[64336],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"max delay eventdatetimeutc"}}}},"visible":true},"2":{"slot":2,"name":"Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"###\n# retrieve the latest event date from the pnr flight history table\n###\ncursor = context.cursor()\ncursor.execute(\"SELECT ISNULL(MAX(eventdatetimeutc)-1,getdate()) FROM public.pnrpassengerhistory WHERE eventname IN ('FLIGHT ETA CHANGE', 'FLIGHT ETD CHANGE','FLIGHT ETD/ETA CHANGE')\")\n\nresult = cursor.fetchone()[0]\n#result = '2019-06-20 19:00:00'\ncontext.updateVariable(\"maxflightetaeventdatetime\", str(result))\n\nprint 'flight ETA/ETD change maxflightetaeventdatetime: ' + str(maxflightetaeventdatetime)"}}}},"visible":true},"3":{"slot":3,"name":"Interpreter","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Jython"}}}},"visible":true},"4":{"slot":4,"name":"Timeout","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"64323":{"id":64323,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1896325668,"x":224,"y":64,"width":32,"height":32,"inputConnectorIDs":[64329],"outputSuccessConnectorIDs":[64325],"outputFailureConnectorIDs":[64341],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"PNR - Load Passenger List New Flight Ops"}}}},"visible":true},"2":{"slot":2,"name":"Transformation Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"PNR - Load Passenger List New Flight Ops"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]}},"successConnectors":{"64324":{"id":64324,"sourceID":64311,"targetID":64321},"64325":{"id":64325,"sourceID":64323,"targetID":64316},"64326":{"id":64326,"sourceID":64322,"targetID":64320},"64327":{"id":64327,"sourceID":64316,"targetID":64318},"64328":{"id":64328,"sourceID":64321,"targetID":64319},"64329":{"id":64329,"sourceID":64320,"targetID":64323},"64330":{"id":64330,"sourceID":64317,"targetID":64311},"64331":{"id":64331,"sourceID":64315,"targetID":64313},"64332":{"id":64332,"sourceID":64318,"targetID":64312},"64333":{"id":64333,"sourceID":64319,"targetID":64322}},"failureConnectors":{"64336":{"id":64336,"sourceID":64322,"targetID":64314},"64337":{"id":64337,"sourceID":64311,"targetID":64314},"64338":{"id":64338,"sourceID":64316,"targetID":64314},"64339":{"id":64339,"sourceID":64319,"targetID":64314},"64340":{"id":64340,"sourceID":64321,"targetID":64314},"64341":{"id":64341,"sourceID":64323,"targetID":64314},"64342":{"id":64342,"sourceID":64320,"targetID":64314},"64343":{"id":64343,"sourceID":64317,"targetID":64314}},"unconditionalConnectors":{"64334":{"id":64334,"sourceID":64314,"targetID":64315},"64335":{"id":64335,"sourceID":64310,"targetID":64317}},"trueConnectors":{},"falseConnectors":{},"iterationConnectors":{},"noteConnectors":{},"canUndo":false,"undoCommand":"","undoCreated":-1,"canRedo":false,"redoCommand":"","redoCreated":-1,"notes":{"64305":{"id":64305,"x":-759,"y":-194,"width":553,"height":116,"text":"Adds and updates flight ops events in the pnr history table based on passengers booked flights\n\nAdded changes in Max arrival event variable\n\nload the pnr and passenger records in the pnrpassengerlist table to load into the pnr passenger history process\n\nupdated:2019-11-28","colour":"e6e63c"},"64306":{"id":64306,"x":77,"y":-31,"width":417,"height":208,"text":"identify the new events loaded into the stage table and load them in the stage.pnrpassengerlist first then process the new event records","colour":"e6e63c"},"64307":{"id":64307,"x":-670,"y":-47,"width":156,"height":245,"text":"**Flight Arrival events**","colour":"e6e63c"},"64308":{"id":64308,"x":-396,"y":-45,"width":152,"height":232,"text":"**Flight Cancel events**","colour":"e6e63c"},"64309":{"id":64309,"x":-138,"y":-48,"width":163,"height":231,"text":"**Flight ETD, ETD/ETA, ETA Change events**","colour":"e6e63c"}},"variables":{"maxflightarrivaleventdatetime":{"definition":{"name":"maxflightarrivaleventdatetime","type":"DATETIME","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"2019-11-27 14:26:13"},"maxflightcanceleventdatetime":{"definition":{"name":"maxflightcanceleventdatetime","type":"DATETIME","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"2019-11-13"},"maxflightetaeventdatetime":{"definition":{"name":"maxflightetaeventdatetime","type":"DATETIME","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"2019-11-13"}},"grids":{}},"info":{"name":"PNR - Flight Ops Events Master_20191218","description":"identify and load flight events into the passenger history from the flight events table","type":"ORCHESTRATION"}}