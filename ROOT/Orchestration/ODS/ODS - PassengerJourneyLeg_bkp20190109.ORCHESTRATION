{"job":{"components":{"27258":{"id":27258,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-741198691,"x":-174,"y":-47,"width":32,"height":32,"inputConnectorIDs":[27276],"outputSuccessConnectorIDs":[27275],"outputFailureConnectorIDs":[27294],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{"1":{"slot":1,"fromId":null,"fromName":"Message","mapTo":"Errormessage"}},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"rez.PassengerJourneyLeg_Incremental"}}}},"visible":true},"2":{"slot":2,"name":"Database Type","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Microsoft SQL Server"}}}},"visible":true},"3":{"slot":3,"name":"Connection URL","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${db_server_url_ods_rezpdod01}"}}}},"visible":true},"6":{"slot":6,"name":"Usename","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${db_user_ods_rezpdod01}"}}}},"visible":true},"7":{"slot":7,"name":"Password","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"PASSWORD","value":"${db_pswd_ods_rezpdod01}"}}}},"visible":true},"8":{"slot":8,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"select *\n\t, REFPDOD01.reference.ConvertDate('CA3', modifiedutc, 0, 0) AS modifiedest\n    , REFPDOD01.reference.ConvertDate('CA3', createdutc, 0, 0) as createdest\nfrom rez.passengerjourneyleg\nwhere modifiedutc >= CAST('${paxleg_maxmodifiedutc}' as DATETIME2)"}}}},"visible":true},"9":{"slot":9,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"passengerjourneyleg"}}}},"visible":true},"10":{"slot":10,"name":"S3 Staging Area","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"porterdatawarehouse"}}}},"visible":true},"11":{"slot":11,"name":"Connection Options","elements":{},"visible":true},"12":{"slot":12,"name":"Concurrency","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"4"}}}},"visible":true},"13":{"slot":13,"name":"Distribution Style","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Even"}}}},"visible":true},"14":{"slot":14,"name":"Distribution Key","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"15":{"slot":15,"name":"Sort Key","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"PassengerID"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"SegmentID"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"LegNumber"}}}},"visible":true},"16":{"slot":16,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"etl"}}}},"visible":true},"17":{"slot":17,"name":"Sort Key Options","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Compound"}}}},"visible":true},"96":{"slot":96,"name":"Location","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"s3://<bucket>/<path>"}}}},"visible":false},"97":{"slot":97,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"98":{"slot":98,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"99":{"slot":99,"name":"Type","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Standard"}}}},"visible":true},"1001":{"slot":1001,"name":"HIDDEN","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":" drop table if exists \"etl\".\"passengerjourneyleg\" cascade; create table \"etl\".\"passengerjourneyleg\" (\n\t\"PassengerID\" DECIMAL(19, 0),\n\t\"SegmentID\" DECIMAL(19, 0),\n\t\"LegNumber\" DECIMAL(5, 0),\n\t\"CreatedUserID\" DECIMAL(19, 0),\n\t\"CreatedUTC\" DATETIME,\n\t\"ModifiedUserID\" DECIMAL(19, 0),\n\t\"ModifiedUTC\" DATETIME,\n\t\"InventoryLegID\" DECIMAL(19, 0),\n\t\"DepartureDetail\" VARCHAR(32),\n\t\"ArrivalDetail\" VARCHAR(32),\n\t\"BookingStatus\" VARCHAR(2),\n\t\"SeatPreference\" VARCHAR(2),\n\t\"SeatTogetherPreference\" VARCHAR(5),\n\t\"CompartmentDesignator\" VARCHAR(6),\n\t\"UnitDesignator\" VARCHAR(6),\n\t\"UnitAssignmentWeight\" DECIMAL(10, 0),\n\t\"BoardingSequence\" DECIMAL(5, 0),\n\t\"LiftStatus\" DECIMAL(5, 0),\n\t\"PriorityCode\" VARCHAR(2),\n\t\"PriorityUTC\" DATETIME,\n\t\"modifiedest\" DATETIME,\n\t\"createdest\" DATETIME\n) DISTSTYLE EVEN"}}}},"visible":false},"1034":{"slot":1034,"name":"Load Options","elements":{},"visible":true},"40000":{"slot":40000,"name":"Encryption","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"None"}}}},"visible":true},"40001":{"slot":40001,"name":"KMS Key ID","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"27259":{"id":27259,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-741198691,"x":-183,"y":75,"width":32,"height":32,"inputConnectorIDs":[27282],"outputSuccessConnectorIDs":[27280],"outputFailureConnectorIDs":[27291],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{"1":{"slot":1,"fromId":null,"fromName":"Message","mapTo":"Errormessage"}},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"rez.PassengerJourneyLegVersion_Incremental"}}}},"visible":true},"2":{"slot":2,"name":"Database Type","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Microsoft SQL Server"}}}},"visible":true},"3":{"slot":3,"name":"Connection URL","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${db_server_url_ods_rezpdod01}"}}}},"visible":true},"6":{"slot":6,"name":"Usename","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${db_user_ods_rezpdod01}"}}}},"visible":true},"7":{"slot":7,"name":"Password","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"PASSWORD","value":"${db_pswd_ods_rezpdod01}"}}}},"visible":true},"8":{"slot":8,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"   select *\n    , REFPDOD01.reference.ConvertDate('CA3', modifiedutc, 0, 0) AS modifiedest\n    , REFPDOD01.reference.ConvertDate('CA3', createdutc, 0, 0) as createdest\nfrom rez.passengerjourneylegversion\nWhere versionstartutc >= CAST('${paxlegver_maxversionstartutc}' as DATETIME2)\nor (versionendutc >= CAST('${paxlegver_maxversionstartutc}' as DATETIME2) \n    AND versionstartutc <= CAST('${paxlegver_maxversionstartutc}' AS DateTime2)\n\tAND Versionendutc <> CAST('9999-12-31' as DATETIME2)\t\n\t)"}}}},"visible":true},"9":{"slot":9,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"passengerjourneylegversion"}}}},"visible":true},"10":{"slot":10,"name":"S3 Staging Area","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"porterdatawarehouse"}}}},"visible":true},"11":{"slot":11,"name":"Connection Options","elements":{},"visible":true},"12":{"slot":12,"name":"Concurrency","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"4"}}}},"visible":true},"13":{"slot":13,"name":"Distribution Style","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Even"}}}},"visible":true},"14":{"slot":14,"name":"Distribution Key","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"15":{"slot":15,"name":"Sort Key","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"PassengerID"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"SegmentID"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"LegNumber"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"VersionStartUTC"}}}},"visible":true},"16":{"slot":16,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"etl"}}}},"visible":true},"17":{"slot":17,"name":"Sort Key Options","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Compound"}}}},"visible":true},"96":{"slot":96,"name":"Location","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"s3://<bucket>/<path>"}}}},"visible":false},"97":{"slot":97,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"98":{"slot":98,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"99":{"slot":99,"name":"Type","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Standard"}}}},"visible":true},"1001":{"slot":1001,"name":"HIDDEN","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":" drop table if exists \"etl\".\"passengerjourneylegversion\" cascade; create table \"etl\".\"passengerjourneylegversion\" (\n\t\"VersionStartUTC\" DATETIME,\n\t\"PassengerID\" DECIMAL(19, 0),\n\t\"SegmentID\" DECIMAL(19, 0),\n\t\"LegNumber\" DECIMAL(5, 0),\n\t\"VersionEndUTC\" DATETIME,\n\t\"CreatedUserID\" DECIMAL(19, 0),\n\t\"CreatedUTC\" DATETIME,\n\t\"ModifiedUserID\" DECIMAL(19, 0),\n\t\"ModifiedUTC\" DATETIME,\n\t\"InventoryLegID\" DECIMAL(19, 0),\n\t\"DepartureDetail\" VARCHAR(32),\n\t\"ArrivalDetail\" VARCHAR(32),\n\t\"BookingStatus\" VARCHAR(2),\n\t\"SeatPreference\" VARCHAR(2),\n\t\"SeatTogetherPreference\" VARCHAR(5),\n\t\"CompartmentDesignator\" VARCHAR(6),\n\t\"UnitDesignator\" VARCHAR(6),\n\t\"UnitAssignmentWeight\" DECIMAL(10, 0),\n\t\"BoardingSequence\" DECIMAL(5, 0),\n\t\"LiftStatus\" DECIMAL(5, 0),\n\t\"PriorityCode\" VARCHAR(2),\n\t\"PriorityUTC\" DATETIME,\n\t\"modifiedest\" DATETIME,\n\t\"createdest\" DATETIME\n) DISTSTYLE EVEN"}}}},"visible":false},"1034":{"slot":1034,"name":"Load Options","elements":{},"visible":true},"40000":{"slot":40000,"name":"Encryption","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"None"}}}},"visible":true},"40001":{"slot":40001,"name":"KMS Key ID","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"27260":{"id":27260,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":-1946388514,"x":592,"y":0,"width":32,"height":32,"inputConnectorIDs":[27273],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Success 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"27261":{"id":27261,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":143,"y":-53,"width":32,"height":32,"inputConnectorIDs":[27274],"outputSuccessConnectorIDs":[27277],"outputFailureConnectorIDs":[27289],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{"1":{"slot":1,"fromId":null,"fromName":"Message","mapTo":"Errormessage"}},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Update DateTime IDs"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Update ods.passengerjourneyleg\nSET modifieddateid = CAST(CAST(EXTRACT(year from modifiedutc) AS char(4)) + RIGHT('0'+CAST(EXTRACT(month from modifiedutc)AS char(2)),2) \n\t\t+ RIGHT('0'+CAST(EXTRACT(day from modifiedutc)AS char(2)),2) AS int)\n   , createddateid = CAST(CAST(EXTRACT(year from createdutc) AS char(4)) + RIGHT('0'+CAST(EXTRACT(month from createdutc)AS char(2)),2) \n\t\t+ RIGHT('0'+CAST(EXTRACT(day from createdutc)AS char(2)),2) AS int)\n   , modifiedtimeid = CAST(CAST(EXTRACT(hour from modifiedutc) AS varchar(2)) + RIGHT('0' + CAST(EXTRACT(minute from modifiedutc) AS varchar(2)),2) AS int) \n   , createdtimeid = CAST(CAST(EXTRACT(hour from createdutc) AS varchar(2)) + RIGHT('0' + CAST(EXTRACT(minute from createdutc) AS varchar(2)),2) AS int) \n where modifiedutc >='${paxleg_maxmodifiedutc}'"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"27262":{"id":27262,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186960,"x":-349,"y":-35,"width":32,"height":32,"inputConnectorIDs":[27285],"outputSuccessConnectorIDs":[27276],"outputFailureConnectorIDs":[27288],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{"1":{"slot":1,"fromId":null,"fromName":"Message","mapTo":"Errormessage"}},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Get Latest Modified"}}}},"visible":true},"2":{"slot":2,"name":"Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"###\n###\n#  Updating a variable:\n#    context.updateVariable('myvar', 'new-value')\n# Using a database cursor:\n#   cursor = context.getCursor()\n#   cursor.execute('select count(*) from mytable')\n#   rowcount = cursor.fetchone()[0]\n#\n###\n\ncursor = context.cursor()\ncursor.execute('select isnull(DATEADD(hr, -6,max(modifiedutc)),getdate()) from ods.passengerjourneyleg')\n\nstartdate = cursor.fetchone()[0]\ncontext.updateVariable(\"paxleg_maxmodifiedutc\", str(startdate))\n\nprint str(paxleg_maxmodifiedutc)"}}}},"visible":true},"3":{"slot":3,"name":"Interpreter","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Jython"}}}},"visible":true},"4":{"slot":4,"name":"Timeout","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"27263":{"id":27263,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":515156205,"x":494,"y":182,"width":32,"height":32,"inputConnectorIDs":[27281],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Failure 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"27264":{"id":27264,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1896325668,"x":-18,"y":-26,"width":32,"height":32,"inputConnectorIDs":[27275],"outputSuccessConnectorIDs":[27274],"outputFailureConnectorIDs":[27292],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ODS - PassengerJourneyLeg_Load"}}}},"visible":true},"2":{"slot":2,"name":"Transformation Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ODS - PassengerJourneyLeg_Load"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"27265":{"id":27265,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1896325668,"x":-16,"y":82,"width":32,"height":32,"inputConnectorIDs":[27280],"outputSuccessConnectorIDs":[27279],"outputFailureConnectorIDs":[27295],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ODS - PassengerJourneyLegVersion_Load"}}}},"visible":true},"2":{"slot":2,"name":"Transformation Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ODS - PassengerJourneyLegVersion_Load"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"27266":{"id":27266,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":154,"y":82,"width":32,"height":32,"inputConnectorIDs":[27279],"outputSuccessConnectorIDs":[27278],"outputFailureConnectorIDs":[27290],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{"1":{"slot":1,"fromId":null,"fromName":"Message","mapTo":"Errormessage"}},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Update Version DateTime IDs"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Update ods.passengerjourneylegversion\nSET modifieddateid = CAST(CAST(EXTRACT(year from modifiedutc) AS char(4)) + RIGHT('0'+CAST(EXTRACT(month from modifiedutc)AS char(2)),2) \n\t\t+ RIGHT('0'+CAST(EXTRACT(day from modifiedutc)AS char(2)),2) AS int)\n   , createddateid = CAST(CAST(EXTRACT(year from createdutc) AS char(4)) + RIGHT('0'+CAST(EXTRACT(month from createdutc)AS char(2)),2) \n\t\t+ RIGHT('0'+CAST(EXTRACT(day from createdutc)AS char(2)),2) AS int)\n   , modifiedtimeid = CAST(CAST(EXTRACT(hour from modifiedutc) AS varchar(2)) + RIGHT('0' + CAST(EXTRACT(minute from modifiedutc) AS varchar(2)),2) AS int) \n   , createdtimeid = CAST(CAST(EXTRACT(hour from createdutc) AS varchar(2)) + RIGHT('0' + CAST(EXTRACT(minute from createdutc) AS varchar(2)),2) AS int) \nWhere versionstartutc >= '${paxlegver_maxversionstartutc}' \nor (versionendutc >= '${paxlegver_maxversionstartutc}'\n    AND versionstartutc >='${paxlegver_maxversionstartutc}')"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"27267":{"id":27267,"inputCardinality":"ZERO","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":444132438,"x":-510,"y":32,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[27283,27285],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Start 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"27268":{"id":27268,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":438858066,"x":363,"y":182,"width":32,"height":32,"inputConnectorIDs":[27284],"outputSuccessConnectorIDs":[27281],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SNS Message 0"}}}},"visible":true},"2":{"slot":2,"name":"AWS Region","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"us-east-1"}}}},"visible":true},"3":{"slot":3,"name":"Topic Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"DW_ETL"}}}},"visible":true},"4":{"slot":4,"name":"Subject","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${job_name} - Job Failed"}}}},"visible":true},"5":{"slot":5,"name":"Message","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Environment: ${environment_name}\n\nJob failed: ${job_name}\n\nError Message: ${Errormessage}"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"27269":{"id":27269,"inputCardinality":"MANY","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":-1343684451,"x":241,"y":173,"width":32,"height":32,"inputConnectorIDs":[27287,27288,27289,27290,27291,27292,27293,27294,27295],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[27284],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Or 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"27270":{"id":27270,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186960,"x":-358,"y":108,"width":32,"height":32,"inputConnectorIDs":[27283],"outputSuccessConnectorIDs":[27282],"outputFailureConnectorIDs":[27287],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{"1":{"slot":1,"fromId":null,"fromName":"Message","mapTo":"Errormessage"}},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Get Latest Modified - Version"}}}},"visible":true},"2":{"slot":2,"name":"Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"###\n###\n#  Updating a variable:\n#    context.updateVariable('myvar', 'new-value')\n# Using a database cursor:\n#   cursor = context.getCursor()\n#   cursor.execute('select count(*) from mytable')\n#   rowcount = cursor.fetchone()[0]\n#\n###\n\ncursor = context.cursor()\ncursor.execute('select isnull(DATEADD(hr, -6,max(versionstartutc)),getdate()) from ods.passengerjourneylegversion')\n\nstartdate = cursor.fetchone()[0]\ncontext.updateVariable(\"paxlegver_maxversionstartutc\", str(startdate))\n\nprint str(startdate)"}}}},"visible":true},"3":{"slot":3,"name":"Interpreter","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Jython"}}}},"visible":true},"4":{"slot":4,"name":"Timeout","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"27271":{"id":27271,"inputCardinality":"MANY","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":235671163,"x":304,"y":-1,"width":32,"height":32,"inputConnectorIDs":[27277,27278],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[27286],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"And 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"27272":{"id":27272,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1785813072,"x":432,"y":0,"width":32,"height":32,"inputConnectorIDs":[27286],"outputSuccessConnectorIDs":[27273],"outputFailureConnectorIDs":[27293],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"PassengerJourneyLegDeleted"}}}},"visible":true},"2":{"slot":2,"name":"Orchestration Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ODS - PassengerJourneyLegDeleted"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]}},"successConnectors":{"27280":{"id":27280,"sourceID":27259,"targetID":27265},"27281":{"id":27281,"sourceID":27268,"targetID":27263},"27282":{"id":27282,"sourceID":27270,"targetID":27259},"27273":{"id":27273,"sourceID":27272,"targetID":27260},"27274":{"id":27274,"sourceID":27264,"targetID":27261},"27275":{"id":27275,"sourceID":27258,"targetID":27264},"27276":{"id":27276,"sourceID":27262,"targetID":27258},"27277":{"id":27277,"sourceID":27261,"targetID":27271},"27278":{"id":27278,"sourceID":27266,"targetID":27271},"27279":{"id":27279,"sourceID":27265,"targetID":27266}},"failureConnectors":{"27287":{"id":27287,"sourceID":27270,"targetID":27269},"27288":{"id":27288,"sourceID":27262,"targetID":27269},"27289":{"id":27289,"sourceID":27261,"targetID":27269},"27290":{"id":27290,"sourceID":27266,"targetID":27269},"27291":{"id":27291,"sourceID":27259,"targetID":27269},"27292":{"id":27292,"sourceID":27264,"targetID":27269},"27293":{"id":27293,"sourceID":27272,"targetID":27269},"27294":{"id":27294,"sourceID":27258,"targetID":27269},"27295":{"id":27295,"sourceID":27265,"targetID":27269}},"unconditionalConnectors":{"27283":{"id":27283,"sourceID":27267,"targetID":27270},"27284":{"id":27284,"sourceID":27269,"targetID":27268},"27285":{"id":27285,"sourceID":27267,"targetID":27262},"27286":{"id":27286,"sourceID":27271,"targetID":27272}},"trueConnectors":{},"falseConnectors":{},"iterationConnectors":{},"noteConnectors":{},"canUndo":false,"undoCommand":"","undoCreated":-1,"canRedo":false,"redoCommand":"","redoCreated":-1,"notes":{"27256":{"id":27256,"x":-540,"y":-165,"width":274,"height":78,"text":"Extracts and Load passenger journey leg and passenger journey leg version records from the ODS\n\n\nadded step to delete the PassengerJourneyLeg that have been deleted on the ODS system\n\nupdated: 2019-01-08","colour":"e6e63c"},"27257":{"id":27257,"x":356,"y":-99,"width":204,"height":175,"text":"Added on 2019-01-08 to remove passengerjourneyleg that has been deleted. ","colour":"e6e63c"}},"variables":{},"grids":{}},"info":{"name":"ODS - PassengerJourneyLeg_bkp20190109","description":"","type":"ORCHESTRATION"}}