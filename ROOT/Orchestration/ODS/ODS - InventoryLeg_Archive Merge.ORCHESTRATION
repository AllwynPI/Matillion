{"job":{"components":{"26154":{"id":26154,"inputCardinality":"ZERO","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":444132438,"x":-478,"y":27,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[26169],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Start 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"26155":{"id":26155,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-741198691,"x":-309,"y":34,"width":32,"height":32,"inputConnectorIDs":[26169],"outputSuccessConnectorIDs":[26164],"outputFailureConnectorIDs":[26170],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"archive.inventoryleg"}}}},"visible":true},"2":{"slot":2,"name":"Database Type","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Microsoft SQL Server"}}}},"visible":true},"3":{"slot":3,"name":"Connection URL","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"jdbc:jtds:sqlserver://149.122.13.127:52901;instanceName=REZPDODSUSER;databaseName=REZPDRD01"}}}},"visible":true},"6":{"slot":6,"name":"Usename","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"pdodsuser6"}}}},"visible":true},"7":{"slot":7,"name":"Password","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"z2v3*B6#NdSj"}}}},"visible":true},"8":{"slot":8,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"select IL.*\n\t, CASE WHEN S_A.TimeZoneCode <> 'CA3' \n\t\tTHEN REFPDOD01.reference.ConvertUTCtoTZ('CA3', STAUTC) \n\t\tELSE STA \n\t  END AS STAEST\n\t, CASE WHEN S_D.TimeZoneCode <> 'CA3' \n\t\tTHEN REFPDOD01.reference.ConvertUTCtoTZ('CA3', STDUTC) \n\t\tELSE STD \n\t  END AS STDEST\n\t, CASE WHEN S_D.TimeZoneCode <> 'CA3'\n\t\tTHEN REFPDOD01.reference.ConvertUTCtoTZ('CA3', il.CreatedUTC)\n\t\tELSE il.CreatedUTC\n\tEND AS CreatedEST\n\t, CASE WHEN S_D.TimeZoneCode <> 'CA3'\n\t\tTHEN REFPDOD01.reference.ConvertUTCtoTZ('CA3', il.ModifiedUTC)\n\t\tELSE il.ModifiedUTC\n\tEND AS ModifiedEST\n\t, CASE WHEN S_D.TimeZoneCode <> 'CA3'\n\t\tTHEN REFPDOD01.reference.ConvertUTCtoTZ('CA3', LastTimeChangeUTC)\n\t\tELSE  LastTimeChangeUTC\n\tEND AS LastTimeChangeEST\nfrom archive.inventoryleg IL\n  JOIN REZPDOD01.rez.Station S_A\n  on IL.ArrivalStation = S_A.StationCode\n  JOIN REZPDOD01.rez.Station S_D\n  ON IL.DepartureStation = S_D.StationCode"}}}},"visible":true},"9":{"slot":9,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"archive_inventoryleg"}}}},"visible":true},"10":{"slot":10,"name":"S3 Staging Area","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"porterdatawarehouse"}}}},"visible":true},"11":{"slot":11,"name":"Connection Options","elements":{},"visible":true},"12":{"slot":12,"name":"Concurrency","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"2"}}}},"visible":true},"13":{"slot":13,"name":"Distribution Style","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Even"}}}},"visible":true},"14":{"slot":14,"name":"Distribution Key","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"15":{"slot":15,"name":"Sort Key","elements":{},"visible":true},"16":{"slot":16,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"etl"}}}},"visible":true},"17":{"slot":17,"name":"Sort Key Options","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Compound"}}}},"visible":false},"96":{"slot":96,"name":"Location","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"s3://<bucket>/<path>"}}}},"visible":false},"97":{"slot":97,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"98":{"slot":98,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"99":{"slot":99,"name":"Type","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Standard"}}}},"visible":true},"1001":{"slot":1001,"name":"HIDDEN","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":" drop table if exists \"etl\".\"archive_inventoryleg\" cascade; create table \"etl\".\"archive_inventoryleg\" (\n\t\"InventoryLegID\" DECIMAL(19, 0),\n\t\"CreatedUserID\" DECIMAL(19, 0),\n\t\"CreatedUTC\" DATETIME,\n\t\"ModifiedUserID\" DECIMAL(19, 0),\n\t\"ModifiedUTC\" DATETIME,\n\t\"InventoryLegKey\" VARCHAR(22),\n\t\"DepartureDate\" VARCHAR(10),\n\t\"CarrierCode\" VARCHAR(3),\n\t\"FlightNumber\" VARCHAR(4),\n\t\"OpSuffix\" VARCHAR(1),\n\t\"DepartureStation\" VARCHAR(3),\n\t\"ArrivalStation\" VARCHAR(3),\n\t\"STDUTC\" VARCHAR(19),\n\t\"STD\" VARCHAR(19),\n\t\"DeptLTV\" DECIMAL(5, 0),\n\t\"DepartureTerminal\" VARCHAR(2),\n\t\"STAUTC\" VARCHAR(19),\n\t\"STA\" VARCHAR(19),\n\t\"ArrvLTV\" DECIMAL(5, 0),\n\t\"ArrivalTerminal\" VARCHAR(2),\n\t\"EquipmentType\" VARCHAR(3),\n\t\"EquipmentTypeSuffix\" VARCHAR(3),\n\t\"PRBCCode\" VARCHAR(8),\n\t\"MarketingCode\" VARCHAR(8),\n\t\"Lid\" DECIMAL(5, 0),\n\t\"AdjustedCapacity\" DECIMAL(5, 0),\n\t\"Capacity\" DECIMAL(5, 0),\n\t\"Status\" DECIMAL(5, 0),\n\t\"IROP\" DECIMAL(1, 0),\n\t\"SubjectToGovtApproval\" DECIMAL(1, 0),\n\t\"AircraftChange\" DECIMAL(1, 0),\n\t\"ChangeOfDirection\" DECIMAL(1, 0),\n\t\"MarketingOverride\" DECIMAL(1, 0),\n\t\"Managed\" DECIMAL(1, 0),\n\t\"SecureFlight\" DECIMAL(1, 0),\n\t\"NonOperationalDuplicate\" DECIMAL(1, 0),\n\t\"InventoryKey\" VARCHAR(22),\n\t\"LegNumber\" DECIMAL(5, 0),\n\t\"CodeShareIndicator\" VARCHAR(1),\n\t\"OperatingCarrier\" VARCHAR(3),\n\t\"OperatingFlightNumber\" VARCHAR(4),\n\t\"OperatingOpSuffix\" VARCHAR(1),\n\t\"OperatedByText\" VARCHAR(64),\n\t\"LastTimeChangeUTC\" DATETIME,\n\t\"ArrTZ\" VARCHAR(4),\n\t\"DepTZ\" VARCHAR(4),\n\t\"STAEST\" VARCHAR(23),\n\t\"STDEST\" VARCHAR(23),\n\t\"CreatedEST\" DATETIME,\n\t\"ModifiedEST\" DATETIME,\n\t\"LastTimeChangeEST\" DATETIME\n) DISTSTYLE EVEN"}}}},"visible":false},"1034":{"slot":1034,"name":"Load Options","elements":{},"visible":true},"40000":{"slot":40000,"name":"Encryption","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"None"}}}},"visible":true},"40001":{"slot":40001,"name":"KMS Key ID","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"26156":{"id":26156,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":172,"y":33,"width":32,"height":32,"inputConnectorIDs":[26166],"outputSuccessConnectorIDs":[26167],"outputFailureConnectorIDs":[26173],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Update Dateids"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"UPDATE ods.inventoryleg\nSET stddateid = CAST(CAST(EXTRACT(year from std) AS char(4)) + RIGHT('0'+CAST(EXTRACT(month from std)AS char(2)),2) \n  + RIGHT('0'+CAST(EXTRACT(day from std)AS char(2)),2) AS int) ,\n  stdtimeid = CAST(CAST(EXTRACT(hour from std) AS varchar(2)) + RIGHT('0' + CAST(EXTRACT(minute from std) AS varchar(2)),2) AS int) \n  , stadateid = CAST(CAST(EXTRACT(year from sta) AS char(4)) + RIGHT('0'+CAST(EXTRACT(month from sta)AS char(2)),2) \n  + RIGHT('0'+CAST(EXTRACT(day from sta)AS char(2)),2) AS int) ,\n  statimeid = CAST(CAST(EXTRACT(hour from sta) AS varchar(2)) + RIGHT('0' + CAST(EXTRACT(minute from sta) AS varchar(2)),2) AS int)\n  FROM ODS.inventoryleg\nWHERE statimeid IS NULL \nOR stadateid is null\nor stdtimeid is null \nor stddateid is null "}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"26157":{"id":26157,"inputCardinality":"MANY","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":-1343684451,"x":-58,"y":138,"width":32,"height":32,"inputConnectorIDs":[26170,26171,26172,26173],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[26168],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Or 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"26158":{"id":26158,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":438858066,"x":131,"y":140,"width":32,"height":32,"inputConnectorIDs":[26168],"outputSuccessConnectorIDs":[26163],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SNS Message 0"}}}},"visible":true},"2":{"slot":2,"name":"AWS Region","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"us-east-1"}}}},"visible":true},"3":{"slot":3,"name":"Topic Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"DW_ETL"}}}},"visible":true},"4":{"slot":4,"name":"Subject","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${job_name} - Job Failed"}}}},"visible":true},"5":{"slot":5,"name":"Message","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Job ${job_name} -  Failed"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"26159":{"id":26159,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1896325668,"x":-139,"y":31,"width":32,"height":32,"inputConnectorIDs":[26164],"outputSuccessConnectorIDs":[26165],"outputFailureConnectorIDs":[26171],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Update Archive"}}}},"visible":true},"2":{"slot":2,"name":"Transformation Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ODS  - InventoryLegArchive"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"26160":{"id":26160,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":-1946388514,"x":294,"y":33,"width":32,"height":32,"inputConnectorIDs":[26167],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Success 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"26161":{"id":26161,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":515156205,"x":301,"y":147,"width":32,"height":32,"inputConnectorIDs":[26163],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Failure 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"26162":{"id":26162,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1896325668,"x":37,"y":24,"width":32,"height":32,"inputConnectorIDs":[26165],"outputSuccessConnectorIDs":[26166],"outputFailureConnectorIDs":[26172],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Merge Archive and InventoryLeg"}}}},"visible":true},"2":{"slot":2,"name":"Transformation Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ODS - InventoryLeg_ArchiveMerge_Load"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]}},"successConnectors":{"26163":{"id":26163,"sourceID":26158,"targetID":26161},"26164":{"id":26164,"sourceID":26155,"targetID":26159},"26165":{"id":26165,"sourceID":26159,"targetID":26162},"26166":{"id":26166,"sourceID":26162,"targetID":26156},"26167":{"id":26167,"sourceID":26156,"targetID":26160}},"failureConnectors":{"26170":{"id":26170,"sourceID":26155,"targetID":26157},"26171":{"id":26171,"sourceID":26159,"targetID":26157},"26172":{"id":26172,"sourceID":26162,"targetID":26157},"26173":{"id":26173,"sourceID":26156,"targetID":26157}},"unconditionalConnectors":{"26168":{"id":26168,"sourceID":26157,"targetID":26158},"26169":{"id":26169,"sourceID":26154,"targetID":26155}},"trueConnectors":{},"falseConnectors":{},"iterationConnectors":{},"noteConnectors":{},"canUndo":false,"undoCommand":"","undoCreated":-1,"canRedo":false,"redoCommand":"","redoCreated":-1,"notes":{},"variables":{},"grids":{}},"info":{"name":"ODS - InventoryLeg_Archive Merge","description":null,"type":"ORCHESTRATION"}}