{"job":{"components":{"26176":{"id":26176,"inputCardinality":"ZERO","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":444132438,"x":-476,"y":55,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[26200,26202],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Start 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"26177":{"id":26177,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":237,"y":91,"width":32,"height":32,"inputConnectorIDs":[26194],"outputSuccessConnectorIDs":[26193],"outputFailureConnectorIDs":[26203],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{"1":{"slot":1,"fromId":null,"fromName":"Message","mapTo":"Errormessage"}},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Update Version Date Time IDs"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"UPDATE ods.inventorylegclassversion\nSET createdutcdateid = CAST(CAST(EXTRACT(year from createdutc) AS char(4)) + RIGHT('0'+CAST(EXTRACT(month from createdutc)AS char(2)),2) \n  + RIGHT('0'+CAST(EXTRACT(day from createdutc)AS char(2)),2) AS int)\n  , createdutctimeid = CAST(CAST(EXTRACT(hour from createdutc) AS varchar(2)) + RIGHT('0' + CAST(EXTRACT(minute from createdutc) AS varchar(2)),2) AS int) \n  , modifiedutcdateid = CAST(CAST(EXTRACT(year from modifiedutc) AS char(4)) + RIGHT('0'+CAST(EXTRACT(month from modifiedutc)AS char(2)),2) \n  + RIGHT('0'+CAST(EXTRACT(day from modifiedutc)AS char(2)),2) AS int) ,\n  modifiedutctimeid = CAST(CAST(EXTRACT(hour from modifiedutc) AS varchar(2)) + RIGHT('0' + CAST(EXTRACT(minute from modifiedutc) AS varchar(2)),2) AS int)\n  FROM ODS.inventorylegclassversion\nWHERE createdutcdateid IS NULL \nOR modifiedutcdateid is null\nor createdutctimeid is null \nor modifiedutcdateid is null "}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"26178":{"id":26178,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":-1946388514,"x":632,"y":48,"width":32,"height":32,"inputConnectorIDs":[26201],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Success 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"26179":{"id":26179,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":438858066,"x":371,"y":184,"width":32,"height":32,"inputConnectorIDs":[26199],"outputSuccessConnectorIDs":[26192],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SNS Message 0"}}}},"visible":true},"2":{"slot":2,"name":"AWS Region","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"us-east-1"}}}},"visible":true},"3":{"slot":3,"name":"Topic Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"DW_ETL"}}}},"visible":true},"4":{"slot":4,"name":"Subject","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${job_name} - Job Failed"}}}},"visible":true},"5":{"slot":5,"name":"Message","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Environment: ${environment_name}\n\nJob failed: ${job_name}\n\nError Message: ${Errormessage}"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"DISABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"26180":{"id":26180,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186960,"x":-281,"y":105,"width":32,"height":32,"inputConnectorIDs":[26202],"outputSuccessConnectorIDs":[26196],"outputFailureConnectorIDs":[26209],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{"1":{"slot":1,"fromId":null,"fromName":"Message","mapTo":"Errormessage"}},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Get Max Versionstart"}}}},"visible":true},"2":{"slot":2,"name":"Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"###\n###\n#  Updating a variable:\n#    context.updateVariable('myvar', 'new-value')\n# Using a database cursor:\n#   cursor = context.getCursor()\n#   cursor.execute('select count(*) from mytable')\n#   rowcount = cursor.fetchone()[0]\n#\n###\n\ncursor = context.cursor()\ncursor.execute('select isnull(DATEADD(hr, -6,max(versionstartutc)),getdate()) from ods.inventorylegclassversion')\n\nstartdate = cursor.fetchone()[0]\n\n#added for manual load\n#startdate = '2019-12-01'\n\ncontext.updateVariable(\"invlegclassver_maxversionstartutc\", str(startdate))\n\nprint str(startdate)"}}}},"visible":true},"3":{"slot":3,"name":"Interpreter","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Jython"}}}},"visible":true},"4":{"slot":4,"name":"Timeout","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"26181":{"id":26181,"inputCardinality":"MANY","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":235671163,"x":393,"y":43,"width":32,"height":32,"inputConnectorIDs":[26193,26195],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[26201],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"And 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"26182":{"id":26182,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-741198691,"x":-135,"y":112,"width":32,"height":32,"inputConnectorIDs":[26196],"outputSuccessConnectorIDs":[26197],"outputFailureConnectorIDs":[26208],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{"1":{"slot":1,"fromId":null,"fromName":"Message","mapTo":"Errormessage"}},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"rez.inventorylegclassversion"}}}},"visible":true},"2":{"slot":2,"name":"Database Type","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Microsoft SQL Server"}}}},"visible":true},"3":{"slot":3,"name":"Connection URL","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${db_server_url_ods_rezpdod01}"}}}},"visible":true},"6":{"slot":6,"name":"Usename","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${db_user_ods_rezpdod01}"}}}},"visible":true},"7":{"slot":7,"name":"Password","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"PASSWORD","value":"${db_pswd_ods_rezpdod01}"}}}},"visible":true},"8":{"slot":8,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"\t\n\tselect *\n\t, TSTREFPDOD01.reference.ConvertUTCtoTZ('CA3', ilv.CreatedUTC) AS CreatedEST\n\t, TSTREFPDOD01.reference.ConvertUTCtoTZ('CA3', ilv.ModifiedUTC) AS ModifiedEST\nfrom [TSTPDWB01].[Rez].[InventoryLegClassversion] ilv\nWhere ilv.versionstartutc >= CAST('${invlegclassver_maxversionstartutc}' as DATETIME2)\nor (ilv.versionendutc >= CAST('${invlegclassver_maxversionstartutc}'  as DATETIME2)\n\tAND ilv.versionstartutc <= CAST('${invlegclassver_maxversionstartutc}' as DATETIME2)\n\tAND ilv.Versionendutc <> CAST('9999-12-31' as DATETIME2)\n\t)"}}}},"visible":true},"9":{"slot":9,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"inventorylegclassversion"}}}},"visible":true},"10":{"slot":10,"name":"S3 Staging Area","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"porterdatawarehouse"}}}},"visible":true},"11":{"slot":11,"name":"Connection Options","elements":{},"visible":true},"12":{"slot":12,"name":"Concurrency","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"2"}}}},"visible":true},"13":{"slot":13,"name":"Distribution Style","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Even"}}}},"visible":true},"14":{"slot":14,"name":"Distribution Key","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"15":{"slot":15,"name":"Sort Key","elements":{},"visible":true},"16":{"slot":16,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"etl"}}}},"visible":true},"17":{"slot":17,"name":"Sort Key Options","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Compound"}}}},"visible":false},"18":{"slot":18,"name":"Primary Key","elements":{},"visible":true},"20":{"slot":20,"name":"Data Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"96":{"slot":96,"name":"Location","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"s3://<bucket>/<path>"}}}},"visible":false},"97":{"slot":97,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"98":{"slot":98,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"99":{"slot":99,"name":"Type","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Standard"}}}},"visible":true},"101":{"slot":101,"name":"Basic/Advanced Mode","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Advanced"}}}},"visible":true},"102":{"slot":102,"name":"Data Source","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"103":{"slot":103,"name":"Data Selection","elements":{},"visible":false},"104":{"slot":104,"name":"Data Source Filter","elements":{},"visible":false},"105":{"slot":105,"name":"Combine Filters","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"And"}}}},"visible":false},"106":{"slot":106,"name":"Limit","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"100"}}}},"visible":false},"1001":{"slot":1001,"name":"HIDDEN","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":" drop table if exists \"etl\".\"inventorylegclassversion\" cascade; create table \"etl\".\"inventorylegclassversion\" (\n\t\"VersionStartUTC\" DATETIME,\n\t\"InventoryLegID\" DECIMAL(19, 0),\n\t\"ClassNest\" DECIMAL(5, 0),\n\t\"ClassOfService\" VARCHAR(8),\n\t\"VersionEndUTC\" DATETIME,\n\t\"CreatedUserID\" DECIMAL(19, 0),\n\t\"CreatedUTC\" DATETIME,\n\t\"ModifiedUserID\" DECIMAL(19, 0),\n\t\"ModifiedUTC\" DATETIME,\n\t\"Status\" DECIMAL(5, 0),\n\t\"ClassType\" VARCHAR(1),\n\t\"ClassAllotted\" DECIMAL(5, 0),\n\t\"ClassRank\" DECIMAL(5, 0),\n\t\"ClassAU\" DECIMAL(5, 0),\n\t\"LatestAdvRes\" DECIMAL(5, 0),\n\t\"AllotmentBasisCode\" VARCHAR(8),\n\t\"CreatedEST\" DATETIME,\n\t\"ModifiedEST\" DATETIME\n) DISTSTYLE EVEN"}}}},"visible":false},"1034":{"slot":1034,"name":"Load Options","elements":{},"visible":true},"40000":{"slot":40000,"name":"Encryption","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"None"}}}},"visible":true},"40001":{"slot":40001,"name":"KMS Key ID","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"26183":{"id":26183,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":221,"y":0,"width":32,"height":32,"inputConnectorIDs":[26198],"outputSuccessConnectorIDs":[26195],"outputFailureConnectorIDs":[26204],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{"1":{"slot":1,"fromId":null,"fromName":"Message","mapTo":"Errormessage"}},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Update Date Time IDs"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"UPDATE ods.inventorylegclass\nSET createdutcdateid = CAST(CAST(EXTRACT(year from createdutc) AS char(4)) + RIGHT('0'+CAST(EXTRACT(month from createdutc)AS char(2)),2) \n  + RIGHT('0'+CAST(EXTRACT(day from createdutc)AS char(2)),2) AS int)\n  , createdutctimeid = CAST(CAST(EXTRACT(hour from createdutc) AS varchar(2)) + RIGHT('0' + CAST(EXTRACT(minute from createdutc) AS varchar(2)),2) AS int) \n  , modifiedutcdateid = CAST(CAST(EXTRACT(year from modifiedutc) AS char(4)) + RIGHT('0'+CAST(EXTRACT(month from modifiedutc)AS char(2)),2) \n  + RIGHT('0'+CAST(EXTRACT(day from modifiedutc)AS char(2)),2) AS int) ,\n  modifiedutctimeid = CAST(CAST(EXTRACT(hour from modifiedutc) AS varchar(2)) + RIGHT('0' + CAST(EXTRACT(minute from modifiedutc) AS varchar(2)),2) AS int)\n  FROM ODS.inventorylegclass\nWHERE createdutcdateid IS NULL \nOR modifiedutcdateid is null\nor createdutctimeid is null \nor modifiedutcdateid is null "}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"26184":{"id":26184,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":515156205,"x":517,"y":199,"width":32,"height":32,"inputConnectorIDs":[26192],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Failure 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"26185":{"id":26185,"inputCardinality":"MANY","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":-1343684451,"x":216,"y":196,"width":32,"height":32,"inputConnectorIDs":[26208,26209,26210,26203,26204,26205,26206,26207],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[26199],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Or 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"26186":{"id":26186,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-741198691,"x":-127,"y":-7,"width":32,"height":32,"inputConnectorIDs":[26190],"outputSuccessConnectorIDs":[26191],"outputFailureConnectorIDs":[26207],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{"1":{"slot":1,"fromId":null,"fromName":"Message","mapTo":"Errormessage"}},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"rez.inventorylegclass"}}}},"visible":true},"2":{"slot":2,"name":"Database Type","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Microsoft SQL Server"}}}},"visible":true},"3":{"slot":3,"name":"Connection URL","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${db_server_url_ods_rezpdod01}"}}}},"visible":true},"6":{"slot":6,"name":"Usename","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${db_user_ods_rezpdod01}"}}}},"visible":true},"7":{"slot":7,"name":"Password","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"PASSWORD","value":"${db_pswd_ods_rezpdod01}"}}}},"visible":true},"8":{"slot":8,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"select *\n\t, TSTREFPDOD01.reference.ConvertUTCtoTZ('CA3', il.CreatedUTC) AS CreatedEST\n\t, TSTREFPDOD01.reference.ConvertUTCtoTZ('CA3', il.ModifiedUTC) AS ModifiedEST\nfrom [TSTPDWB01].[Rez].[InventoryLegClass] il\nwhere modifiedutc >  CAST('${invlegclass_maxmodifiedutc}' as DATETIME2) "}}}},"visible":true},"9":{"slot":9,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"inventorylegclass"}}}},"visible":true},"10":{"slot":10,"name":"S3 Staging Area","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"porterdatawarehouse"}}}},"visible":true},"11":{"slot":11,"name":"Connection Options","elements":{},"visible":true},"12":{"slot":12,"name":"Concurrency","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"2"}}}},"visible":true},"13":{"slot":13,"name":"Distribution Style","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Even"}}}},"visible":true},"14":{"slot":14,"name":"Distribution Key","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"15":{"slot":15,"name":"Sort Key","elements":{},"visible":true},"16":{"slot":16,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"etl"}}}},"visible":true},"17":{"slot":17,"name":"Sort Key Options","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Compound"}}}},"visible":false},"18":{"slot":18,"name":"Primary Key","elements":{},"visible":true},"20":{"slot":20,"name":"Data Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"96":{"slot":96,"name":"Location","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"s3://<bucket>/<path>"}}}},"visible":false},"97":{"slot":97,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"98":{"slot":98,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"99":{"slot":99,"name":"Type","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Standard"}}}},"visible":true},"101":{"slot":101,"name":"Basic/Advanced Mode","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Advanced"}}}},"visible":true},"102":{"slot":102,"name":"Data Source","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"103":{"slot":103,"name":"Data Selection","elements":{},"visible":false},"104":{"slot":104,"name":"Data Source Filter","elements":{},"visible":false},"105":{"slot":105,"name":"Combine Filters","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"And"}}}},"visible":false},"106":{"slot":106,"name":"Limit","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"100"}}}},"visible":false},"1001":{"slot":1001,"name":"HIDDEN","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":" drop table if exists \"etl\".\"inventorylegclass\" cascade; create table \"etl\".\"inventorylegclass\" (\n\t\"InventoryLegID\" DECIMAL(19, 0),\n\t\"ClassNest\" DECIMAL(5, 0),\n\t\"ClassOfService\" VARCHAR(8),\n\t\"CreatedUserID\" DECIMAL(19, 0),\n\t\"CreatedUTC\" DATETIME,\n\t\"ModifiedUserID\" DECIMAL(19, 0),\n\t\"ModifiedUTC\" DATETIME,\n\t\"Status\" DECIMAL(5, 0),\n\t\"ClassType\" VARCHAR(1),\n\t\"ClassAllotted\" DECIMAL(5, 0),\n\t\"ClassRank\" DECIMAL(5, 0),\n\t\"ClassAU\" DECIMAL(5, 0),\n\t\"LatestAdvRes\" DECIMAL(5, 0),\n\t\"AllotmentBasisCode\" VARCHAR(8),\n\t\"CreatedEST\" DATETIME,\n\t\"ModifiedEST\" DATETIME\n) DISTSTYLE EVEN"}}}},"visible":false},"1034":{"slot":1034,"name":"Load Options","elements":{},"visible":true},"40000":{"slot":40000,"name":"Encryption","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"None"}}}},"visible":true},"40001":{"slot":40001,"name":"KMS Key ID","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"26187":{"id":26187,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1896325668,"x":64,"y":112,"width":32,"height":32,"inputConnectorIDs":[26197],"outputSuccessConnectorIDs":[26194],"outputFailureConnectorIDs":[26206],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ODS - InventoryLegVersionClass_Load"}}}},"visible":true},"2":{"slot":2,"name":"Transformation Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ODS - InventoryLegClassVersion_Load"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"26188":{"id":26188,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186960,"x":-293,"y":-7,"width":32,"height":32,"inputConnectorIDs":[26200],"outputSuccessConnectorIDs":[26190],"outputFailureConnectorIDs":[26210],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{"1":{"slot":1,"fromId":null,"fromName":"Message","mapTo":"Errormessage"}},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Get Max ModifiedDate"}}}},"visible":true},"2":{"slot":2,"name":"Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"###\n###\n#  Updating a variable:\n#    context.updateVariable('myvar', 'new-value')\n# Using a database cursor:\n#   cursor = context.getCursor()\n#   cursor.execute('select count(*) from mytable')\n#   rowcount = cursor.fetchone()[0]\n#\n###\n\ncursor = context.cursor()\ncursor.execute('select isnull(DATEADD(hr, -6,max(modifiedutc)),getdate()) from ods.inventorylegclass')\n\nstartdate = cursor.fetchone()[0]\n\n#added for manual load\n#startdate = '2019-12-01'\n\ncontext.updateVariable(\"invlegclass_maxmodifiedutc\", str(startdate))\n\nprint str(startdate)"}}}},"visible":true},"3":{"slot":3,"name":"Interpreter","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Jython"}}}},"visible":true},"4":{"slot":4,"name":"Timeout","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"26189":{"id":26189,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1896325668,"x":44,"y":2,"width":32,"height":32,"inputConnectorIDs":[26191],"outputSuccessConnectorIDs":[26198],"outputFailureConnectorIDs":[26205],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ODS - InventoryLegClass_Load"}}}},"visible":true},"2":{"slot":2,"name":"Transformation Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ODS - InventoryLegClass_Load"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]}},"successConnectors":{"26192":{"id":26192,"sourceID":26179,"targetID":26184},"26193":{"id":26193,"sourceID":26177,"targetID":26181},"26194":{"id":26194,"sourceID":26187,"targetID":26177},"26195":{"id":26195,"sourceID":26183,"targetID":26181},"26196":{"id":26196,"sourceID":26180,"targetID":26182},"26197":{"id":26197,"sourceID":26182,"targetID":26187},"26198":{"id":26198,"sourceID":26189,"targetID":26183},"26190":{"id":26190,"sourceID":26188,"targetID":26186},"26191":{"id":26191,"sourceID":26186,"targetID":26189}},"failureConnectors":{"26208":{"id":26208,"sourceID":26182,"targetID":26185},"26209":{"id":26209,"sourceID":26180,"targetID":26185},"26210":{"id":26210,"sourceID":26188,"targetID":26185},"26203":{"id":26203,"sourceID":26177,"targetID":26185},"26204":{"id":26204,"sourceID":26183,"targetID":26185},"26205":{"id":26205,"sourceID":26189,"targetID":26185},"26206":{"id":26206,"sourceID":26187,"targetID":26185},"26207":{"id":26207,"sourceID":26186,"targetID":26185}},"unconditionalConnectors":{"26199":{"id":26199,"sourceID":26185,"targetID":26179},"26200":{"id":26200,"sourceID":26176,"targetID":26188},"26201":{"id":26201,"sourceID":26181,"targetID":26178},"26202":{"id":26202,"sourceID":26176,"targetID":26180}},"trueConnectors":{},"falseConnectors":{},"iterationConnectors":{},"noteConnectors":{},"canUndo":true,"undoCommand":"Set Parameter","undoCreated":1577139935247,"canRedo":false,"redoCommand":"","redoCreated":-1,"notes":{"26175":{"id":26175,"x":-525,"y":-141,"width":274,"height":78,"text":"Extracts and Load inventory leg class and inventory leg class version records from the ODS\n\nupdated: 2018-08-31","colour":"e6e63c"}},"variables":{"invlegclass_maxmodifiedutc":{"definition":{"name":"invlegclass_maxmodifiedutc","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":""},"invlegclassver_maxversionstartutc":{"definition":{"name":"invlegclassver_maxversionstartutc","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":""}},"grids":{}},"info":{"name":"ODS - InventoryLegClass","description":"","type":"ORCHESTRATION"}}