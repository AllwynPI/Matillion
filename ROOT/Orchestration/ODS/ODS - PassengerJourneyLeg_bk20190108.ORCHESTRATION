{"job":{"components":{"27213":{"id":27213,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-741198691,"x":-174,"y":-47,"width":32,"height":32,"inputConnectorIDs":[27229],"outputSuccessConnectorIDs":[27228],"outputFailureConnectorIDs":[27247],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{"1":{"slot":1,"fromId":null,"fromName":"Message","mapTo":"Errormessage"}},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"rez.PassengerJourneyLeg_Incremental"}}}},"visible":true},"2":{"slot":2,"name":"Database Type","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Microsoft SQL Server"}}}},"visible":true},"3":{"slot":3,"name":"Connection URL","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${db_server_url_ods_rezpdod01}"}}}},"visible":true},"6":{"slot":6,"name":"Usename","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${db_user_ods_rezpdod01}"}}}},"visible":true},"7":{"slot":7,"name":"Password","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"PASSWORD","value":"${db_pswd_ods_rezpdod01}"}}}},"visible":true},"8":{"slot":8,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"select *\n\t, REFPDOD01.reference.ConvertDate('CA3', modifiedutc, 0, 0) AS modifiedest\n    , REFPDOD01.reference.ConvertDate('CA3', createdutc, 0, 0) as createdest\nfrom rez.passengerjourneyleg\nwhere modifiedutc >= CAST('${paxleg_maxmodifiedutc}' as DATETIME2)"}}}},"visible":true},"9":{"slot":9,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"passengerjourneyleg"}}}},"visible":true},"10":{"slot":10,"name":"S3 Staging Area","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"porterdatawarehouse"}}}},"visible":true},"11":{"slot":11,"name":"Connection Options","elements":{},"visible":true},"12":{"slot":12,"name":"Concurrency","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"4"}}}},"visible":true},"13":{"slot":13,"name":"Distribution Style","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Even"}}}},"visible":true},"14":{"slot":14,"name":"Distribution Key","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"15":{"slot":15,"name":"Sort Key","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"PassengerID"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"SegmentID"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"LegNumber"}}}},"visible":true},"16":{"slot":16,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"etl"}}}},"visible":true},"17":{"slot":17,"name":"Sort Key Options","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Compound"}}}},"visible":true},"96":{"slot":96,"name":"Location","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"s3://<bucket>/<path>"}}}},"visible":false},"97":{"slot":97,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"98":{"slot":98,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"99":{"slot":99,"name":"Type","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Standard"}}}},"visible":true},"1001":{"slot":1001,"name":"HIDDEN","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":" drop table if exists \"etl\".\"passengerjourneyleg\" cascade; create table \"etl\".\"passengerjourneyleg\" (\n\t\"PassengerID\" DECIMAL(19, 0),\n\t\"SegmentID\" DECIMAL(19, 0),\n\t\"LegNumber\" DECIMAL(5, 0),\n\t\"CreatedUserID\" DECIMAL(19, 0),\n\t\"CreatedUTC\" DATETIME,\n\t\"ModifiedUserID\" DECIMAL(19, 0),\n\t\"ModifiedUTC\" DATETIME,\n\t\"InventoryLegID\" DECIMAL(19, 0),\n\t\"DepartureDetail\" VARCHAR(32),\n\t\"ArrivalDetail\" VARCHAR(32),\n\t\"BookingStatus\" VARCHAR(2),\n\t\"SeatPreference\" VARCHAR(2),\n\t\"SeatTogetherPreference\" VARCHAR(5),\n\t\"CompartmentDesignator\" VARCHAR(6),\n\t\"UnitDesignator\" VARCHAR(6),\n\t\"UnitAssignmentWeight\" DECIMAL(10, 0),\n\t\"BoardingSequence\" DECIMAL(5, 0),\n\t\"LiftStatus\" DECIMAL(5, 0),\n\t\"PriorityCode\" VARCHAR(2),\n\t\"PriorityUTC\" DATETIME,\n\t\"modifiedest\" DATETIME,\n\t\"createdest\" DATETIME\n) DISTSTYLE EVEN"}}}},"visible":false},"1034":{"slot":1034,"name":"Load Options","elements":{},"visible":true},"40000":{"slot":40000,"name":"Encryption","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"None"}}}},"visible":true},"40001":{"slot":40001,"name":"KMS Key ID","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"27214":{"id":27214,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-741198691,"x":-183,"y":75,"width":32,"height":32,"inputConnectorIDs":[27235],"outputSuccessConnectorIDs":[27233],"outputFailureConnectorIDs":[27244],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{"1":{"slot":1,"fromId":null,"fromName":"Message","mapTo":"Errormessage"}},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"rez.PassengerJourneyLegVersion_Incremental"}}}},"visible":true},"2":{"slot":2,"name":"Database Type","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Microsoft SQL Server"}}}},"visible":true},"3":{"slot":3,"name":"Connection URL","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${db_server_url_ods_rezpdod01}"}}}},"visible":true},"6":{"slot":6,"name":"Usename","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${db_user_ods_rezpdod01}"}}}},"visible":true},"7":{"slot":7,"name":"Password","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"PASSWORD","value":"${db_pswd_ods_rezpdod01}"}}}},"visible":true},"8":{"slot":8,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"   select *\n    , REFPDOD01.reference.ConvertDate('CA3', modifiedutc, 0, 0) AS modifiedest\n    , REFPDOD01.reference.ConvertDate('CA3', createdutc, 0, 0) as createdest\nfrom rez.passengerjourneylegversion\nWhere versionstartutc >= CAST('${paxlegver_maxversionstartutc}' as DATETIME2)\nor (versionendutc >= CAST('${paxlegver_maxversionstartutc}' as DATETIME2) \n    AND versionstartutc <= CAST('${paxlegver_maxversionstartutc}' AS DateTime2)\n\tAND Versionendutc <> CAST('9999-12-31' as DATETIME2)\t\n\t)"}}}},"visible":true},"9":{"slot":9,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"passengerjourneylegversion"}}}},"visible":true},"10":{"slot":10,"name":"S3 Staging Area","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"porterdatawarehouse"}}}},"visible":true},"11":{"slot":11,"name":"Connection Options","elements":{},"visible":true},"12":{"slot":12,"name":"Concurrency","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"4"}}}},"visible":true},"13":{"slot":13,"name":"Distribution Style","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Even"}}}},"visible":true},"14":{"slot":14,"name":"Distribution Key","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"15":{"slot":15,"name":"Sort Key","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"PassengerID"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"SegmentID"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"LegNumber"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"VersionStartUTC"}}}},"visible":true},"16":{"slot":16,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"etl"}}}},"visible":true},"17":{"slot":17,"name":"Sort Key Options","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Compound"}}}},"visible":true},"96":{"slot":96,"name":"Location","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"s3://<bucket>/<path>"}}}},"visible":false},"97":{"slot":97,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"98":{"slot":98,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"99":{"slot":99,"name":"Type","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Standard"}}}},"visible":true},"1001":{"slot":1001,"name":"HIDDEN","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":" drop table if exists \"etl\".\"passengerjourneylegversion\" cascade; create table \"etl\".\"passengerjourneylegversion\" (\n\t\"VersionStartUTC\" DATETIME,\n\t\"PassengerID\" DECIMAL(19, 0),\n\t\"SegmentID\" DECIMAL(19, 0),\n\t\"LegNumber\" DECIMAL(5, 0),\n\t\"VersionEndUTC\" DATETIME,\n\t\"CreatedUserID\" DECIMAL(19, 0),\n\t\"CreatedUTC\" DATETIME,\n\t\"ModifiedUserID\" DECIMAL(19, 0),\n\t\"ModifiedUTC\" DATETIME,\n\t\"InventoryLegID\" DECIMAL(19, 0),\n\t\"DepartureDetail\" VARCHAR(32),\n\t\"ArrivalDetail\" VARCHAR(32),\n\t\"BookingStatus\" VARCHAR(2),\n\t\"SeatPreference\" VARCHAR(2),\n\t\"SeatTogetherPreference\" VARCHAR(5),\n\t\"CompartmentDesignator\" VARCHAR(6),\n\t\"UnitDesignator\" VARCHAR(6),\n\t\"UnitAssignmentWeight\" DECIMAL(10, 0),\n\t\"BoardingSequence\" DECIMAL(5, 0),\n\t\"LiftStatus\" DECIMAL(5, 0),\n\t\"PriorityCode\" VARCHAR(2),\n\t\"PriorityUTC\" DATETIME,\n\t\"modifiedest\" DATETIME,\n\t\"createdest\" DATETIME\n) DISTSTYLE EVEN"}}}},"visible":false},"1034":{"slot":1034,"name":"Load Options","elements":{},"visible":true},"40000":{"slot":40000,"name":"Encryption","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"None"}}}},"visible":true},"40001":{"slot":40001,"name":"KMS Key ID","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"27215":{"id":27215,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":-1946388514,"x":531,"y":-3,"width":32,"height":32,"inputConnectorIDs":[27238],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Success 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"27216":{"id":27216,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":143,"y":-53,"width":32,"height":32,"inputConnectorIDs":[27227],"outputSuccessConnectorIDs":[27230],"outputFailureConnectorIDs":[27242],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{"1":{"slot":1,"fromId":null,"fromName":"Message","mapTo":"Errormessage"}},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Update DateTime IDs"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Update ods.passengerjourneyleg\nSET modifieddateid = CAST(CAST(EXTRACT(year from modifiedutc) AS char(4)) + RIGHT('0'+CAST(EXTRACT(month from modifiedutc)AS char(2)),2) \n\t\t+ RIGHT('0'+CAST(EXTRACT(day from modifiedutc)AS char(2)),2) AS int)\n   , createddateid = CAST(CAST(EXTRACT(year from createdutc) AS char(4)) + RIGHT('0'+CAST(EXTRACT(month from createdutc)AS char(2)),2) \n\t\t+ RIGHT('0'+CAST(EXTRACT(day from createdutc)AS char(2)),2) AS int)\n   , modifiedtimeid = CAST(CAST(EXTRACT(hour from modifiedutc) AS varchar(2)) + RIGHT('0' + CAST(EXTRACT(minute from modifiedutc) AS varchar(2)),2) AS int) \n   , createdtimeid = CAST(CAST(EXTRACT(hour from createdutc) AS varchar(2)) + RIGHT('0' + CAST(EXTRACT(minute from createdutc) AS varchar(2)),2) AS int) \n where modifiedutc >='${paxleg_maxmodifiedutc}'"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"27217":{"id":27217,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186960,"x":-349,"y":-35,"width":32,"height":32,"inputConnectorIDs":[27236],"outputSuccessConnectorIDs":[27229],"outputFailureConnectorIDs":[27241],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{"1":{"slot":1,"fromId":null,"fromName":"Message","mapTo":"Errormessage"}},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Get Latest Modified"}}}},"visible":true},"2":{"slot":2,"name":"Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"###\n###\n#  Updating a variable:\n#    context.updateVariable('myvar', 'new-value')\n# Using a database cursor:\n#   cursor = context.getCursor()\n#   cursor.execute('select count(*) from mytable')\n#   rowcount = cursor.fetchone()[0]\n#\n###\n\ncursor = context.cursor()\ncursor.execute('select isnull(DATEADD(hr, -6,max(modifiedutc)),getdate()) from ods.passengerjourneyleg')\n\nstartdate = cursor.fetchone()[0]\ncontext.updateVariable(\"paxleg_maxmodifiedutc\", str(startdate))\n\nprint str(paxleg_maxmodifiedutc)"}}}},"visible":true},"3":{"slot":3,"name":"Interpreter","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Jython"}}}},"visible":true},"4":{"slot":4,"name":"Timeout","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"27218":{"id":27218,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":515156205,"x":494,"y":182,"width":32,"height":32,"inputConnectorIDs":[27234],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Failure 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"27219":{"id":27219,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1896325668,"x":-18,"y":-26,"width":32,"height":32,"inputConnectorIDs":[27228],"outputSuccessConnectorIDs":[27227],"outputFailureConnectorIDs":[27246],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ODS - PassengerJourneyLeg_Load"}}}},"visible":true},"2":{"slot":2,"name":"Transformation Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ODS - PassengerJourneyLeg_Load"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"27220":{"id":27220,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1896325668,"x":-16,"y":82,"width":32,"height":32,"inputConnectorIDs":[27233],"outputSuccessConnectorIDs":[27232],"outputFailureConnectorIDs":[27245],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ODS - PassengerJourneyLegVersion_Load"}}}},"visible":true},"2":{"slot":2,"name":"Transformation Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ODS - PassengerJourneyLegVersion_Load"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"27221":{"id":27221,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":154,"y":82,"width":32,"height":32,"inputConnectorIDs":[27232],"outputSuccessConnectorIDs":[27231],"outputFailureConnectorIDs":[27243],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{"1":{"slot":1,"fromId":null,"fromName":"Message","mapTo":"Errormessage"}},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Update Version DateTime IDs"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Update ods.passengerjourneylegversion\nSET modifieddateid = CAST(CAST(EXTRACT(year from modifiedutc) AS char(4)) + RIGHT('0'+CAST(EXTRACT(month from modifiedutc)AS char(2)),2) \n\t\t+ RIGHT('0'+CAST(EXTRACT(day from modifiedutc)AS char(2)),2) AS int)\n   , createddateid = CAST(CAST(EXTRACT(year from createdutc) AS char(4)) + RIGHT('0'+CAST(EXTRACT(month from createdutc)AS char(2)),2) \n\t\t+ RIGHT('0'+CAST(EXTRACT(day from createdutc)AS char(2)),2) AS int)\n   , modifiedtimeid = CAST(CAST(EXTRACT(hour from modifiedutc) AS varchar(2)) + RIGHT('0' + CAST(EXTRACT(minute from modifiedutc) AS varchar(2)),2) AS int) \n   , createdtimeid = CAST(CAST(EXTRACT(hour from createdutc) AS varchar(2)) + RIGHT('0' + CAST(EXTRACT(minute from createdutc) AS varchar(2)),2) AS int) \nWhere versionstartutc >= '${paxlegver_maxversionstartutc}' \nor (versionendutc >= '${paxlegver_maxversionstartutc}'\n    AND versionstartutc >='${paxlegver_maxversionstartutc}')"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"27222":{"id":27222,"inputCardinality":"ZERO","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":444132438,"x":-510,"y":32,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[27236,27237],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Start 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"27223":{"id":27223,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":438858066,"x":363,"y":182,"width":32,"height":32,"inputConnectorIDs":[27239],"outputSuccessConnectorIDs":[27234],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SNS Message 0"}}}},"visible":true},"2":{"slot":2,"name":"AWS Region","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"us-east-1"}}}},"visible":true},"3":{"slot":3,"name":"Topic Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"DW_ETL"}}}},"visible":true},"4":{"slot":4,"name":"Subject","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${job_name} - Job Failed"}}}},"visible":true},"5":{"slot":5,"name":"Message","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Environment: ${environment_name}\n\nJob failed: ${job_name}\n\nError Message: ${Errormessage}"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"27224":{"id":27224,"inputCardinality":"MANY","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":-1343684451,"x":241,"y":173,"width":32,"height":32,"inputConnectorIDs":[27240,27241,27242,27243,27244,27245,27246,27247],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[27239],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Or 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"27225":{"id":27225,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186960,"x":-358,"y":108,"width":32,"height":32,"inputConnectorIDs":[27237],"outputSuccessConnectorIDs":[27235],"outputFailureConnectorIDs":[27240],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{"1":{"slot":1,"fromId":null,"fromName":"Message","mapTo":"Errormessage"}},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Get Latest Modified - Version"}}}},"visible":true},"2":{"slot":2,"name":"Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"###\n###\n#  Updating a variable:\n#    context.updateVariable('myvar', 'new-value')\n# Using a database cursor:\n#   cursor = context.getCursor()\n#   cursor.execute('select count(*) from mytable')\n#   rowcount = cursor.fetchone()[0]\n#\n###\n\ncursor = context.cursor()\ncursor.execute('select isnull(DATEADD(hr, -6,max(versionstartutc)),getdate()) from ods.passengerjourneylegversion')\n\nstartdate = cursor.fetchone()[0]\ncontext.updateVariable(\"paxlegver_maxversionstartutc\", str(startdate))\n\nprint str(startdate)"}}}},"visible":true},"3":{"slot":3,"name":"Interpreter","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Jython"}}}},"visible":true},"4":{"slot":4,"name":"Timeout","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"27226":{"id":27226,"inputCardinality":"MANY","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":235671163,"x":304,"y":-1,"width":32,"height":32,"inputConnectorIDs":[27230,27231],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[27238],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"And 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]}},"successConnectors":{"27232":{"id":27232,"sourceID":27220,"targetID":27221},"27233":{"id":27233,"sourceID":27214,"targetID":27220},"27234":{"id":27234,"sourceID":27223,"targetID":27218},"27235":{"id":27235,"sourceID":27225,"targetID":27214},"27227":{"id":27227,"sourceID":27219,"targetID":27216},"27228":{"id":27228,"sourceID":27213,"targetID":27219},"27229":{"id":27229,"sourceID":27217,"targetID":27213},"27230":{"id":27230,"sourceID":27216,"targetID":27226},"27231":{"id":27231,"sourceID":27221,"targetID":27226}},"failureConnectors":{"27240":{"id":27240,"sourceID":27225,"targetID":27224},"27241":{"id":27241,"sourceID":27217,"targetID":27224},"27242":{"id":27242,"sourceID":27216,"targetID":27224},"27243":{"id":27243,"sourceID":27221,"targetID":27224},"27244":{"id":27244,"sourceID":27214,"targetID":27224},"27245":{"id":27245,"sourceID":27220,"targetID":27224},"27246":{"id":27246,"sourceID":27219,"targetID":27224},"27247":{"id":27247,"sourceID":27213,"targetID":27224}},"unconditionalConnectors":{"27236":{"id":27236,"sourceID":27222,"targetID":27217},"27237":{"id":27237,"sourceID":27222,"targetID":27225},"27238":{"id":27238,"sourceID":27226,"targetID":27215},"27239":{"id":27239,"sourceID":27224,"targetID":27223}},"trueConnectors":{},"falseConnectors":{},"iterationConnectors":{},"noteConnectors":{},"canUndo":false,"undoCommand":"","undoCreated":-1,"canRedo":false,"redoCommand":"","redoCreated":-1,"notes":{"27212":{"id":27212,"x":-517,"y":-164,"width":274,"height":78,"text":"Extracts and Load passenger journey leg and passenger journey leg version records from the ODS\n\nupdated: 2018-08-31","colour":"e6e63c"}},"variables":{},"grids":{}},"info":{"name":"ODS - PassengerJourneyLeg_bk20190108","description":"","type":"ORCHESTRATION"}}