{"job":{"components":{"27101":{"id":27101,"inputCardinality":"ZERO","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":444132438,"x":-476,"y":55,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[27124,27126],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Start 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"27102":{"id":27102,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":237,"y":91,"width":32,"height":32,"inputConnectorIDs":[27115],"outputSuccessConnectorIDs":[27116],"outputFailureConnectorIDs":[27131],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{"1":{"slot":1,"fromId":null,"fromName":"Message","mapTo":"Errormessage"}},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Update Version Date Time IDs"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"UPDATE ods.inventorylegclassversion\nSET createdutcdateid = CAST(CAST(EXTRACT(year from createdutc) AS char(4)) + RIGHT('0'+CAST(EXTRACT(month from createdutc)AS char(2)),2) \n  + RIGHT('0'+CAST(EXTRACT(day from createdutc)AS char(2)),2) AS int)\n  , createdutctimeid = CAST(CAST(EXTRACT(hour from createdutc) AS varchar(2)) + RIGHT('0' + CAST(EXTRACT(minute from createdutc) AS varchar(2)),2) AS int) \n  , modifiedutcdateid = CAST(CAST(EXTRACT(year from modifiedutc) AS char(4)) + RIGHT('0'+CAST(EXTRACT(month from modifiedutc)AS char(2)),2) \n  + RIGHT('0'+CAST(EXTRACT(day from modifiedutc)AS char(2)),2) AS int) ,\n  modifiedutctimeid = CAST(CAST(EXTRACT(hour from modifiedutc) AS varchar(2)) + RIGHT('0' + CAST(EXTRACT(minute from modifiedutc) AS varchar(2)),2) AS int)\n  FROM ODS.inventorylegclassversion\nWHERE createdutcdateid IS NULL \nOR modifiedutcdateid is null\nor createdutctimeid is null \nor modifiedutcdateid is null "}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"27103":{"id":27103,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":-1946388514,"x":632,"y":48,"width":32,"height":32,"inputConnectorIDs":[27127],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Success 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"27104":{"id":27104,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":438858066,"x":371,"y":184,"width":32,"height":32,"inputConnectorIDs":[27125],"outputSuccessConnectorIDs":[27122],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SNS Message 0"}}}},"visible":true},"2":{"slot":2,"name":"AWS Region","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"us-east-1"}}}},"visible":true},"3":{"slot":3,"name":"Topic Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"DW_ETL"}}}},"visible":true},"4":{"slot":4,"name":"Subject","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${job_name} - Job Failed"}}}},"visible":true},"5":{"slot":5,"name":"Message","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Environment: ${environment_name}\n\nJob failed: ${job_name}\n\nError Message: ${Errormessage}"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"27105":{"id":27105,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186960,"x":-281,"y":105,"width":32,"height":32,"inputConnectorIDs":[27126],"outputSuccessConnectorIDs":[27117],"outputFailureConnectorIDs":[27129],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{"1":{"slot":1,"fromId":null,"fromName":"Message","mapTo":"Errormessage"}},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Get Max Versionstart"}}}},"visible":true},"2":{"slot":2,"name":"Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"###\n###\n#  Updating a variable:\n#    context.updateVariable('myvar', 'new-value')\n# Using a database cursor:\n#   cursor = context.getCursor()\n#   cursor.execute('select count(*) from mytable')\n#   rowcount = cursor.fetchone()[0]\n#\n###\n\ncursor = context.cursor()\ncursor.execute('select isnull(max(versionstartutc),getdate()) from ods.inventorylegclassversion')\n\nstartdate = cursor.fetchone()[0]\ncontext.updateVariable(\"invlegclassver_maxversionstartutc\", str(startdate))\ncontext.updateVariable(\"invlegclassver_maxversionstartutc\", \"2018-11-01\")\n\nprint str(invlegclassver_maxversionstartutc)"}}}},"visible":true},"3":{"slot":3,"name":"Interpreter","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Jython"}}}},"visible":true},"4":{"slot":4,"name":"Timeout","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"27106":{"id":27106,"inputCardinality":"MANY","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":235671163,"x":393,"y":43,"width":32,"height":32,"inputConnectorIDs":[27116,27118],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[27127],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"And 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"27107":{"id":27107,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-741198691,"x":-135,"y":112,"width":32,"height":32,"inputConnectorIDs":[27117],"outputSuccessConnectorIDs":[27120],"outputFailureConnectorIDs":[27134],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{"1":{"slot":1,"fromId":null,"fromName":"Message","mapTo":"Errormessage"}},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"rez.inventorylegclassversion"}}}},"visible":true},"2":{"slot":2,"name":"Database Type","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Microsoft SQL Server"}}}},"visible":true},"3":{"slot":3,"name":"Connection URL","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${db_server_url_ods_rezpdod01}"}}}},"visible":true},"6":{"slot":6,"name":"Usename","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${db_user_ods_rezpdod01}"}}}},"visible":true},"7":{"slot":7,"name":"Password","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"PASSWORD","value":"${db_pswd_ods_rezpdod01}"}}}},"visible":true},"8":{"slot":8,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"\t\n\tselect *\n\t, REFPDOD01.reference.ConvertUTCtoTZ('CA3', ilv.CreatedUTC) AS CreatedEST\n\t, REFPDOD01.reference.ConvertUTCtoTZ('CA3', ilv.ModifiedUTC) AS ModifiedEST\nfrom [REZPDOD01].[Rez].[InventoryLegClassversion] ilv\nWhere ilv.versionstartutc >= CAST('${invlegclassver_maxversionstartutc}' as DATETIME2)\nor (ilv.versionendutc >= CAST('${invlegclassver_maxversionstartutc}'  as DATETIME2)\n\tAND ilv.versionstartutc <= CAST('${invlegclassver_maxversionstartutc}' as DATETIME2)\n\tAND ilv.Versionendutc <> CAST('9999-12-31' as DATETIME2)\n\t)"}}}},"visible":true},"9":{"slot":9,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"inventorylegclassversion"}}}},"visible":true},"10":{"slot":10,"name":"S3 Staging Area","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"porterdatawarehouse"}}}},"visible":true},"11":{"slot":11,"name":"Connection Options","elements":{},"visible":true},"12":{"slot":12,"name":"Concurrency","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"2"}}}},"visible":true},"13":{"slot":13,"name":"Distribution Style","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Even"}}}},"visible":true},"14":{"slot":14,"name":"Distribution Key","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"15":{"slot":15,"name":"Sort Key","elements":{},"visible":true},"16":{"slot":16,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"etl"}}}},"visible":true},"17":{"slot":17,"name":"Sort Key Options","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Compound"}}}},"visible":false},"96":{"slot":96,"name":"Location","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"s3://<bucket>/<path>"}}}},"visible":false},"97":{"slot":97,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"98":{"slot":98,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"99":{"slot":99,"name":"Type","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Standard"}}}},"visible":true},"1001":{"slot":1001,"name":"HIDDEN","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":" drop table if exists \"etl\".\"inventorylegclassversion\" cascade; create table \"etl\".\"inventorylegclassversion\" (\n\t\"VersionStartUTC\" DATETIME,\n\t\"InventoryLegID\" DECIMAL(19, 0),\n\t\"ClassNest\" DECIMAL(5, 0),\n\t\"ClassOfService\" VARCHAR(8),\n\t\"VersionEndUTC\" DATETIME,\n\t\"CreatedUserID\" DECIMAL(19, 0),\n\t\"CreatedUTC\" DATETIME,\n\t\"ModifiedUserID\" DECIMAL(19, 0),\n\t\"ModifiedUTC\" DATETIME,\n\t\"Status\" DECIMAL(5, 0),\n\t\"ClassType\" VARCHAR(1),\n\t\"ClassAllotted\" DECIMAL(5, 0),\n\t\"ClassRank\" DECIMAL(5, 0),\n\t\"ClassAU\" DECIMAL(5, 0),\n\t\"LatestAdvRes\" DECIMAL(5, 0),\n\t\"AllotmentBasisCode\" VARCHAR(8),\n\t\"CreatedEST\" DATETIME,\n\t\"ModifiedEST\" DATETIME\n) DISTSTYLE EVEN"}}}},"visible":false},"1034":{"slot":1034,"name":"Load Options","elements":{},"visible":true},"40000":{"slot":40000,"name":"Encryption","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"None"}}}},"visible":true},"40001":{"slot":40001,"name":"KMS Key ID","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"27108":{"id":27108,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":221,"y":0,"width":32,"height":32,"inputConnectorIDs":[27119],"outputSuccessConnectorIDs":[27118],"outputFailureConnectorIDs":[27130],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{"1":{"slot":1,"fromId":null,"fromName":"Message","mapTo":"Errormessage"}},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Update Date Time IDs"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"UPDATE ods.inventorylegclass\nSET createdutcdateid = CAST(CAST(EXTRACT(year from createdutc) AS char(4)) + RIGHT('0'+CAST(EXTRACT(month from createdutc)AS char(2)),2) \n  + RIGHT('0'+CAST(EXTRACT(day from createdutc)AS char(2)),2) AS int)\n  , createdutctimeid = CAST(CAST(EXTRACT(hour from createdutc) AS varchar(2)) + RIGHT('0' + CAST(EXTRACT(minute from createdutc) AS varchar(2)),2) AS int) \n  , modifiedutcdateid = CAST(CAST(EXTRACT(year from modifiedutc) AS char(4)) + RIGHT('0'+CAST(EXTRACT(month from modifiedutc)AS char(2)),2) \n  + RIGHT('0'+CAST(EXTRACT(day from modifiedutc)AS char(2)),2) AS int) ,\n  modifiedutctimeid = CAST(CAST(EXTRACT(hour from modifiedutc) AS varchar(2)) + RIGHT('0' + CAST(EXTRACT(minute from modifiedutc) AS varchar(2)),2) AS int)\n  FROM ODS.inventorylegclass\nWHERE createdutcdateid IS NULL \nOR modifiedutcdateid is null\nor createdutctimeid is null \nor modifiedutcdateid is null "}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"27109":{"id":27109,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":515156205,"x":517,"y":199,"width":32,"height":32,"inputConnectorIDs":[27122],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Failure 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"27110":{"id":27110,"inputCardinality":"MANY","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":-1343684451,"x":216,"y":196,"width":32,"height":32,"inputConnectorIDs":[27128,27129,27130,27131,27132,27133,27134,27135],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[27125],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Or 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"27111":{"id":27111,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-741198691,"x":-127,"y":-7,"width":32,"height":32,"inputConnectorIDs":[27121],"outputSuccessConnectorIDs":[27123],"outputFailureConnectorIDs":[27135],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{"1":{"slot":1,"fromId":null,"fromName":"Message","mapTo":"Errormessage"}},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"rez.inventorylegclass"}}}},"visible":true},"2":{"slot":2,"name":"Database Type","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Microsoft SQL Server"}}}},"visible":true},"3":{"slot":3,"name":"Connection URL","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${db_server_url_ods_rezpdod01}"}}}},"visible":true},"6":{"slot":6,"name":"Usename","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${db_user_ods_rezpdod01}"}}}},"visible":true},"7":{"slot":7,"name":"Password","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"PASSWORD","value":"${db_pswd_ods_rezpdod01}"}}}},"visible":true},"8":{"slot":8,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"select *\n\t, REFPDOD01.reference.ConvertUTCtoTZ('CA3', il.CreatedUTC) AS CreatedEST\n\t, REFPDOD01.reference.ConvertUTCtoTZ('CA3', il.ModifiedUTC) AS ModifiedEST\nfrom [REZPDOD01].[Rez].[InventoryLegClass] il\nwhere modifiedutc >  CAST('${invlegclass_maxmodifiedutc}' as DATETIME2) "}}}},"visible":true},"9":{"slot":9,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"inventorylegclass"}}}},"visible":true},"10":{"slot":10,"name":"S3 Staging Area","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"porterdatawarehouse"}}}},"visible":true},"11":{"slot":11,"name":"Connection Options","elements":{},"visible":true},"12":{"slot":12,"name":"Concurrency","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"2"}}}},"visible":true},"13":{"slot":13,"name":"Distribution Style","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Even"}}}},"visible":true},"14":{"slot":14,"name":"Distribution Key","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"15":{"slot":15,"name":"Sort Key","elements":{},"visible":true},"16":{"slot":16,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"etl"}}}},"visible":true},"17":{"slot":17,"name":"Sort Key Options","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Compound"}}}},"visible":false},"96":{"slot":96,"name":"Location","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"s3://<bucket>/<path>"}}}},"visible":false},"97":{"slot":97,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"98":{"slot":98,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"99":{"slot":99,"name":"Type","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Standard"}}}},"visible":true},"1001":{"slot":1001,"name":"HIDDEN","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":" drop table if exists \"etl\".\"inventorylegclass\" cascade; create table \"etl\".\"inventorylegclass\" (\n\t\"InventoryLegID\" DECIMAL(19, 0),\n\t\"ClassNest\" DECIMAL(5, 0),\n\t\"ClassOfService\" VARCHAR(8),\n\t\"CreatedUserID\" DECIMAL(19, 0),\n\t\"CreatedUTC\" DATETIME,\n\t\"ModifiedUserID\" DECIMAL(19, 0),\n\t\"ModifiedUTC\" DATETIME,\n\t\"Status\" DECIMAL(5, 0),\n\t\"ClassType\" VARCHAR(1),\n\t\"ClassAllotted\" DECIMAL(5, 0),\n\t\"ClassRank\" DECIMAL(5, 0),\n\t\"ClassAU\" DECIMAL(5, 0),\n\t\"LatestAdvRes\" DECIMAL(5, 0),\n\t\"AllotmentBasisCode\" VARCHAR(8),\n\t\"CreatedEST\" DATETIME,\n\t\"ModifiedEST\" DATETIME\n) DISTSTYLE EVEN"}}}},"visible":false},"1034":{"slot":1034,"name":"Load Options","elements":{},"visible":true},"40000":{"slot":40000,"name":"Encryption","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"None"}}}},"visible":true},"40001":{"slot":40001,"name":"KMS Key ID","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"27112":{"id":27112,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1896325668,"x":64,"y":112,"width":32,"height":32,"inputConnectorIDs":[27120],"outputSuccessConnectorIDs":[27115],"outputFailureConnectorIDs":[27132],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ODS - InventoryLegVersionClass_Load"}}}},"visible":true},"2":{"slot":2,"name":"Transformation Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ODS - InventoryLegClassVersion_Load"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"27113":{"id":27113,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186960,"x":-293,"y":-7,"width":32,"height":32,"inputConnectorIDs":[27124],"outputSuccessConnectorIDs":[27121],"outputFailureConnectorIDs":[27128],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{"1":{"slot":1,"fromId":null,"fromName":"Message","mapTo":"Errormessage"}},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Get Max ModifiedDate"}}}},"visible":true},"2":{"slot":2,"name":"Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"###\n###\n#  Updating a variable:\n#    context.updateVariable('myvar', 'new-value')\n# Using a database cursor:\n#   cursor = context.getCursor()\n#   cursor.execute('select count(*) from mytable')\n#   rowcount = cursor.fetchone()[0]\n#\n###\n\ncursor = context.cursor()\ncursor.execute('select isnull(max(modifiedutc),getdate()) from ods.inventorylegclass')\n\nstartdate = cursor.fetchone()[0]\ncontext.updateVariable(\"invlegclass_maxmodifiedutc\", str(startdate))\ncontext.updateVariable(\"invlegclass_maxmodifiedutc\", \"2018-11-01\")\n\nprint str(invlegclass_maxmodifiedutc)"}}}},"visible":true},"3":{"slot":3,"name":"Interpreter","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Jython"}}}},"visible":true},"4":{"slot":4,"name":"Timeout","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"27114":{"id":27114,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1896325668,"x":44,"y":2,"width":32,"height":32,"inputConnectorIDs":[27123],"outputSuccessConnectorIDs":[27119],"outputFailureConnectorIDs":[27133],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ODS - InventoryLegClass_Load"}}}},"visible":true},"2":{"slot":2,"name":"Transformation Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ODS - InventoryLegClass_Load"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]}},"successConnectors":{"27120":{"id":27120,"sourceID":27107,"targetID":27112},"27121":{"id":27121,"sourceID":27113,"targetID":27111},"27122":{"id":27122,"sourceID":27104,"targetID":27109},"27123":{"id":27123,"sourceID":27111,"targetID":27114},"27115":{"id":27115,"sourceID":27112,"targetID":27102},"27116":{"id":27116,"sourceID":27102,"targetID":27106},"27117":{"id":27117,"sourceID":27105,"targetID":27107},"27118":{"id":27118,"sourceID":27108,"targetID":27106},"27119":{"id":27119,"sourceID":27114,"targetID":27108}},"failureConnectors":{"27128":{"id":27128,"sourceID":27113,"targetID":27110},"27129":{"id":27129,"sourceID":27105,"targetID":27110},"27130":{"id":27130,"sourceID":27108,"targetID":27110},"27131":{"id":27131,"sourceID":27102,"targetID":27110},"27132":{"id":27132,"sourceID":27112,"targetID":27110},"27133":{"id":27133,"sourceID":27114,"targetID":27110},"27134":{"id":27134,"sourceID":27107,"targetID":27110},"27135":{"id":27135,"sourceID":27111,"targetID":27110}},"unconditionalConnectors":{"27124":{"id":27124,"sourceID":27101,"targetID":27113},"27125":{"id":27125,"sourceID":27110,"targetID":27104},"27126":{"id":27126,"sourceID":27101,"targetID":27105},"27127":{"id":27127,"sourceID":27106,"targetID":27103}},"trueConnectors":{},"falseConnectors":{},"iterationConnectors":{},"noteConnectors":{},"canUndo":false,"undoCommand":"","undoCreated":-1,"canRedo":false,"redoCommand":"","redoCreated":-1,"notes":{"27100":{"id":27100,"x":-525,"y":-141,"width":274,"height":78,"text":"Extracts and Load inventory leg class and inventory leg class version records from the ODS\n\nupdated: 2018-08-31","colour":"e6e63c"}},"variables":{},"grids":{}},"info":{"name":"ODS - InventoryLegClass manual","description":"","type":"ORCHESTRATION"}}